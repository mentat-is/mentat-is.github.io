<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=9" />
        <meta name="generator" content="Doxygen 1.12.0" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <!-- BEGIN opengraph metadata -->
        <meta property="og:title" content="gULP! Documentation" />
        <meta
            property="og:image"
            content="https://repository-images.githubusercontent.com/348492097/4f16df80-88fb-11eb-9d31-4015ff22c452"
        />
        <meta
            property="og:description"
            content="Custom CSS theme for doxygen html-documentation with lots of customization parameters."
        />
        <meta
            property="og:url"
            content="https://github.com/rcskunkworks/gulp"
        />
        <!-- END opengraph metadata -->
        <!-- BEGIN twitter metadata -->
        <meta
            name="twitter:image:src"
            content="https://repository-images.githubusercontent.com/348492097/4f16df80-88fb-11eb-9d31-4015ff22c452"
        />
        <meta name="twitter:title" content="Mentat" />
        <meta name="twitter:description" content="mentat.is" />
        <!-- END twitter metadata -->
        <title>(g)ULP!: PluginBase Class Reference</title>
        <link href="tabs.css" rel="stylesheet" type="text/css" />
        <link rel="icon" type="image/svg+xml" href="logo.drawio.svg" />
        <script type="text/javascript" src="jquery.js"></script>
        <script type="text/javascript" src="dynsections.js"></script>
        <script
            type="text/javascript"
            src="doxygen-awesome-darkmode-toggle.js"
        ></script>
        <script
            type="text/javascript"
            src="doxygen-awesome-fragment-copy-button.js"
        ></script>
        <script
            type="text/javascript"
            src="doxygen-awesome-paragraph-link.js"
        ></script>
        <script
            type="text/javascript"
            src="doxygen-awesome-interactive-toc.js"
        ></script>
        <script
            type="text/javascript"
            src="doxygen-awesome-tabs.js"
        ></script>
        <script type="text/javascript">
            DoxygenAwesomeFragmentCopyButton.init();
            DoxygenAwesomeDarkModeToggle.init();
            DoxygenAwesomeParagraphLink.init();
            DoxygenAwesomeInteractiveToc.init();
            DoxygenAwesomeTabs.init();
        </script>
        </script>
        <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
 <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
        <link href="doxygen.css" rel="stylesheet" type="text/css" />
        <link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
    </head>
    <body>
        <script src="https://cdn.jsdelivr.net/npm/mermaid@latest/dist/mermaid.min.js"></script>
        <a
            href="https://github.com/rcskunkworks/gulp"
            class="github-corner"
            title="View source on GitHub"
            target="_blank"
            rel="noopener noreferrer"
        >
            <svg
                viewBox="0 0 250 250"
                width="40"
                height="40"
                style="
                    position: absolute;
                    top: 0;
                    border: 0;
                    right: 0;
                    z-index: 99;
                "
                aria-hidden="true"
            >
                <path
                    d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"
                ></path>
                <path
                    d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
                    fill="currentColor"
                    style="transform-origin: 130px 106px"
                    class="octo-arm"
                ></path>
                <path
                    d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
                    fill="currentColor"
                    class="octo-body"
                ></path></svg
        ></a>
        <style>
            .github-corner:hover .octo-arm {
                animation: octocat-wave 560ms ease-in-out;
            }
            @keyframes octocat-wave {
                0%,
                100% {
                    transform: rotate(0);
                }
                20%,
                60% {
                    transform: rotate(-25deg);
                }
                40%,
                80% {
                    transform: rotate(10deg);
                }
            }
            @media (max-width: 500px) {
                .github-corner:hover .octo-arm {
                    animation: none;
                }
                .github-corner .octo-arm {
                    animation: octocat-wave 560ms ease-in-out;
                }
            }
        </style>
        <div id="top">
            <!-- do not remove this div, it is closed by doxygen! -->
            <div id="titlearea">
                <table cellspacing="0" cellpadding="0">
                    <tbody>
                        <tr style="height: 56px">
                            <td id="projectalign" style="padding-left: 0.5em">
                                <div id="projectname">
                                    (g)ULP!
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <!-- end header part -->
        </div>
    </body>
</html>
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('classgulp_1_1plugin_1_1_plugin_base.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="classgulp_1_1plugin_1_1_plugin_base-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">PluginBase Class Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Inheritance diagram for PluginBase:</div>
<div class="dyncontent">
<div class="center"><img src="classgulp_1_1plugin_1_1_plugin_base__inherit__graph.png" border="0" usemap="#a_plugin_base_inherit__map" alt="Inheritance graph"/></div>
<map name="a_plugin_base_inherit__map" id="a_plugin_base_inherit__map">
<area shape="rect" title=" " alt="" coords="75,81,168,109"/>
<area shape="rect" href="classgulp_1_1plugins_1_1csv_1_1_plugin.html" title=" " alt="" coords="5,157,67,184"/>
<area shape="poly" title=" " alt="" coords="96,121,53,158,49,154,93,117"/>
<area shape="rect" href="classgulp_1_1plugins_1_1sigma_1_1windows_1_1_plugin.html" title=" " alt="" coords="91,157,152,184"/>
<area shape="poly" title=" " alt="" coords="124,124,124,156,119,156,119,124"/>
<area shape="rect" href="classgulp_1_1plugins_1_1win__evtx_1_1_plugin.html" title=" " alt="" coords="176,157,237,184"/>
<area shape="poly" title=" " alt="" coords="150,117,193,154,190,158,147,121"/>
<area shape="rect" title=" " alt="" coords="97,5,146,33"/>
<area shape="poly" title=" " alt="" coords="124,49,124,81,119,81,119,49"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for PluginBase:</div>
<div class="dyncontent">
<div class="center"><img src="classgulp_1_1plugin_1_1_plugin_base__coll__graph.png" border="0" usemap="#a_plugin_base_coll__map" alt="Collaboration graph"/></div>
<map name="a_plugin_base_coll__map" id="a_plugin_base_coll__map">
<area shape="rect" title=" " alt="" coords="5,81,99,109"/>
<area shape="rect" title=" " alt="" coords="28,5,76,33"/>
<area shape="poly" title=" " alt="" coords="55,49,55,81,49,81,49,49"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ad7e45821be80096c2a8b7c47f7ac1eed" id="r_ad7e45821be80096c2a8b7c47f7ac1eed"><td class="memItemLeft" align="right" valign="top">None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad7e45821be80096c2a8b7c47f7ac1eed">__init__</a> (self, str <a class="el" href="#aa28dc103258589d9cb421197fe2de90b">path</a>, AsyncEngine <a class="el" href="#af2760b1eea7c1b7f2459abf2872cbac6">collab</a>=None, AsyncElasticsearch <a class="el" href="#a85ca465c1498add707b193266a2dc717">elastic</a>=None, **kwargs)</td></tr>
<tr class="separator:ad7e45821be80096c2a8b7c47f7ac1eed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a840f5d608e3e60e19ad6aca18e0b5abf" id="r_a840f5d608e3e60e19ad6aca18e0b5abf"><td class="memItemLeft" align="right" valign="top">None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a840f5d608e3e60e19ad6aca18e0b5abf">cleanup</a> (self)</td></tr>
<tr class="separator:a840f5d608e3e60e19ad6aca18e0b5abf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01add25e2c2397d9ed56eca11d4105c0" id="r_a01add25e2c2397d9ed56eca11d4105c0"><td class="memItemLeft" align="right" valign="top">list[str]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a01add25e2c2397d9ed56eca11d4105c0">depends_on</a> (self)</td></tr>
<tr class="separator:a01add25e2c2397d9ed56eca11d4105c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad23a45a663b1933199b70ae3631e451b" id="r_ad23a45a663b1933199b70ae3631e451b"><td class="memItemLeft" align="right" valign="top">str&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad23a45a663b1933199b70ae3631e451b">desc</a> (self)</td></tr>
<tr class="separator:ad23a45a663b1933199b70ae3631e451b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad79ad6ef42363d02816e4b70b1c56fb5" id="r_ad79ad6ef42363d02816e4b70b1c56fb5"><td class="memItemLeft" align="right" valign="top">str&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad79ad6ef42363d02816e4b70b1c56fb5">event_type_field</a> (self)</td></tr>
<tr class="separator:ad79ad6ef42363d02816e4b70b1c56fb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5c86b4ede215ac0ba20d028ad717c3e" id="r_ac5c86b4ede215ac0ba20d028ad717c3e"><td class="memItemLeft" align="right" valign="top">str&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac5c86b4ede215ac0ba20d028ad717c3e">get_unmapped_field_name</a> (self, str field)</td></tr>
<tr class="separator:ac5c86b4ede215ac0ba20d028ad717c3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab96082a9ecc6d0db5a48ee6958ac3239" id="r_ab96082a9ecc6d0db5a48ee6958ac3239"><td class="memItemLeft" align="right" valign="top">GulpRequestStatus&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab96082a9ecc6d0db5a48ee6958ac3239">ingest</a> (self, str <a class="el" href="#a0d326931fdde686f05f73ed00cad6f36">index</a>, str <a class="el" href="#a1370c514cd93cb996ddf27f0400840bc">req_id</a>, int <a class="el" href="#a12087c1690a56089011c8e1a9f4e319e">client_id</a>, int <a class="el" href="#ad1f1eb15a79c7b61e759632d9333976b">operation_id</a>, str <a class="el" href="#aed88676be607a3199e7b417512f3d8f1">context</a>, str|list[dict] source, str <a class="el" href="#a333f06e1a7df05effecbc6a8fa238cca">ws_id</a>, <a class="el" href="classgulp_1_1plugin__internal_1_1_gulp_plugin_params.html">GulpPluginParams</a> plugin_params=None, GulpIngestionFilter flt=None, **kwargs)</td></tr>
<tr class="separator:ab96082a9ecc6d0db5a48ee6958ac3239"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66de2da998fe4b3958a3a6ce1189fbe8" id="r_a66de2da998fe4b3958a3a6ce1189fbe8"><td class="memItemLeft" align="right" valign="top">tuple[dict, GulpMapping]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a66de2da998fe4b3958a3a6ce1189fbe8">ingest_plugin_initialize</a> (self, str <a class="el" href="#a0d326931fdde686f05f73ed00cad6f36">index</a>, str|dict source, bool skip_mapping=False, ProcessingPipeline <a class="el" href="#acc159cfa2b2d043ffa24a5f62e5c80a3">pipeline</a>=None, str mapping_file=None, str mapping_id=None, <a class="el" href="classgulp_1_1plugin__internal_1_1_gulp_plugin_params.html">GulpPluginParams</a> plugin_params=None)</td></tr>
<tr class="separator:a66de2da998fe4b3958a3a6ce1189fbe8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6a9f9fea14049c9afb7094bb617363f" id="r_ac6a9f9fea14049c9afb7094bb617363f"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac6a9f9fea14049c9afb7094bb617363f">internal</a> (self)</td></tr>
<tr class="separator:ac6a9f9fea14049c9afb7094bb617363f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adafcb65c64ccf4cd7aa243765c95cc92" id="r_adafcb65c64ccf4cd7aa243765c95cc92"><td class="memItemLeft" align="right" valign="top">logging.Logger&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adafcb65c64ccf4cd7aa243765c95cc92">logger</a> (cls)</td></tr>
<tr class="separator:adafcb65c64ccf4cd7aa243765c95cc92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3cc5beb95fb74f4be44c04f84ed66a82" id="r_a3cc5beb95fb74f4be44c04f84ed66a82"><td class="memItemLeft" align="right" valign="top">str&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3cc5beb95fb74f4be44c04f84ed66a82">name</a> (self)</td></tr>
<tr class="separator:a3cc5beb95fb74f4be44c04f84ed66a82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7a969999e7d7be46f79b575de5f2224" id="r_ae7a969999e7d7be46f79b575de5f2224"><td class="memItemLeft" align="right" valign="top">list[<a class="el" href="classgulp_1_1plugin__internal_1_1_gulp_plugin_option.html">GulpPluginOption</a>]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae7a969999e7d7be46f79b575de5f2224">options</a> (self)</td></tr>
<tr class="separator:ae7a969999e7d7be46f79b575de5f2224"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc159cfa2b2d043ffa24a5f62e5c80a3" id="r_acc159cfa2b2d043ffa24a5f62e5c80a3"><td class="memItemLeft" align="right" valign="top">ProcessingPipeline&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acc159cfa2b2d043ffa24a5f62e5c80a3">pipeline</a> (self, <a class="el" href="classgulp_1_1plugin__internal_1_1_gulp_plugin_params.html">GulpPluginParams</a> plugin_params=None, **kwargs)</td></tr>
<tr class="separator:acc159cfa2b2d043ffa24a5f62e5c80a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38a3b56e6818d69a12aa847ac980895e" id="r_a38a3b56e6818d69a12aa847ac980895e"><td class="memItemLeft" align="right" valign="top">list[GulpDocument]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a38a3b56e6818d69a12aa847ac980895e">record_to_gulp_document</a> (self, int <a class="el" href="#ad1f1eb15a79c7b61e759632d9333976b">operation_id</a>, int <a class="el" href="#a12087c1690a56089011c8e1a9f4e319e">client_id</a>, str <a class="el" href="#aed88676be607a3199e7b417512f3d8f1">context</a>, str source, TmpIngestStats fs, any record, int record_idx, GulpMapping custom_mapping=None, dict index_type_mapping=None, str plugin=None, <a class="el" href="classgulp_1_1plugin__internal_1_1_gulp_plugin_params.html">GulpPluginParams</a> plugin_params=None, **kwargs)</td></tr>
<tr class="separator:a38a3b56e6818d69a12aa847ac980895e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0373c98260b243f699a1e65849b1fcad" id="r_a0373c98260b243f699a1e65849b1fcad"><td class="memItemLeft" align="right" valign="top">dict&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0373c98260b243f699a1e65849b1fcad">run_command</a> (self, <a class="el" href="classgulp_1_1plugin__internal_1_1_gulp_plugin_params.html">GulpPluginParams</a> p)</td></tr>
<tr class="separator:a0373c98260b243f699a1e65849b1fcad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e422abddcbb67f93856a6f754cbfef7" id="r_a0e422abddcbb67f93856a6f754cbfef7"><td class="memItemLeft" align="right" valign="top">ProcessingPipeline&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0e422abddcbb67f93856a6f754cbfef7">sigma_plugin_initialize</a> (self, ProcessingPipeline <a class="el" href="#acc159cfa2b2d043ffa24a5f62e5c80a3">pipeline</a>=None, str mapping_file=None, str mapping_id=None, str product=None, <a class="el" href="classgulp_1_1plugin__internal_1_1_gulp_plugin_params.html">GulpPluginParams</a> plugin_params=None)</td></tr>
<tr class="separator:a0e422abddcbb67f93856a6f754cbfef7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc17a69ceae0067ad2cc9bba5fe59fe9" id="r_acc17a69ceae0067ad2cc9bba5fe59fe9"><td class="memItemLeft" align="right" valign="top">list[str]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acc17a69ceae0067ad2cc9bba5fe59fe9">tags</a> (self)</td></tr>
<tr class="separator:acc17a69ceae0067ad2cc9bba5fe59fe9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48d7d6a080b67ba8c58522a1e05ce930" id="r_a48d7d6a080b67ba8c58522a1e05ce930"><td class="memItemLeft" align="right" valign="top">GulpPluginType&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a48d7d6a080b67ba8c58522a1e05ce930">type</a> (self)</td></tr>
<tr class="separator:a48d7d6a080b67ba8c58522a1e05ce930"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e436b61f937ea687fa3897d286899cf" id="r_a1e436b61f937ea687fa3897d286899cf"><td class="memItemLeft" align="right" valign="top">str&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1e436b61f937ea687fa3897d286899cf">version</a> (self)</td></tr>
<tr class="separator:a1e436b61f937ea687fa3897d286899cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a159bff19598c519586a6301ea31a3dde" id="r_a159bff19598c519586a6301ea31a3dde"><td class="memItemLeft" align="right" valign="top">list&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a159bff19598c519586a6301ea31a3dde">buffer</a> = []</td></tr>
<tr class="separator:a159bff19598c519586a6301ea31a3dde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12087c1690a56089011c8e1a9f4e319e" id="r_a12087c1690a56089011c8e1a9f4e319e"><td class="memItemLeft" align="right" valign="top">str&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a12087c1690a56089011c8e1a9f4e319e">client_id</a> = None</td></tr>
<tr class="separator:a12087c1690a56089011c8e1a9f4e319e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2760b1eea7c1b7f2459abf2872cbac6" id="r_af2760b1eea7c1b7f2459abf2872cbac6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af2760b1eea7c1b7f2459abf2872cbac6">collab</a> = collab</td></tr>
<tr class="separator:af2760b1eea7c1b7f2459abf2872cbac6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed88676be607a3199e7b417512f3d8f1" id="r_aed88676be607a3199e7b417512f3d8f1"><td class="memItemLeft" align="right" valign="top">tuple&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aed88676be607a3199e7b417512f3d8f1">context</a> = (None,)</td></tr>
<tr class="separator:aed88676be607a3199e7b417512f3d8f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85ca465c1498add707b193266a2dc717" id="r_a85ca465c1498add707b193266a2dc717"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a85ca465c1498add707b193266a2dc717">elastic</a> = elastic</td></tr>
<tr class="separator:a85ca465c1498add707b193266a2dc717"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d326931fdde686f05f73ed00cad6f36" id="r_a0d326931fdde686f05f73ed00cad6f36"><td class="memItemLeft" align="right" valign="top">str&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0d326931fdde686f05f73ed00cad6f36">index</a> = None</td></tr>
<tr class="separator:a0d326931fdde686f05f73ed00cad6f36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1f1eb15a79c7b61e759632d9333976b" id="r_ad1f1eb15a79c7b61e759632d9333976b"><td class="memItemLeft" align="right" valign="top">str&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad1f1eb15a79c7b61e759632d9333976b">operation_id</a> = None</td></tr>
<tr class="separator:ad1f1eb15a79c7b61e759632d9333976b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa28dc103258589d9cb421197fe2de90b" id="r_aa28dc103258589d9cb421197fe2de90b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa28dc103258589d9cb421197fe2de90b">path</a> = path</td></tr>
<tr class="separator:aa28dc103258589d9cb421197fe2de90b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1370c514cd93cb996ddf27f0400840bc" id="r_a1370c514cd93cb996ddf27f0400840bc"><td class="memItemLeft" align="right" valign="top">str&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1370c514cd93cb996ddf27f0400840bc">req_id</a> = None</td></tr>
<tr class="separator:a1370c514cd93cb996ddf27f0400840bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a333f06e1a7df05effecbc6a8fa238cca" id="r_a333f06e1a7df05effecbc6a8fa238cca"><td class="memItemLeft" align="right" valign="top">str&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a333f06e1a7df05effecbc6a8fa238cca">ws_id</a> = None</td></tr>
<tr class="separator:a333f06e1a7df05effecbc6a8fa238cca"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a375c2c0b188733c1f35fcc20865965bf" id="r_a375c2c0b188733c1f35fcc20865965bf"><td class="memItemLeft" align="right" valign="top">list[GulpDocument]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a375c2c0b188733c1f35fcc20865965bf">_build_gulpdocuments</a> (self, list[FieldMappingEntry] fme, int idx, int <a class="el" href="#ad1f1eb15a79c7b61e759632d9333976b">operation_id</a>, str <a class="el" href="#aed88676be607a3199e7b417512f3d8f1">context</a>, str plugin, int <a class="el" href="#a12087c1690a56089011c8e1a9f4e319e">client_id</a>, str raw_event, str original_id, str src_file, int timestamp=None, int timestamp_nsec=None, str event_code=None, list[str] cat=None, int duration_nsec=0, GulpLogLevel gulp_log_level=None, str original_log_level=None, bool remove_raw_event=False, **kwargs)</td></tr>
<tr class="separator:a375c2c0b188733c1f35fcc20865965bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17fb4d6dbb155ae0f0646e3d9814fc01" id="r_a17fb4d6dbb155ae0f0646e3d9814fc01"><td class="memItemLeft" align="right" valign="top">list[dict]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a17fb4d6dbb155ae0f0646e3d9814fc01">_build_ingestion_chunk_for_ws</a> (self, list[dict] docs, GulpIngestionFilter flt=None)</td></tr>
<tr class="separator:a17fb4d6dbb155ae0f0646e3d9814fc01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a381f36429810987d7e1a4603c3f4dfea" id="r_a381f36429810987d7e1a4603c3f4dfea"><td class="memItemLeft" align="right" valign="top">list[GulpDocument]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a381f36429810987d7e1a4603c3f4dfea">_call_record_to_gulp_document_funcs</a> (self, int <a class="el" href="#ad1f1eb15a79c7b61e759632d9333976b">operation_id</a>, int <a class="el" href="#a12087c1690a56089011c8e1a9f4e319e">client_id</a>, str <a class="el" href="#aed88676be607a3199e7b417512f3d8f1">context</a>, str source, TmpIngestStats fs, any record, int record_idx, GulpMapping custom_mapping=None, dict index_type_mapping=None, str plugin=None, <a class="el" href="classgulp_1_1plugin__internal_1_1_gulp_plugin_params.html">GulpPluginParams</a> plugin_params=None, Callable record_to_gulp_document_fun=None, **kwargs)</td></tr>
<tr class="separator:a381f36429810987d7e1a4603c3f4dfea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f3983f38b1d29c20df0dd5a496359af" id="r_a0f3983f38b1d29c20df0dd5a496359af"><td class="memItemLeft" align="right" valign="top">GulpRequestStatus&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0f3983f38b1d29c20df0dd5a496359af">_finish_ingestion</a> (self, str <a class="el" href="#a0d326931fdde686f05f73ed00cad6f36">index</a>, str|dict source, str <a class="el" href="#a1370c514cd93cb996ddf27f0400840bc">req_id</a>, int <a class="el" href="#a12087c1690a56089011c8e1a9f4e319e">client_id</a>, str <a class="el" href="#a333f06e1a7df05effecbc6a8fa238cca">ws_id</a>, TmpIngestStats fs, GulpIngestionFilter flt=None)</td></tr>
<tr class="separator:a0f3983f38b1d29c20df0dd5a496359af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a400aabb1893cbe98511a69414c8e58a2" id="r_a400aabb1893cbe98511a69414c8e58a2"><td class="memItemLeft" align="right" valign="top">TmpIngestStats&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a400aabb1893cbe98511a69414c8e58a2">_flush_buffer</a> (self, str <a class="el" href="#a0d326931fdde686f05f73ed00cad6f36">index</a>, TmpIngestStats fs, str <a class="el" href="#a333f06e1a7df05effecbc6a8fa238cca">ws_id</a>, str <a class="el" href="#a1370c514cd93cb996ddf27f0400840bc">req_id</a>, GulpIngestionFilter flt=None, bool wait_for_refresh=False)</td></tr>
<tr class="separator:a400aabb1893cbe98511a69414c8e58a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9cf9630b6d3e7ae9eab1b880e786222" id="r_ad9cf9630b6d3e7ae9eab1b880e786222"><td class="memItemLeft" align="right" valign="top">TmpIngestStats&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad9cf9630b6d3e7ae9eab1b880e786222">_ingest_record</a> (self, str <a class="el" href="#a0d326931fdde686f05f73ed00cad6f36">index</a>, GulpDocument|dict doc, TmpIngestStats fs, str <a class="el" href="#a333f06e1a7df05effecbc6a8fa238cca">ws_id</a>, str <a class="el" href="#a1370c514cd93cb996ddf27f0400840bc">req_id</a>, GulpIngestionFilter flt=None, bool flush_enabled=True, **kwargs)</td></tr>
<tr class="separator:ad9cf9630b6d3e7ae9eab1b880e786222"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b661e5352802554dc25028526496f7b" id="r_a4b661e5352802554dc25028526496f7b"><td class="memItemLeft" align="right" valign="top">list[FieldMappingEntry]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4b661e5352802554dc25028526496f7b">_map_source_key</a> (self, <a class="el" href="classgulp_1_1plugin__internal_1_1_gulp_plugin_params.html">GulpPluginParams</a> plugin_params, GulpMapping custom_mapping, str source_key, Any v, dict index_type_mapping=None, bool ignore_custom_mapping=False, **kwargs)</td></tr>
<tr class="separator:a4b661e5352802554dc25028526496f7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28ec6d78487be57c105863d9f58904e7" id="r_a28ec6d78487be57c105863d9f58904e7"><td class="memItemLeft" align="right" valign="top">TmpIngestStats&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a28ec6d78487be57c105863d9f58904e7">_parser_failed</a> (self, TmpIngestStats fs, str|dict source, Exception|str ex)</td></tr>
<tr class="separator:a28ec6d78487be57c105863d9f58904e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac39f95b7470b242061ba67ee749c4b44" id="r_ac39f95b7470b242061ba67ee749c4b44"><td class="memItemLeft" align="right" valign="top">tuple[GulpMapping, <a class="el" href="classgulp_1_1plugin__internal_1_1_gulp_plugin_params.html">GulpPluginParams</a>]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac39f95b7470b242061ba67ee749c4b44">_process_plugin_params</a> (self, GulpMapping custom_mapping, <a class="el" href="classgulp_1_1plugin__internal_1_1_gulp_plugin_params.html">GulpPluginParams</a> plugin_params=None)</td></tr>
<tr class="separator:ac39f95b7470b242061ba67ee749c4b44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf39f32a2e7e60975eac7054393625da" id="r_abf39f32a2e7e60975eac7054393625da"><td class="memItemLeft" align="right" valign="top">tuple[TmpIngestStats, bool]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abf39f32a2e7e60975eac7054393625da">_process_record</a> (self, str <a class="el" href="#a0d326931fdde686f05f73ed00cad6f36">index</a>, any record, int record_idx, Callable my_record_to_gulp_document_fun, str <a class="el" href="#a333f06e1a7df05effecbc6a8fa238cca">ws_id</a>, str <a class="el" href="#a1370c514cd93cb996ddf27f0400840bc">req_id</a>, int <a class="el" href="#ad1f1eb15a79c7b61e759632d9333976b">operation_id</a>, int <a class="el" href="#a12087c1690a56089011c8e1a9f4e319e">client_id</a>, str <a class="el" href="#aed88676be607a3199e7b417512f3d8f1">context</a>, str source, TmpIngestStats fs, GulpMapping custom_mapping=None, dict index_type_mapping=None, str plugin=None, <a class="el" href="classgulp_1_1plugin__internal_1_1_gulp_plugin_params.html">GulpPluginParams</a> plugin_params=None, GulpIngestionFilter flt=None, **kwargs)</td></tr>
<tr class="separator:abf39f32a2e7e60975eac7054393625da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1993e16b2333cb1bb281eaa81828c326" id="r_a1993e16b2333cb1bb281eaa81828c326"><td class="memItemLeft" align="right" valign="top">TmpIngestStats&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1993e16b2333cb1bb281eaa81828c326">_record_failed</a> (self, TmpIngestStats fs, any entry, str|dict source, Exception|str ex)</td></tr>
<tr class="separator:a1993e16b2333cb1bb281eaa81828c326"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfc929fce907dcf945a52ffb8dc5b2ed" id="r_acfc929fce907dcf945a52ffb8dc5b2ed"><td class="memItemLeft" align="right" valign="top">any&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acfc929fce907dcf945a52ffb8dc5b2ed">_type_checks</a> (self, any v, str k, dict index_type_mapping)</td></tr>
<tr class="separator:acfc929fce907dcf945a52ffb8dc5b2ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Base class for all Gulp plugins.
</pre> 
<p class="definition">Definition at line <a class="el" href="plugin_8py_source.html#l00055">55</a> of file <a class="el" href="plugin_8py_source.html">plugin.py</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ad7e45821be80096c2a8b7c47f7ac1eed" name="ad7e45821be80096c2a8b7c47f7ac1eed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7e45821be80096c2a8b7c47f7ac1eed">&#9670;&#160;</a></span>__init__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> None __init__ </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str</td>          <td class="paramname"><span class="paramname"><em>path</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">AsyncEngine </td>          <td class="paramname"><span class="paramname"><em>collab</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">AsyncElasticsearch </td>          <td class="paramname"><span class="paramname"><em>elastic</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">**</td>          <td class="paramname"><span class="paramname"><em>kwargs</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Initializes a new instance of the PluginBase class.

Args:
    path (str): The path to the plugin.
    collab: instance of sqlalchemy client
    elastic: instance of elasticsearch client
    kwargs: additional arguments if any
</pre> 
<p class="definition">Definition at line <a class="el" href="plugin_8py_source.html#l00060">60</a> of file <a class="el" href="plugin_8py_source.html">plugin.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   66</span>    ) -&gt; <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">   67</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   68</span><span class="stringliteral">        Initializes a new instance of the PluginBase class.</span></div>
<div class="line"><span class="lineno">   69</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   70</span><span class="stringliteral">        Args:</span></div>
<div class="line"><span class="lineno">   71</span><span class="stringliteral">            path (str): The path to the plugin.</span></div>
<div class="line"><span class="lineno">   72</span><span class="stringliteral">            collab: instance of sqlalchemy client</span></div>
<div class="line"><span class="lineno">   73</span><span class="stringliteral">            elastic: instance of elasticsearch client</span></div>
<div class="line"><span class="lineno">   74</span><span class="stringliteral">            kwargs: additional arguments if any</span></div>
<div class="line"><span class="lineno">   75</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   76</span>        self.req_id: str = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">   77</span>        self.index: str = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">   78</span>        self.client_id: str = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">   79</span>        self.operation_id: str = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">   80</span>        self.context: str = (<span class="keywordtype">None</span>,)</div>
<div class="line"><span class="lineno">   81</span>        self.ws_id: str = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">   82</span>        self.path = path</div>
<div class="line"><span class="lineno">   83</span>        self.collab = collab</div>
<div class="line"><span class="lineno">   84</span>        self.elastic = elastic</div>
<div class="line"><span class="lineno">   85</span> </div>
<div class="line"><span class="lineno">   86</span>        self.buffer: list[GulpDocument] = []</div>
<div class="line"><span class="lineno">   87</span>        <span class="keywordflow">for</span> k, v <span class="keywordflow">in</span> kwargs.items():</div>
<div class="line"><span class="lineno">   88</span>            self.__dict__[k] = v</div>
<div class="line"><span class="lineno">   89</span> </div>
<div class="line"><span class="lineno">   90</span>        <span class="comment"># initialize mapping helper</span></div>
<div class="line"><span class="lineno">   91</span>        mappings_helper.init(_logger)</div>
<div class="line"><span class="lineno">   92</span>        super().__init__()</div>
<div class="line"><span class="lineno">   93</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a375c2c0b188733c1f35fcc20865965bf" name="a375c2c0b188733c1f35fcc20865965bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a375c2c0b188733c1f35fcc20865965bf">&#9670;&#160;</a></span>_build_gulpdocuments()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"> list[GulpDocument] _build_gulpdocuments </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">list[FieldMappingEntry]</td>          <td class="paramname"><span class="paramname"><em>fme</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>idx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>operation_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str</td>          <td class="paramname"><span class="paramname"><em>context</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str</td>          <td class="paramname"><span class="paramname"><em>plugin</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>client_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str</td>          <td class="paramname"><span class="paramname"><em>raw_event</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str</td>          <td class="paramname"><span class="paramname"><em>original_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str</td>          <td class="paramname"><span class="paramname"><em>src_file</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int </td>          <td class="paramname"><span class="paramname"><em>timestamp</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int </td>          <td class="paramname"><span class="paramname"><em>timestamp_nsec</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str </td>          <td class="paramname"><span class="paramname"><em>event_code</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">list[str] </td>          <td class="paramname"><span class="paramname"><em>cat</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int </td>          <td class="paramname"><span class="paramname"><em>duration_nsec</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GulpLogLevel </td>          <td class="paramname"><span class="paramname"><em>gulp_log_level</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str </td>          <td class="paramname"><span class="paramname"><em>original_log_level</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool </td>          <td class="paramname"><span class="paramname"><em>remove_raw_event</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">**</td>          <td class="paramname"><span class="paramname"><em>kwargs</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">build one or more GulpDocument objects from a list of FieldMappingEntry objects:

this function creates as many GulpDocument objects as there are FieldMappingEntry objects with is_timestamp=True.
if no FieldMappingEntry object has is_timestamp=True, it creates a single GulpDocument object with the first FieldMappingEntry object.
</pre> 
<p class="definition">Definition at line <a class="el" href="plugin_8py_source.html#l00555">555</a> of file <a class="el" href="plugin_8py_source.html">plugin.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  575</span>    ) -&gt; list[GulpDocument]:</div>
<div class="line"><span class="lineno">  576</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  577</span><span class="stringliteral">        build one or more GulpDocument objects from a list of FieldMappingEntry objects:</span></div>
<div class="line"><span class="lineno">  578</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  579</span><span class="stringliteral">        this function creates as many GulpDocument objects as there are FieldMappingEntry objects with is_timestamp=True.</span></div>
<div class="line"><span class="lineno">  580</span><span class="stringliteral">        if no FieldMappingEntry object has is_timestamp=True, it creates a single GulpDocument object with the first FieldMappingEntry object.</span></div>
<div class="line"><span class="lineno">  581</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  582</span>        docs: list[GulpDocument] = []</div>
<div class="line"><span class="lineno">  583</span>        append_doc = docs.append  <span class="comment"># local variable for faster access</span></div>
<div class="line"><span class="lineno">  584</span> </div>
<div class="line"><span class="lineno">  585</span>        common_params = {</div>
<div class="line"><span class="lineno">  586</span>            <span class="stringliteral">&quot;idx&quot;</span>: idx,</div>
<div class="line"><span class="lineno">  587</span>            <span class="stringliteral">&quot;operation_id&quot;</span>: operation_id,</div>
<div class="line"><span class="lineno">  588</span>            <span class="stringliteral">&quot;context&quot;</span>: context,</div>
<div class="line"><span class="lineno">  589</span>            <span class="stringliteral">&quot;plugin&quot;</span>: plugin,</div>
<div class="line"><span class="lineno">  590</span>            <span class="stringliteral">&quot;client_id&quot;</span>: client_id,</div>
<div class="line"><span class="lineno">  591</span>            <span class="stringliteral">&quot;raw_event&quot;</span>: raw_event,</div>
<div class="line"><span class="lineno">  592</span>            <span class="stringliteral">&quot;original_id&quot;</span>: original_id,</div>
<div class="line"><span class="lineno">  593</span>            <span class="stringliteral">&quot;src_file&quot;</span>: src_file,</div>
<div class="line"><span class="lineno">  594</span>            <span class="stringliteral">&quot;timestamp&quot;</span>: timestamp,</div>
<div class="line"><span class="lineno">  595</span>            <span class="stringliteral">&quot;timestamp_nsec&quot;</span>: timestamp_nsec,</div>
<div class="line"><span class="lineno">  596</span>            <span class="stringliteral">&quot;event_code&quot;</span>: event_code,</div>
<div class="line"><span class="lineno">  597</span>            <span class="stringliteral">&quot;cat&quot;</span>: cat,</div>
<div class="line"><span class="lineno">  598</span>            <span class="stringliteral">&quot;duration_nsec&quot;</span>: duration_nsec,</div>
<div class="line"><span class="lineno">  599</span>            <span class="stringliteral">&quot;gulp_log_level&quot;</span>: gulp_log_level,</div>
<div class="line"><span class="lineno">  600</span>            <span class="stringliteral">&quot;original_log_level&quot;</span>: original_log_level,</div>
<div class="line"><span class="lineno">  601</span>            **kwargs,</div>
<div class="line"><span class="lineno">  602</span>        }</div>
<div class="line"><span class="lineno">  603</span>        <span class="keywordflow">for</span> f <span class="keywordflow">in</span> fme:</div>
<div class="line"><span class="lineno">  604</span>            <span class="comment"># print(&quot;%s\n\n&quot; % (f))</span></div>
<div class="line"><span class="lineno">  605</span>            <span class="comment"># for each is_timestamp build a gulpdocument with all the fields in fme</span></div>
<div class="line"><span class="lineno">  606</span>            <span class="keywordflow">if</span> f.is_timestamp:</div>
<div class="line"><span class="lineno">  607</span>                d = GulpDocument(fme=fme, f=f, **common_params)</div>
<div class="line"><span class="lineno">  608</span>                <span class="keywordflow">if</span> remove_raw_event:</div>
<div class="line"><span class="lineno">  609</span>                    d.original_event = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  610</span> </div>
<div class="line"><span class="lineno">  611</span>                <span class="comment"># print(&quot;%s\n\n&quot; % (d))</span></div>
<div class="line"><span class="lineno">  612</span>                append_doc(d)</div>
<div class="line"><span class="lineno">  613</span> </div>
<div class="line"><span class="lineno">  614</span>        <span class="keywordflow">if</span> len(docs) == 0:</div>
<div class="line"><span class="lineno">  615</span>            <span class="comment"># create a document with the given timestamp in timestamp/timestamp_nsec (if any, either it will be set to 0/invalid)</span></div>
<div class="line"><span class="lineno">  616</span>            d = GulpDocument(fme=fme, **common_params)</div>
<div class="line"><span class="lineno">  617</span>            <span class="keywordflow">if</span> remove_raw_event:</div>
<div class="line"><span class="lineno">  618</span>                d.original_event = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  619</span>            append_doc(d)</div>
<div class="line"><span class="lineno">  620</span> </div>
<div class="line"><span class="lineno">  621</span>        <span class="keywordflow">return</span> docs</div>
<div class="line"><span class="lineno">  622</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classgulp_1_1plugin_1_1_plugin_base_a375c2c0b188733c1f35fcc20865965bf_icgraph.png" border="0" usemap="#aclassgulp_1_1plugin_1_1_plugin_base_a375c2c0b188733c1f35fcc20865965bf_icgraph" alt=""/></div>
<map name="aclassgulp_1_1plugin_1_1_plugin_base_a375c2c0b188733c1f35fcc20865965bf_icgraph" id="aclassgulp_1_1plugin_1_1_plugin_base_a375c2c0b188733c1f35fcc20865965bf_icgraph">
<area shape="rect" title=" " alt="" coords="605,29,772,57"/>
<area shape="rect" href="classgulp_1_1plugins_1_1win__evtx_1_1_plugin.html#a38a3b56e6818d69a12aa847ac980895e" title=" " alt="" coords="305,21,557,66"/>
<area shape="poly" title=" " alt="" coords="589,46,557,46,557,40,589,40"/>
<area shape="rect" href="classgulp_1_1plugins_1_1win__evtx_1_1_plugin.html#ab96082a9ecc6d0db5a48ee6958ac3239" title=" " alt="" coords="5,29,257,57"/>
<area shape="poly" title=" " alt="" coords="289,46,257,46,257,40,289,40"/>
<area shape="poly" title=" " alt="" coords="183,17,166,10,131,8,99,10,82,15,77,20,85,27,81,31,72,20,79,11,99,5,131,3,167,5,185,12"/>
</map>
</div>

</div>
</div>
<a id="a17fb4d6dbb155ae0f0646e3d9814fc01" name="a17fb4d6dbb155ae0f0646e3d9814fc01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17fb4d6dbb155ae0f0646e3d9814fc01">&#9670;&#160;</a></span>_build_ingestion_chunk_for_ws()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"> list[dict] _build_ingestion_chunk_for_ws </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">list[dict]</td>          <td class="paramname"><span class="paramname"><em>docs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GulpIngestionFilter </td>          <td class="paramname"><span class="paramname"><em>flt</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Builds the ingestion chunk for the websocket, filtering if needed.
</pre> 
<p class="definition">Definition at line <a class="el" href="plugin_8py_source.html#l00826">826</a> of file <a class="el" href="plugin_8py_source.html">plugin.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  828</span>    ) -&gt; list[dict]:</div>
<div class="line"><span class="lineno">  829</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  830</span><span class="stringliteral">        Builds the ingestion chunk for the websocket, filtering if needed.</span></div>
<div class="line"><span class="lineno">  831</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  832</span>        <span class="comment"># self.logger().debug(&quot;building ingestion chunk, flt=%s&quot; % (flt))</span></div>
<div class="line"><span class="lineno">  833</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> docs:</div>
<div class="line"><span class="lineno">  834</span>            <span class="keywordflow">return</span> []</div>
<div class="line"><span class="lineno">  835</span> </div>
<div class="line"><span class="lineno">  836</span>        ws_docs = [</div>
<div class="line"><span class="lineno">  837</span>            {</div>
<div class="line"><span class="lineno">  838</span>                <span class="stringliteral">&quot;_id&quot;</span>: doc[<span class="stringliteral">&quot;_id&quot;</span>],</div>
<div class="line"><span class="lineno">  839</span>                <span class="stringliteral">&quot;@timestamp&quot;</span>: doc[<span class="stringliteral">&quot;@timestamp&quot;</span>],</div>
<div class="line"><span class="lineno">  840</span>                <span class="stringliteral">&quot;gulp.source.file&quot;</span>: doc[<span class="stringliteral">&quot;gulp.source.file&quot;</span>],</div>
<div class="line"><span class="lineno">  841</span>                <span class="stringliteral">&quot;event.duration&quot;</span>: doc[<span class="stringliteral">&quot;event.duration&quot;</span>],</div>
<div class="line"><span class="lineno">  842</span>                <span class="stringliteral">&quot;gulp.context&quot;</span>: doc[<span class="stringliteral">&quot;gulp.context&quot;</span>],</div>
<div class="line"><span class="lineno">  843</span>                <span class="stringliteral">&quot;gulp.log.level&quot;</span>: doc.get(<span class="stringliteral">&quot;gulp.log.level&quot;</span>, int(GulpLogLevel.INFO)),</div>
<div class="line"><span class="lineno">  844</span>                <span class="stringliteral">&quot;event.category&quot;</span>: doc.get(<span class="stringliteral">&quot;event.category&quot;</span>, <span class="keywordtype">None</span>),</div>
<div class="line"><span class="lineno">  845</span>                <span class="stringliteral">&quot;event.code&quot;</span>: doc[<span class="stringliteral">&quot;event.code&quot;</span>],</div>
<div class="line"><span class="lineno">  846</span>                <span class="stringliteral">&quot;gulp.event.code&quot;</span>: doc[<span class="stringliteral">&quot;gulp.event.code&quot;</span>],</div>
<div class="line"><span class="lineno">  847</span>            }</div>
<div class="line"><span class="lineno">  848</span>            <span class="keywordflow">for</span> doc <span class="keywordflow">in</span> docs</div>
<div class="line"><span class="lineno">  849</span>            <span class="keywordflow">if</span> elastic_api.filter_doc_for_ingestion(</div>
<div class="line"><span class="lineno">  850</span>                doc, flt, ignore_store_all_documents=<span class="keyword">True</span></div>
<div class="line"><span class="lineno">  851</span>            )</div>
<div class="line"><span class="lineno">  852</span>            == GulpEventFilterResult.ACCEPT</div>
<div class="line"><span class="lineno">  853</span>        ]</div>
<div class="line"><span class="lineno">  854</span> </div>
<div class="line"><span class="lineno">  855</span>        <span class="keywordflow">return</span> ws_docs</div>
<div class="line"><span class="lineno">  856</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classgulp_1_1plugin_1_1_plugin_base_a17fb4d6dbb155ae0f0646e3d9814fc01_icgraph.png" border="0" usemap="#aclassgulp_1_1plugin_1_1_plugin_base_a17fb4d6dbb155ae0f0646e3d9814fc01_icgraph" alt=""/></div>
<map name="aclassgulp_1_1plugin_1_1_plugin_base_a17fb4d6dbb155ae0f0646e3d9814fc01_icgraph" id="aclassgulp_1_1plugin_1_1_plugin_base_a17fb4d6dbb155ae0f0646e3d9814fc01_icgraph">
<area shape="rect" title=" " alt="" coords="803,24,976,68"/>
<area shape="rect" href="classgulp_1_1plugin_1_1_plugin_base.html#a400aabb1893cbe98511a69414c8e58a2" title=" " alt="" coords="648,32,755,60"/>
<area shape="poly" title=" " alt="" coords="787,48,755,48,755,43,787,43"/>
<area shape="rect" href="classgulp_1_1plugin_1_1_plugin_base.html#a0f3983f38b1d29c20df0dd5a496359af" title=" " alt="" coords="305,5,436,33"/>
<area shape="poly" title=" " alt="" coords="632,43,436,27,437,22,633,38"/>
<area shape="rect" href="classgulp_1_1plugin_1_1_plugin_base.html#ad9cf9630b6d3e7ae9eab1b880e786222" title=" " alt="" coords="484,57,600,85"/>
<area shape="poly" title=" " alt="" coords="634,59,601,65,600,59,633,54"/>
<area shape="rect" href="classgulp_1_1plugins_1_1win__evtx_1_1_plugin.html#ab96082a9ecc6d0db5a48ee6958ac3239" title=" " alt="" coords="5,32,257,60"/>
<area shape="poly" title=" " alt="" coords="290,31,257,34,257,29,289,25"/>
<area shape="poly" title=" " alt="" coords="172,19,158,13,131,11,106,13,92,17,89,23,95,30,90,33,84,23,89,13,105,7,131,5,159,8,174,14"/>
<area shape="rect" href="classgulp_1_1plugin_1_1_plugin_base.html#abf39f32a2e7e60975eac7054393625da" title=" " alt="" coords="307,57,434,85"/>
<area shape="poly" title=" " alt="" coords="468,74,434,74,434,68,468,68"/>
<area shape="poly" title=" " alt="" coords="292,66,257,62,257,57,292,60"/>
</map>
</div>

</div>
</div>
<a id="a381f36429810987d7e1a4603c3f4dfea" name="a381f36429810987d7e1a4603c3f4dfea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a381f36429810987d7e1a4603c3f4dfea">&#9670;&#160;</a></span>_call_record_to_gulp_document_funcs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"> list[GulpDocument] _call_record_to_gulp_document_funcs </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>operation_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>client_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str</td>          <td class="paramname"><span class="paramname"><em>context</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str</td>          <td class="paramname"><span class="paramname"><em>source</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TmpIngestStats</td>          <td class="paramname"><span class="paramname"><em>fs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">any</td>          <td class="paramname"><span class="paramname"><em>record</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>record_idx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GulpMapping </td>          <td class="paramname"><span class="paramname"><em>custom_mapping</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dict </td>          <td class="paramname"><span class="paramname"><em>index_type_mapping</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str </td>          <td class="paramname"><span class="paramname"><em>plugin</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classgulp_1_1plugin__internal_1_1_gulp_plugin_params.html">GulpPluginParams</a> </td>          <td class="paramname"><span class="paramname"><em>plugin_params</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Callable </td>          <td class="paramname"><span class="paramname"><em>record_to_gulp_document_fun</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">**</td>          <td class="paramname"><span class="paramname"><em>kwargs</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Stub function to call stacked plugins record_to_document_gulp_document.
Each function is called with the previously returned GulpDocument.

Args:
    operation_id (int): the operation ID associated with the record
    client_id (int): client ID performing the ingestion
    context (str): context associated with the record
    source (str): source of the record (source file name or path, usually)
    fs (TmpIngestStats): _description_
    record (any): a single record (first time) or a list of GulpDocument objects (in stacked plugins)
    record_idx (int): The index of the record in source.
    custom_mapping (GulpMapping, optional): The custom mapping to use for the conversion. Defaults to None.
    index_type_mapping (dict, optional): elastic search index type mappings { "field": "type", ... }. Defaults to None.
    plugin (str, optional): "agent.type" to be set in the GulpDocument. Defaults to None.
    plugin_params (GulpPluginParams, optional): The plugin parameters to use, if any. Defaults to None.
    record_to_gulp_document_fun (Callable, optional): function to parse record into a gulp document, if stacked this receives a list of GulpDocuments

Returns:
    list[GulpDocument]: zero or more GulpDocument objects
</pre> 
<p class="definition">Definition at line <a class="el" href="plugin_8py_source.html#l00376">376</a> of file <a class="el" href="plugin_8py_source.html">plugin.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  391</span>    ) -&gt; list[GulpDocument]:</div>
<div class="line"><span class="lineno">  392</span>        <span class="stringliteral">&quot;&quot;&quot;Stub function to call stacked plugins record_to_document_gulp_document.</span></div>
<div class="line"><span class="lineno">  393</span><span class="stringliteral">        Each function is called with the previously returned GulpDocument.</span></div>
<div class="line"><span class="lineno">  394</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  395</span><span class="stringliteral">        Args:</span></div>
<div class="line"><span class="lineno">  396</span><span class="stringliteral">            operation_id (int): the operation ID associated with the record</span></div>
<div class="line"><span class="lineno">  397</span><span class="stringliteral">            client_id (int): client ID performing the ingestion</span></div>
<div class="line"><span class="lineno">  398</span><span class="stringliteral">            context (str): context associated with the record</span></div>
<div class="line"><span class="lineno">  399</span><span class="stringliteral">            source (str): source of the record (source file name or path, usually)</span></div>
<div class="line"><span class="lineno">  400</span><span class="stringliteral">            fs (TmpIngestStats): _description_</span></div>
<div class="line"><span class="lineno">  401</span><span class="stringliteral">            record (any): a single record (first time) or a list of GulpDocument objects (in stacked plugins)</span></div>
<div class="line"><span class="lineno">  402</span><span class="stringliteral">            record_idx (int): The index of the record in source.</span></div>
<div class="line"><span class="lineno">  403</span><span class="stringliteral">            custom_mapping (GulpMapping, optional): The custom mapping to use for the conversion. Defaults to None.</span></div>
<div class="line"><span class="lineno">  404</span><span class="stringliteral">            index_type_mapping (dict, optional): elastic search index type mappings { &quot;field&quot;: &quot;type&quot;, ... }. Defaults to None.</span></div>
<div class="line"><span class="lineno">  405</span><span class="stringliteral">            plugin (str, optional): &quot;agent.type&quot; to be set in the GulpDocument. Defaults to None.</span></div>
<div class="line"><span class="lineno">  406</span><span class="stringliteral">            plugin_params (GulpPluginParams, optional): The plugin parameters to use, if any. Defaults to None.</span></div>
<div class="line"><span class="lineno">  407</span><span class="stringliteral">            record_to_gulp_document_fun (Callable, optional): function to parse record into a gulp document, if stacked this receives a list of GulpDocuments</span></div>
<div class="line"><span class="lineno">  408</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  409</span><span class="stringliteral">        Returns:</span></div>
<div class="line"><span class="lineno">  410</span><span class="stringliteral">            list[GulpDocument]: zero or more GulpDocument objects</span></div>
<div class="line"><span class="lineno">  411</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  412</span>        <span class="comment"># plugin_params=deepcopy(plugin_params)</span></div>
<div class="line"><span class="lineno">  413</span> </div>
<div class="line"><span class="lineno">  414</span>        <span class="keywordflow">if</span> plugin_params <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  415</span>            plugin_params = GulpPluginParams()</div>
<div class="line"><span class="lineno">  416</span> </div>
<div class="line"><span class="lineno">  417</span>        docs = record</div>
<div class="line"><span class="lineno">  418</span> </div>
<div class="line"><span class="lineno">  419</span>        <span class="keywordflow">if</span> record_to_gulp_document_fun <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  420</span>            docs = await record_to_gulp_document_fun(</div>
<div class="line"><span class="lineno">  421</span>                operation_id,</div>
<div class="line"><span class="lineno">  422</span>                client_id,</div>
<div class="line"><span class="lineno">  423</span>                context,</div>
<div class="line"><span class="lineno">  424</span>                source,</div>
<div class="line"><span class="lineno">  425</span>                fs,</div>
<div class="line"><span class="lineno">  426</span>                record,</div>
<div class="line"><span class="lineno">  427</span>                record_idx,</div>
<div class="line"><span class="lineno">  428</span>                custom_mapping,</div>
<div class="line"><span class="lineno">  429</span>                index_type_mapping,</div>
<div class="line"><span class="lineno">  430</span>                plugin,</div>
<div class="line"><span class="lineno">  431</span>                plugin_params,</div>
<div class="line"><span class="lineno">  432</span>                **kwargs,</div>
<div class="line"><span class="lineno">  433</span>            )</div>
<div class="line"><span class="lineno">  434</span> </div>
<div class="line"><span class="lineno">  435</span>        <span class="keywordflow">for</span> fun <span class="keywordflow">in</span> plugin_params.record_to_gulp_document_fun:</div>
<div class="line"><span class="lineno">  436</span>            docs = await fun(</div>
<div class="line"><span class="lineno">  437</span>                operation_id,</div>
<div class="line"><span class="lineno">  438</span>                client_id,</div>
<div class="line"><span class="lineno">  439</span>                context,</div>
<div class="line"><span class="lineno">  440</span>                source,</div>
<div class="line"><span class="lineno">  441</span>                fs,</div>
<div class="line"><span class="lineno">  442</span>                docs,</div>
<div class="line"><span class="lineno">  443</span>                record_idx,</div>
<div class="line"><span class="lineno">  444</span>                custom_mapping,</div>
<div class="line"><span class="lineno">  445</span>                index_type_mapping,</div>
<div class="line"><span class="lineno">  446</span>                plugin,</div>
<div class="line"><span class="lineno">  447</span>                plugin_params,</div>
<div class="line"><span class="lineno">  448</span>                **kwargs,</div>
<div class="line"><span class="lineno">  449</span>            )</div>
<div class="line"><span class="lineno">  450</span> </div>
<div class="line"><span class="lineno">  451</span>        <span class="keywordflow">if</span> docs <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  452</span>            <span class="keywordflow">return</span> []</div>
<div class="line"><span class="lineno">  453</span>        <span class="keywordflow">return</span> docs</div>
<div class="line"><span class="lineno">  454</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classgulp_1_1plugin_1_1_plugin_base_a381f36429810987d7e1a4603c3f4dfea_icgraph.png" border="0" usemap="#aclassgulp_1_1plugin_1_1_plugin_base_a381f36429810987d7e1a4603c3f4dfea_icgraph" alt=""/></div>
<map name="aclassgulp_1_1plugin_1_1_plugin_base_a381f36429810987d7e1a4603c3f4dfea_icgraph" id="aclassgulp_1_1plugin_1_1_plugin_base_a381f36429810987d7e1a4603c3f4dfea_icgraph">
<area shape="rect" title=" " alt="" coords="479,21,633,66"/>
<area shape="rect" href="classgulp_1_1plugin_1_1_plugin_base.html#abf39f32a2e7e60975eac7054393625da" title=" " alt="" coords="305,29,431,57"/>
<area shape="poly" title=" " alt="" coords="463,46,431,46,431,40,463,40"/>
<area shape="rect" href="classgulp_1_1plugins_1_1win__evtx_1_1_plugin.html#ab96082a9ecc6d0db5a48ee6958ac3239" title=" " alt="" coords="5,29,257,57"/>
<area shape="poly" title=" " alt="" coords="289,46,257,46,257,40,289,40"/>
<area shape="poly" title=" " alt="" coords="172,16,157,10,131,8,106,10,93,15,89,20,95,27,91,30,84,20,89,11,105,5,131,3,159,5,174,12"/>
</map>
</div>

</div>
</div>
<a id="a0f3983f38b1d29c20df0dd5a496359af" name="a0f3983f38b1d29c20df0dd5a496359af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f3983f38b1d29c20df0dd5a496359af">&#9670;&#160;</a></span>_finish_ingestion()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"> GulpRequestStatus _finish_ingestion </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str</td>          <td class="paramname"><span class="paramname"><em>index</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str | dict</td>          <td class="paramname"><span class="paramname"><em>source</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str</td>          <td class="paramname"><span class="paramname"><em>req_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>client_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str</td>          <td class="paramname"><span class="paramname"><em>ws_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TmpIngestStats</td>          <td class="paramname"><span class="paramname"><em>fs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GulpIngestionFilter </td>          <td class="paramname"><span class="paramname"><em>flt</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">to be called whenever ingest() must exit: flushes the buffer and updates the ingestion stats
</pre> 
<p class="definition">Definition at line <a class="el" href="plugin_8py_source.html#l00963">963</a> of file <a class="el" href="plugin_8py_source.html">plugin.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  972</span>    ) -&gt; GulpRequestStatus:</div>
<div class="line"><span class="lineno">  973</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  974</span><span class="stringliteral">        to be called whenever ingest() must exit: flushes the buffer and updates the ingestion stats</span></div>
<div class="line"><span class="lineno">  975</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  976</span>        <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  977</span>            <span class="comment"># finally flush ingestion buffer</span></div>
<div class="line"><span class="lineno">  978</span>            fs = await self._flush_buffer(index, fs, ws_id, req_id, flt)</div>
<div class="line"><span class="lineno">  979</span>            self.logger().info(</div>
<div class="line"><span class="lineno">  980</span>                <span class="stringliteral">&quot;INGESTION DONE FOR source=%s,\n\tclient_id=%d (processed=%d, failed=%d, skipped=%d, errors=%d, parser_errors=%d)&quot;</span></div>
<div class="line"><span class="lineno">  981</span>                % (</div>
<div class="line"><span class="lineno">  982</span>                    muty.string.make_shorter(str(source), 260),</div>
<div class="line"><span class="lineno">  983</span>                    client_id,</div>
<div class="line"><span class="lineno">  984</span>                    fs.ev_processed,</div>
<div class="line"><span class="lineno">  985</span>                    fs.ev_failed,</div>
<div class="line"><span class="lineno">  986</span>                    fs.ev_skipped,</div>
<div class="line"><span class="lineno">  987</span>                    len(fs.ingest_errors),</div>
<div class="line"><span class="lineno">  988</span>                    fs.parser_failed,</div>
<div class="line"><span class="lineno">  989</span>                )</div>
<div class="line"><span class="lineno">  990</span>            )</div>
<div class="line"><span class="lineno">  991</span>        <span class="keywordflow">except</span> Exception <span class="keyword">as</span> ex:</div>
<div class="line"><span class="lineno">  992</span>            fs = fs.update(ingest_errors=[ex])</div>
<div class="line"><span class="lineno">  993</span>            self.logger().exception(</div>
<div class="line"><span class="lineno">  994</span>                <span class="stringliteral">&quot;FAILED finalizing ingestion for source=%s&quot;</span></div>
<div class="line"><span class="lineno">  995</span>                % (muty.string.make_shorter(str(source), 260))</div>
<div class="line"><span class="lineno">  996</span>            )</div>
<div class="line"><span class="lineno">  997</span> </div>
<div class="line"><span class="lineno">  998</span>        <span class="keywordflow">finally</span>:</div>
<div class="line"><span class="lineno">  999</span>            status, _ = await GulpStats.update(</div>
<div class="line"><span class="lineno"> 1000</span>                self.collab,</div>
<div class="line"><span class="lineno"> 1001</span>                req_id,</div>
<div class="line"><span class="lineno"> 1002</span>                ws_id,</div>
<div class="line"><span class="lineno"> 1003</span>                fs=fs,</div>
<div class="line"><span class="lineno"> 1004</span>                force=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno"> 1005</span>                file_done=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno"> 1006</span>            )</div>
<div class="line"><span class="lineno"> 1007</span>        <span class="keywordflow">return</span> status</div>
<div class="line"><span class="lineno"> 1008</span> </div>
<div class="line"><span class="lineno"> 1009</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classgulp_1_1plugin_1_1_plugin_base_a0f3983f38b1d29c20df0dd5a496359af_cgraph.png" border="0" usemap="#aclassgulp_1_1plugin_1_1_plugin_base_a0f3983f38b1d29c20df0dd5a496359af_cgraph" alt=""/></div>
<map name="aclassgulp_1_1plugin_1_1_plugin_base_a0f3983f38b1d29c20df0dd5a496359af_cgraph" id="aclassgulp_1_1plugin_1_1_plugin_base_a0f3983f38b1d29c20df0dd5a496359af_cgraph">
<area shape="rect" title=" " alt="" coords="5,100,137,128"/>
<area shape="rect" href="classgulp_1_1plugin_1_1_plugin_base.html#a400aabb1893cbe98511a69414c8e58a2" title=" " alt="" coords="185,74,291,102"/>
<area shape="poly" title=" " alt="" coords="137,101,169,96,170,101,138,106"/>
<area shape="rect" href="classgulp_1_1plugin_1_1_plugin_base.html#adafcb65c64ccf4cd7aa243765c95cc92" title=" " alt="" coords="207,126,269,154"/>
<area shape="poly" title=" " alt="" coords="138,122,192,130,191,135,137,127"/>
<area shape="rect" href="classgulp_1_1plugin_1_1_plugin_base.html#a17fb4d6dbb155ae0f0646e3d9814fc01" title=" " alt="" coords="358,5,531,50"/>
<area shape="poly" title=" " alt="" coords="287,71,350,52,352,57,289,76"/>
<area shape="rect" href="classgulp_1_1plugin_1_1_plugin_base.html#a3cc5beb95fb74f4be44c04f84ed66a82" title=" " alt="" coords="415,74,473,102"/>
<area shape="poly" title=" " alt="" coords="292,85,399,85,399,90,292,90"/>
<area shape="rect" href="classgulp_1_1plugins_1_1csv_1_1_plugin.html#a3cc5beb95fb74f4be44c04f84ed66a82" title=" " alt="" coords="339,126,549,154"/>
<area shape="poly" title=" " alt="" coords="292,98,372,119,371,124,291,104"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classgulp_1_1plugin_1_1_plugin_base_a0f3983f38b1d29c20df0dd5a496359af_icgraph.png" border="0" usemap="#aclassgulp_1_1plugin_1_1_plugin_base_a0f3983f38b1d29c20df0dd5a496359af_icgraph" alt=""/></div>
<map name="aclassgulp_1_1plugin_1_1_plugin_base_a0f3983f38b1d29c20df0dd5a496359af_icgraph" id="aclassgulp_1_1plugin_1_1_plugin_base_a0f3983f38b1d29c20df0dd5a496359af_icgraph">
<area shape="rect" title=" " alt="" coords="305,29,436,57"/>
<area shape="rect" href="classgulp_1_1plugins_1_1win__evtx_1_1_plugin.html#ab96082a9ecc6d0db5a48ee6958ac3239" title=" " alt="" coords="5,29,257,57"/>
<area shape="poly" title=" " alt="" coords="289,46,257,46,257,40,289,40"/>
<area shape="poly" title=" " alt="" coords="172,16,158,10,131,8,106,10,92,15,89,20,95,27,90,30,84,20,89,11,105,5,131,3,159,5,174,12"/>
</map>
</div>

</div>
</div>
<a id="a400aabb1893cbe98511a69414c8e58a2" name="a400aabb1893cbe98511a69414c8e58a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a400aabb1893cbe98511a69414c8e58a2">&#9670;&#160;</a></span>_flush_buffer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"> TmpIngestStats _flush_buffer </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str</td>          <td class="paramname"><span class="paramname"><em>index</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TmpIngestStats</td>          <td class="paramname"><span class="paramname"><em>fs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str</td>          <td class="paramname"><span class="paramname"><em>ws_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str</td>          <td class="paramname"><span class="paramname"><em>req_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GulpIngestionFilter </td>          <td class="paramname"><span class="paramname"><em>flt</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool </td>          <td class="paramname"><span class="paramname"><em>wait_for_refresh</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">NOTE: errors appended by this function are intended as INGESTION errors:
it means something wrong with the format of the event, and must be fixed ASAP if this happens.
ideally, function should NEVER append errors and the errors total should be the same before and after this function returns (this function may only change the skipped total, which means some duplicates were found).
</pre> 
<p class="definition">Definition at line <a class="el" href="plugin_8py_source.html#l00857">857</a> of file <a class="el" href="plugin_8py_source.html">plugin.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  865</span>    ) -&gt; TmpIngestStats:</div>
<div class="line"><span class="lineno">  866</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  867</span><span class="stringliteral">        NOTE: errors appended by this function are intended as INGESTION errors:</span></div>
<div class="line"><span class="lineno">  868</span><span class="stringliteral">        it means something wrong with the format of the event, and must be fixed ASAP if this happens.</span></div>
<div class="line"><span class="lineno">  869</span><span class="stringliteral">        ideally, function should NEVER append errors and the errors total should be the same before and after this function returns (this function may only change the skipped total, which means some duplicates were found).</span></div>
<div class="line"><span class="lineno">  870</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  871</span>        <span class="keywordflow">if</span> len(self.buffer) == 0:</div>
<div class="line"><span class="lineno">  872</span>            <span class="comment"># already flushed</span></div>
<div class="line"><span class="lineno">  873</span>            <span class="keywordflow">return</span> fs</div>
<div class="line"><span class="lineno">  874</span> </div>
<div class="line"><span class="lineno">  875</span>        <span class="comment"># _logger.debug(&#39;flushing ingestion buffer, len=%d&#39; % (len(self.buffer)))</span></div>
<div class="line"><span class="lineno">  876</span> </div>
<div class="line"><span class="lineno">  877</span>        skipped, failed, failed_ar, ingested_docs = await elastic_api.ingest_bulk(</div>
<div class="line"><span class="lineno">  878</span>            self.elastic, index, self.buffer, flt=flt, wait_for_refresh=wait_for_refresh</div>
<div class="line"><span class="lineno">  879</span>        )</div>
<div class="line"><span class="lineno">  880</span>        <span class="comment"># print(json.dumps(ingested_docs, indent=2))</span></div>
<div class="line"><span class="lineno">  881</span> </div>
<div class="line"><span class="lineno">  882</span>        <span class="keywordflow">if</span> failed &gt; 0:</div>
<div class="line"><span class="lineno">  883</span>            <span class="keywordflow">if</span> config.debug_abort_on_elasticsearch_ingestion_error():</div>
<div class="line"><span class="lineno">  884</span>                <span class="keywordflow">raise</span> Exception(</div>
<div class="line"><span class="lineno">  885</span>                    <span class="stringliteral">&quot;elasticsearch ingestion errors means GulpDocument contains invalid data, review errors on collab db!&quot;</span></div>
<div class="line"><span class="lineno">  886</span>                )</div>
<div class="line"><span class="lineno">  887</span> </div>
<div class="line"><span class="lineno">  888</span>        self.buffer = []</div>
<div class="line"><span class="lineno">  889</span> </div>
<div class="line"><span class="lineno">  890</span>        <span class="comment"># build ingestion chunk</span></div>
<div class="line"><span class="lineno">  891</span>        ws_docs = self._build_ingestion_chunk_for_ws(ingested_docs, flt)</div>
<div class="line"><span class="lineno">  892</span> </div>
<div class="line"><span class="lineno">  893</span>        <span class="comment"># send ingested docs to websocket</span></div>
<div class="line"><span class="lineno">  894</span>        <span class="keywordflow">if</span> len(ws_docs) &gt; 0:</div>
<div class="line"><span class="lineno">  895</span>            ws_api.shared_queue_add_data(</div>
<div class="line"><span class="lineno">  896</span>                WsQueueDataType.INGESTION_CHUNK,</div>
<div class="line"><span class="lineno">  897</span>                req_id,</div>
<div class="line"><span class="lineno">  898</span>                {<span class="stringliteral">&quot;plugin&quot;</span>: self.name(), <span class="stringliteral">&quot;events&quot;</span>: ws_docs},</div>
<div class="line"><span class="lineno">  899</span>                ws_id=ws_id,</div>
<div class="line"><span class="lineno">  900</span>            )</div>
<div class="line"><span class="lineno">  901</span> </div>
<div class="line"><span class="lineno">  902</span>        <span class="comment"># update stats</span></div>
<div class="line"><span class="lineno">  903</span>        fs = fs.update(</div>
<div class="line"><span class="lineno">  904</span>            failed=failed,</div>
<div class="line"><span class="lineno">  905</span>            skipped=skipped,</div>
<div class="line"><span class="lineno">  906</span>            ingest_errors=failed_ar,</div>
<div class="line"><span class="lineno">  907</span>        )</div>
<div class="line"><span class="lineno">  908</span>        <span class="keywordflow">return</span> fs</div>
<div class="line"><span class="lineno">  909</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classgulp_1_1plugin_1_1_plugin_base_a400aabb1893cbe98511a69414c8e58a2_cgraph.png" border="0" usemap="#aclassgulp_1_1plugin_1_1_plugin_base_a400aabb1893cbe98511a69414c8e58a2_cgraph" alt=""/></div>
<map name="aclassgulp_1_1plugin_1_1_plugin_base_a400aabb1893cbe98511a69414c8e58a2_cgraph" id="aclassgulp_1_1plugin_1_1_plugin_base_a400aabb1893cbe98511a69414c8e58a2_cgraph">
<area shape="rect" title=" " alt="" coords="5,74,112,102"/>
<area shape="rect" href="classgulp_1_1plugin_1_1_plugin_base.html#a17fb4d6dbb155ae0f0646e3d9814fc01" title=" " alt="" coords="178,5,352,50"/>
<area shape="poly" title=" " alt="" coords="108,71,171,52,172,57,109,76"/>
<area shape="rect" href="classgulp_1_1plugin_1_1_plugin_base.html#a3cc5beb95fb74f4be44c04f84ed66a82" title=" " alt="" coords="236,74,294,102"/>
<area shape="poly" title=" " alt="" coords="112,85,220,85,220,90,112,90"/>
<area shape="rect" href="classgulp_1_1plugins_1_1csv_1_1_plugin.html#a3cc5beb95fb74f4be44c04f84ed66a82" title=" " alt="" coords="160,126,370,154"/>
<area shape="poly" title=" " alt="" coords="113,98,193,119,192,124,112,104"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classgulp_1_1plugin_1_1_plugin_base_a400aabb1893cbe98511a69414c8e58a2_icgraph.png" border="0" usemap="#aclassgulp_1_1plugin_1_1_plugin_base_a400aabb1893cbe98511a69414c8e58a2_icgraph" alt=""/></div>
<map name="aclassgulp_1_1plugin_1_1_plugin_base_a400aabb1893cbe98511a69414c8e58a2_icgraph" id="aclassgulp_1_1plugin_1_1_plugin_base_a400aabb1893cbe98511a69414c8e58a2_icgraph">
<area shape="rect" title=" " alt="" coords="648,32,755,60"/>
<area shape="rect" href="classgulp_1_1plugin_1_1_plugin_base.html#a0f3983f38b1d29c20df0dd5a496359af" title=" " alt="" coords="305,5,436,33"/>
<area shape="poly" title=" " alt="" coords="632,43,436,27,437,22,633,38"/>
<area shape="rect" href="classgulp_1_1plugin_1_1_plugin_base.html#ad9cf9630b6d3e7ae9eab1b880e786222" title=" " alt="" coords="484,57,600,85"/>
<area shape="poly" title=" " alt="" coords="634,59,601,65,600,59,633,54"/>
<area shape="rect" href="classgulp_1_1plugins_1_1win__evtx_1_1_plugin.html#ab96082a9ecc6d0db5a48ee6958ac3239" title=" " alt="" coords="5,32,257,60"/>
<area shape="poly" title=" " alt="" coords="290,31,257,34,257,29,289,25"/>
<area shape="poly" title=" " alt="" coords="172,19,158,13,131,11,106,13,92,17,89,23,95,30,90,33,84,23,89,13,105,7,131,5,159,8,174,14"/>
<area shape="rect" href="classgulp_1_1plugin_1_1_plugin_base.html#abf39f32a2e7e60975eac7054393625da" title=" " alt="" coords="307,57,434,85"/>
<area shape="poly" title=" " alt="" coords="468,74,434,74,434,68,468,68"/>
<area shape="poly" title=" " alt="" coords="292,66,257,62,257,57,292,60"/>
</map>
</div>

</div>
</div>
<a id="ad9cf9630b6d3e7ae9eab1b880e786222" name="ad9cf9630b6d3e7ae9eab1b880e786222"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9cf9630b6d3e7ae9eab1b880e786222">&#9670;&#160;</a></span>_ingest_record()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"> TmpIngestStats _ingest_record </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str</td>          <td class="paramname"><span class="paramname"><em>index</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GulpDocument | dict</td>          <td class="paramname"><span class="paramname"><em>doc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TmpIngestStats</td>          <td class="paramname"><span class="paramname"><em>fs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str</td>          <td class="paramname"><span class="paramname"><em>ws_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str</td>          <td class="paramname"><span class="paramname"><em>req_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GulpIngestionFilter </td>          <td class="paramname"><span class="paramname"><em>flt</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool </td>          <td class="paramname"><span class="paramname"><em>flush_enabled</em></span><span class="paramdefsep"> = </span><span class="paramdefval">True</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">**</td>          <td class="paramname"><span class="paramname"><em>kwargs</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">bufferize as much as ingestion_buffer_size, then flush (writes to elasticsearch)
</pre> 
<p class="definition">Definition at line <a class="el" href="plugin_8py_source.html#l00910">910</a> of file <a class="el" href="plugin_8py_source.html">plugin.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  920</span>    ) -&gt; TmpIngestStats:</div>
<div class="line"><span class="lineno">  921</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  922</span><span class="stringliteral">        bufferize as much as ingestion_buffer_size, then flush (writes to elasticsearch)</span></div>
<div class="line"><span class="lineno">  923</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  924</span>        ingestion_buffer_size = config.config().get(<span class="stringliteral">&quot;ingestion_buffer_size&quot;</span>, 1000)</div>
<div class="line"><span class="lineno">  925</span>        self.buffer.append(doc)</div>
<div class="line"><span class="lineno">  926</span>        <span class="keywordflow">if</span> len(self.buffer) &gt;= ingestion_buffer_size <span class="keywordflow">and</span> flush_enabled:</div>
<div class="line"><span class="lineno">  927</span>            <span class="comment"># time to flush</span></div>
<div class="line"><span class="lineno">  928</span>            fs = await self._flush_buffer(index, fs, ws_id, req_id, flt)</div>
<div class="line"><span class="lineno">  929</span> </div>
<div class="line"><span class="lineno">  930</span>        <span class="keywordflow">return</span> fs</div>
<div class="line"><span class="lineno">  931</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classgulp_1_1plugin_1_1_plugin_base_ad9cf9630b6d3e7ae9eab1b880e786222_cgraph.png" border="0" usemap="#aclassgulp_1_1plugin_1_1_plugin_base_ad9cf9630b6d3e7ae9eab1b880e786222_cgraph" alt=""/></div>
<map name="aclassgulp_1_1plugin_1_1_plugin_base_ad9cf9630b6d3e7ae9eab1b880e786222_cgraph" id="aclassgulp_1_1plugin_1_1_plugin_base_ad9cf9630b6d3e7ae9eab1b880e786222_cgraph">
<area shape="rect" title=" " alt="" coords="5,74,122,102"/>
<area shape="rect" href="classgulp_1_1plugin_1_1_plugin_base.html#a400aabb1893cbe98511a69414c8e58a2" title=" " alt="" coords="170,74,276,102"/>
<area shape="poly" title=" " alt="" coords="122,85,154,85,154,90,122,90"/>
<area shape="rect" href="classgulp_1_1plugin_1_1_plugin_base.html#a17fb4d6dbb155ae0f0646e3d9814fc01" title=" " alt="" coords="342,5,516,50"/>
<area shape="poly" title=" " alt="" coords="272,71,335,52,337,57,274,76"/>
<area shape="rect" href="classgulp_1_1plugin_1_1_plugin_base.html#a3cc5beb95fb74f4be44c04f84ed66a82" title=" " alt="" coords="400,74,458,102"/>
<area shape="poly" title=" " alt="" coords="277,85,384,85,384,90,277,90"/>
<area shape="rect" href="classgulp_1_1plugins_1_1csv_1_1_plugin.html#a3cc5beb95fb74f4be44c04f84ed66a82" title=" " alt="" coords="324,126,534,154"/>
<area shape="poly" title=" " alt="" coords="277,98,357,119,356,124,276,104"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classgulp_1_1plugin_1_1_plugin_base_ad9cf9630b6d3e7ae9eab1b880e786222_icgraph.png" border="0" usemap="#aclassgulp_1_1plugin_1_1_plugin_base_ad9cf9630b6d3e7ae9eab1b880e786222_icgraph" alt=""/></div>
<map name="aclassgulp_1_1plugin_1_1_plugin_base_ad9cf9630b6d3e7ae9eab1b880e786222_icgraph" id="aclassgulp_1_1plugin_1_1_plugin_base_ad9cf9630b6d3e7ae9eab1b880e786222_icgraph">
<area shape="rect" title=" " alt="" coords="479,29,595,57"/>
<area shape="rect" href="classgulp_1_1plugin_1_1_plugin_base.html#abf39f32a2e7e60975eac7054393625da" title=" " alt="" coords="305,29,431,57"/>
<area shape="poly" title=" " alt="" coords="463,46,431,46,431,40,463,40"/>
<area shape="rect" href="classgulp_1_1plugins_1_1win__evtx_1_1_plugin.html#ab96082a9ecc6d0db5a48ee6958ac3239" title=" " alt="" coords="5,29,257,57"/>
<area shape="poly" title=" " alt="" coords="289,46,257,46,257,40,289,40"/>
<area shape="poly" title=" " alt="" coords="172,16,157,10,131,8,106,10,93,15,89,20,95,27,91,30,84,20,89,11,105,5,131,3,159,5,174,12"/>
</map>
</div>

</div>
</div>
<a id="a4b661e5352802554dc25028526496f7b" name="a4b661e5352802554dc25028526496f7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b661e5352802554dc25028526496f7b">&#9670;&#160;</a></span>_map_source_key()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"> list[FieldMappingEntry] _map_source_key </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classgulp_1_1plugin__internal_1_1_gulp_plugin_params.html">GulpPluginParams</a></td>          <td class="paramname"><span class="paramname"><em>plugin_params</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GulpMapping</td>          <td class="paramname"><span class="paramname"><em>custom_mapping</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str</td>          <td class="paramname"><span class="paramname"><em>source_key</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Any</td>          <td class="paramname"><span class="paramname"><em>v</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dict </td>          <td class="paramname"><span class="paramname"><em>index_type_mapping</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool </td>          <td class="paramname"><span class="paramname"><em>ignore_custom_mapping</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">**</td>          <td class="paramname"><span class="paramname"><em>kwargs</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">map source key to a field mapping entry with "result": {mapped_key: v}

Args:
    plugin_params (GulpPluginParams): The plugin parameters.
    custom_mapping (GulpMapping): The custom mapping.
    source_key (str): The key to look for(=the event record key to be mapped) in the custom_mapping dictionary
    v (any): value to set for mapped key/s.
    index_type_mapping (dict, optional): The elasticsearch index key-&gt;type mappings. Defaults to None.
    ignore_custom_mapping (bool, optional): Whether to ignore custom_mapping and directly map source_key to v. Defaults to False.
    kwargs: Additional keyword arguments.

Returns:
    list[FieldMappingEntry]: zero or more FieldMappingEntry objects with "result" set.
</pre> 
<p class="definition">Definition at line <a class="el" href="plugin_8py_source.html#l00683">683</a> of file <a class="el" href="plugin_8py_source.html">plugin.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  692</span>    ) -&gt; list[FieldMappingEntry]:</div>
<div class="line"><span class="lineno">  693</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  694</span><span class="stringliteral">        map source key to a field mapping entry with &quot;result&quot;: {mapped_key: v}</span></div>
<div class="line"><span class="lineno">  695</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  696</span><span class="stringliteral">        Args:</span></div>
<div class="line"><span class="lineno">  697</span><span class="stringliteral">            plugin_params (GulpPluginParams): The plugin parameters.</span></div>
<div class="line"><span class="lineno">  698</span><span class="stringliteral">            custom_mapping (GulpMapping): The custom mapping.</span></div>
<div class="line"><span class="lineno">  699</span><span class="stringliteral">            source_key (str): The key to look for(=the event record key to be mapped) in the custom_mapping dictionary</span></div>
<div class="line"><span class="lineno">  700</span><span class="stringliteral">            v (any): value to set for mapped key/s.</span></div>
<div class="line"><span class="lineno">  701</span><span class="stringliteral">            index_type_mapping (dict, optional): The elasticsearch index key-&gt;type mappings. Defaults to None.</span></div>
<div class="line"><span class="lineno">  702</span><span class="stringliteral">            ignore_custom_mapping (bool, optional): Whether to ignore custom_mapping and directly map source_key to v. Defaults to False.</span></div>
<div class="line"><span class="lineno">  703</span><span class="stringliteral">            kwargs: Additional keyword arguments.</span></div>
<div class="line"><span class="lineno">  704</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  705</span><span class="stringliteral">        Returns:</span></div>
<div class="line"><span class="lineno">  706</span><span class="stringliteral">            list[FieldMappingEntry]: zero or more FieldMappingEntry objects with &quot;result&quot; set.</span></div>
<div class="line"><span class="lineno">  707</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  708</span>        <span class="comment"># get mapping and option from custom_mapping</span></div>
<div class="line"><span class="lineno">  709</span>        <span class="keywordflow">if</span> index_type_mapping <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  710</span>            index_type_mapping = {}</div>
<div class="line"><span class="lineno">  711</span>        <span class="comment"># _logger.debug(&#39;len index type mapping=%d&#39; % (len(index_type_mapping)))</span></div>
<div class="line"><span class="lineno">  712</span>        mapping_dict: dict = custom_mapping.fields</div>
<div class="line"><span class="lineno">  713</span>        mapping_options = (</div>
<div class="line"><span class="lineno">  714</span>            custom_mapping.options</div>
<div class="line"><span class="lineno">  715</span>            <span class="keywordflow">if</span> custom_mapping.options <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  716</span>            <span class="keywordflow">else</span> GulpMappingOptions()</div>
<div class="line"><span class="lineno">  717</span>        )</div>
<div class="line"><span class="lineno">  718</span> </div>
<div class="line"><span class="lineno">  719</span>        <span class="comment"># basic checks</span></div>
<div class="line"><span class="lineno">  720</span>        <span class="keywordflow">if</span> v == <span class="stringliteral">&quot;-&quot;</span> <span class="keywordflow">or</span> v <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  721</span>            <span class="keywordflow">return</span> []</div>
<div class="line"><span class="lineno">  722</span> </div>
<div class="line"><span class="lineno">  723</span>        <span class="keywordflow">if</span> isinstance(v, str):</div>
<div class="line"><span class="lineno">  724</span>            v = v.strip()</div>
<div class="line"><span class="lineno">  725</span>            <span class="keywordflow">if</span> <span class="keywordflow">not</span> v <span class="keywordflow">and</span> mapping_options.ignore_blanks:</div>
<div class="line"><span class="lineno">  726</span>                <span class="comment"># not adding blank strings</span></div>
<div class="line"><span class="lineno">  727</span>                <span class="keywordflow">return</span> []</div>
<div class="line"><span class="lineno">  728</span> </div>
<div class="line"><span class="lineno">  729</span>        <span class="comment"># fix value if needed, and add to extra</span></div>
<div class="line"><span class="lineno">  730</span>        <span class="keywordflow">if</span> ignore_custom_mapping <span class="keywordflow">or</span> (</div>
<div class="line"><span class="lineno">  731</span>            plugin_params <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> plugin_params.ignore_mapping_ingest</div>
<div class="line"><span class="lineno">  732</span>        ):</div>
<div class="line"><span class="lineno">  733</span>            <span class="comment"># direct mapping, no need to check custom_mappings</span></div>
<div class="line"><span class="lineno">  734</span>            <span class="keywordflow">return</span> [FieldMappingEntry(result={source_key: v})]</div>
<div class="line"><span class="lineno">  735</span> </div>
<div class="line"><span class="lineno">  736</span>        <span class="keywordflow">if</span> source_key <span class="keywordflow">not</span> <span class="keywordflow">in</span> mapping_dict:</div>
<div class="line"><span class="lineno">  737</span>            <span class="comment"># self.logger().error(&#39;key &quot;%s&quot; not found in custom mapping, mapping_dict=%s!&#39; % (source_key, muty.string.make_shorter(str(mapping_dict))))</span></div>
<div class="line"><span class="lineno">  738</span>            <span class="comment"># key not found in custom_mapping, check if we have to map it anyway</span></div>
<div class="line"><span class="lineno">  739</span>            <span class="keywordflow">if</span> <span class="keywordflow">not</span> mapping_options.ignore_unmapped:</div>
<div class="line"><span class="lineno">  740</span>                <span class="keywordflow">return</span> [</div>
<div class="line"><span class="lineno">  741</span>                    FieldMappingEntry(</div>
<div class="line"><span class="lineno">  742</span>                        result={self.get_unmapped_field_name(source_key): str(v)}</div>
<div class="line"><span class="lineno">  743</span>                    )</div>
<div class="line"><span class="lineno">  744</span>                ]</div>
<div class="line"><span class="lineno">  745</span> </div>
<div class="line"><span class="lineno">  746</span>        <span class="comment"># there is a mapping defined to be processed</span></div>
<div class="line"><span class="lineno">  747</span>        fm: FieldMappingEntry = mapping_dict[source_key]</div>
<div class="line"><span class="lineno">  748</span>        map_to_list = (</div>
<div class="line"><span class="lineno">  749</span>            [fm.map_to] <span class="keywordflow">if</span> isinstance(fm.map_to, (str, type(<span class="keywordtype">None</span>))) <span class="keywordflow">else</span> fm.map_to</div>
<div class="line"><span class="lineno">  750</span>        )</div>
<div class="line"><span class="lineno">  751</span> </div>
<div class="line"><span class="lineno">  752</span>        <span class="comment"># in the end, this function will return a list of FieldMappingEntry objects with &quot;result&quot; set: these results will be used to create the GulpDocument object</span></div>
<div class="line"><span class="lineno">  753</span>        fme_list: list[FieldMappingEntry] = []</div>
<div class="line"><span class="lineno">  754</span>        <span class="keywordflow">for</span> k <span class="keywordflow">in</span> map_to_list:</div>
<div class="line"><span class="lineno">  755</span>            <span class="comment"># make a copy of fme without using deepcopy)</span></div>
<div class="line"><span class="lineno">  756</span>            dest_fm = FieldMappingEntry(</div>
<div class="line"><span class="lineno">  757</span>                is_timestamp=fm.is_timestamp,</div>
<div class="line"><span class="lineno">  758</span>                event_code=fm.event_code,</div>
<div class="line"><span class="lineno">  759</span>                do_multiply=fm.do_multiply,</div>
<div class="line"><span class="lineno">  760</span>                is_timestamp_chrome=fm.is_timestamp_chrome,</div>
<div class="line"><span class="lineno">  761</span>                is_variable_mapping=fm.is_variable_mapping,</div>
<div class="line"><span class="lineno">  762</span>                result={},</div>
<div class="line"><span class="lineno">  763</span>            )</div>
<div class="line"><span class="lineno">  764</span> </div>
<div class="line"><span class="lineno">  765</span>            <span class="comment"># check if it is a number and/or a timestamp (including chrome timestamp, which is a special case)</span></div>
<div class="line"><span class="lineno">  766</span>            is_numeric = isinstance(v, int) <span class="keywordflow">or</span> str(v).isnumeric()</div>
<div class="line"><span class="lineno">  767</span>            <span class="keywordflow">if</span> is_numeric:</div>
<div class="line"><span class="lineno">  768</span>                v = int(v)</div>
<div class="line"><span class="lineno">  769</span>                <span class="comment"># ensure chrome timestamp is properly converted to nanos</span></div>
<div class="line"><span class="lineno">  770</span>                <span class="comment"># _logger.debug(&#39;***** is_numeric, v=%d&#39; % (v))</span></div>
<div class="line"><span class="lineno">  771</span>                <span class="keywordflow">if</span> fm.is_timestamp_chrome:</div>
<div class="line"><span class="lineno">  772</span>                    v = int(muty.time.chrome_epoch_to_nanos(v))</div>
<div class="line"><span class="lineno">  773</span>                    <span class="comment"># _logger.debug(&#39;***** is_timestamp_chrome, v nsec=%d&#39; % (v))</span></div>
<div class="line"><span class="lineno">  774</span> </div>
<div class="line"><span class="lineno">  775</span>                <span class="keywordflow">if</span> fm.do_multiply <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  776</span>                    <span class="comment"># apply a multipler if any (must turn v to nanoseconds)</span></div>
<div class="line"><span class="lineno">  777</span>                    <span class="comment"># _logger.debug(&quot;***** is_numeric, multiply, v=%d&quot; % (v))</span></div>
<div class="line"><span class="lineno">  778</span>                    v = int(v * fm.do_multiply)</div>
<div class="line"><span class="lineno">  779</span>                    <span class="comment"># _logger.debug(&quot;***** is_numeric, AFTER multiply, v=%d&quot; % (v))</span></div>
<div class="line"><span class="lineno">  780</span> </div>
<div class="line"><span class="lineno">  781</span>            <span class="keywordflow">elif</span> isinstance(v, str) <span class="keywordflow">and</span> fm.is_timestamp:</div>
<div class="line"><span class="lineno">  782</span>                v = int(</div>
<div class="line"><span class="lineno">  783</span>                    muty.time.string_to_epoch_nsec(</div>
<div class="line"><span class="lineno">  784</span>                        v,</div>
<div class="line"><span class="lineno">  785</span>                        utc=mapping_options.timestamp_utc,</div>
<div class="line"><span class="lineno">  786</span>                        dayfirst=mapping_options.timestamp_dayfirst,</div>
<div class="line"><span class="lineno">  787</span>                        yearfirst=mapping_options.timestamp_yearfirst,</div>
<div class="line"><span class="lineno">  788</span>                    )</div>
<div class="line"><span class="lineno">  789</span>                )</div>
<div class="line"><span class="lineno">  790</span>                <span class="comment"># _logger.debug(&#39;***** str and is_timestamp, v nsec=%d&#39; % (v))</span></div>
<div class="line"><span class="lineno">  791</span>            <span class="keywordflow">if</span> fm.is_timestamp:</div>
<div class="line"><span class="lineno">  792</span>                <span class="comment"># it&#39;s a timestamp, another event will be generated</span></div>
<div class="line"><span class="lineno">  793</span>                vv = muty.time.nanos_to_millis(v)</div>
<div class="line"><span class="lineno">  794</span>                dest_fm.result[<span class="stringliteral">&quot;@timestamp&quot;</span>] = vv</div>
<div class="line"><span class="lineno">  795</span>                dest_fm.result[<span class="stringliteral">&quot;@timestamp_nsec&quot;</span>] = v</div>
<div class="line"><span class="lineno">  796</span>                <span class="comment"># _logger.debug(&#39;***** timestamp nanos, v=%d&#39; % (v))</span></div>
<div class="line"><span class="lineno">  797</span>                <span class="comment"># _logger.debug(&#39;***** timestamp to millis, v=%d&#39; % (vv))</span></div>
<div class="line"><span class="lineno">  798</span> </div>
<div class="line"><span class="lineno">  799</span>            <span class="keywordflow">if</span> fm.is_timestamp <span class="keywordflow">or</span> fm.is_timestamp_chrome:</div>
<div class="line"><span class="lineno">  800</span>                <span class="comment"># _logger.debug(&#39;***** timestamp or timestamp_chrome, v=%d&#39; % (v))</span></div>
<div class="line"><span class="lineno">  801</span>                <span class="keywordflow">if</span> v &lt; 0:</div>
<div class="line"><span class="lineno">  802</span>                    <span class="comment"># _logger.debug(&#39;***** adding invalid timestamp&#39;)</span></div>
<div class="line"><span class="lineno">  803</span>                    v = 0</div>
<div class="line"><span class="lineno">  804</span>                    GulpDocument.add_invalid_timestamp(dest_fm.result)</div>
<div class="line"><span class="lineno">  805</span>                <span class="keywordflow">if</span> k <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  806</span>                    <span class="comment"># also add to mapped key</span></div>
<div class="line"><span class="lineno">  807</span>                    dest_fm.result[k] = v</div>
<div class="line"><span class="lineno">  808</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  809</span>                <span class="comment"># not a timestamp, map</span></div>
<div class="line"><span class="lineno">  810</span>                <span class="keywordflow">if</span> k <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  811</span>                    <span class="comment"># add unmapped</span></div>
<div class="line"><span class="lineno">  812</span>                    k = self.get_unmapped_field_name(source_key)</div>
<div class="line"><span class="lineno">  813</span>                <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  814</span>                    v = self._type_checks(v, k, index_type_mapping)</div>
<div class="line"><span class="lineno">  815</span>                dest_fm.result[k] = v</div>
<div class="line"><span class="lineno">  816</span> </div>
<div class="line"><span class="lineno">  817</span>            fme_list.append(dest_fm)</div>
<div class="line"><span class="lineno">  818</span>            <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  819</span><span class="stringliteral">            self.logger().debug(&#39;FME LIST FOR THIS RECORD:&#39;)</span></div>
<div class="line"><span class="lineno">  820</span><span class="stringliteral">            for p in fme_list:</span></div>
<div class="line"><span class="lineno">  821</span><span class="stringliteral">                self.logger().debug(p)</span></div>
<div class="line"><span class="lineno">  822</span><span class="stringliteral">            self.logger().debug(&#39;---------------------------------&#39;)</span></div>
<div class="line"><span class="lineno">  823</span><span class="stringliteral">            &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  824</span>        <span class="keywordflow">return</span> fme_list</div>
<div class="line"><span class="lineno">  825</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classgulp_1_1plugin_1_1_plugin_base_a4b661e5352802554dc25028526496f7b_cgraph.png" border="0" usemap="#aclassgulp_1_1plugin_1_1_plugin_base_a4b661e5352802554dc25028526496f7b_cgraph" alt=""/></div>
<map name="aclassgulp_1_1plugin_1_1_plugin_base_a4b661e5352802554dc25028526496f7b_cgraph" id="aclassgulp_1_1plugin_1_1_plugin_base_a4b661e5352802554dc25028526496f7b_cgraph">
<area shape="rect" title=" " alt="" coords="5,57,143,85"/>
<area shape="rect" href="classgulp_1_1plugin_1_1_plugin_base.html#acfc929fce907dcf945a52ffb8dc5b2ed" title=" " alt="" coords="235,5,344,33"/>
<area shape="poly" title=" " alt="" coords="134,54,219,33,220,39,135,59"/>
<area shape="rect" href="classgulp_1_1plugin_1_1_plugin_base.html#ac5c86b4ede215ac0ba20d028ad717c3e" title=" " alt="" coords="191,57,389,85"/>
<area shape="poly" title=" " alt="" coords="143,68,175,68,175,74,143,74"/>
<area shape="rect" href="classgulp_1_1plugin_1_1_plugin_base.html#a48d7d6a080b67ba8c58522a1e05ce930" title=" " alt="" coords="265,109,315,137"/>
<area shape="poly" title=" " alt="" coords="135,83,251,111,249,116,134,88"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classgulp_1_1plugin_1_1_plugin_base_a4b661e5352802554dc25028526496f7b_icgraph.png" border="0" usemap="#aclassgulp_1_1plugin_1_1_plugin_base_a4b661e5352802554dc25028526496f7b_icgraph" alt=""/></div>
<map name="aclassgulp_1_1plugin_1_1_plugin_base_a4b661e5352802554dc25028526496f7b_icgraph" id="aclassgulp_1_1plugin_1_1_plugin_base_a4b661e5352802554dc25028526496f7b_icgraph">
<area shape="rect" title=" " alt="" coords="605,29,742,57"/>
<area shape="rect" href="classgulp_1_1plugins_1_1win__evtx_1_1_plugin.html#a38a3b56e6818d69a12aa847ac980895e" title=" " alt="" coords="305,21,557,66"/>
<area shape="poly" title=" " alt="" coords="590,46,557,46,557,40,590,40"/>
<area shape="rect" href="classgulp_1_1plugins_1_1win__evtx_1_1_plugin.html#ab96082a9ecc6d0db5a48ee6958ac3239" title=" " alt="" coords="5,29,257,57"/>
<area shape="poly" title=" " alt="" coords="289,46,257,46,257,40,289,40"/>
<area shape="poly" title=" " alt="" coords="183,17,166,10,131,8,99,10,82,15,77,20,85,27,81,31,72,20,79,11,99,5,131,3,167,5,185,12"/>
</map>
</div>

</div>
</div>
<a id="a28ec6d78487be57c105863d9f58904e7" name="a28ec6d78487be57c105863d9f58904e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28ec6d78487be57c105863d9f58904e7">&#9670;&#160;</a></span>_parser_failed()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"> TmpIngestStats _parser_failed </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TmpIngestStats</td>          <td class="paramname"><span class="paramname"><em>fs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str | dict</td>          <td class="paramname"><span class="paramname"><em>source</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Exception | str
    </td>          <td class="paramname"><span class="paramname"><em>ex</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">whole source failed ingestion (error happened before the record parsing loop), helper to update stats
</pre> 
<p class="definition">Definition at line <a class="el" href="plugin_8py_source.html#l00932">932</a> of file <a class="el" href="plugin_8py_source.html">plugin.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  934</span>    ) -&gt; TmpIngestStats:</div>
<div class="line"><span class="lineno">  935</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  936</span><span class="stringliteral">        whole source failed ingestion (error happened before the record parsing loop), helper to update stats</span></div>
<div class="line"><span class="lineno">  937</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  938</span>        self.logger().exception(</div>
<div class="line"><span class="lineno">  939</span>            <span class="stringliteral">&quot;PARSER FAILED: source=%s, ex=%s&quot;</span></div>
<div class="line"><span class="lineno">  940</span>            % (muty.string.make_shorter(str(source), 260), ex)</div>
<div class="line"><span class="lineno">  941</span>        )</div>
<div class="line"><span class="lineno">  942</span>        fs = fs.update(ingest_errors=[ex], parser_failed=1)</div>
<div class="line"><span class="lineno">  943</span>        <span class="keywordflow">return</span> fs</div>
<div class="line"><span class="lineno">  944</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classgulp_1_1plugin_1_1_plugin_base_a28ec6d78487be57c105863d9f58904e7_cgraph.png" border="0" usemap="#aclassgulp_1_1plugin_1_1_plugin_base_a28ec6d78487be57c105863d9f58904e7_cgraph" alt=""/></div>
<map name="aclassgulp_1_1plugin_1_1_plugin_base_a28ec6d78487be57c105863d9f58904e7_cgraph" id="aclassgulp_1_1plugin_1_1_plugin_base_a28ec6d78487be57c105863d9f58904e7_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,119,33"/>
<area shape="rect" href="classgulp_1_1plugin_1_1_plugin_base.html#adafcb65c64ccf4cd7aa243765c95cc92" title=" " alt="" coords="167,5,229,33"/>
<area shape="poly" title=" " alt="" coords="119,16,151,16,151,22,119,22"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classgulp_1_1plugin_1_1_plugin_base_a28ec6d78487be57c105863d9f58904e7_icgraph.png" border="0" usemap="#aclassgulp_1_1plugin_1_1_plugin_base_a28ec6d78487be57c105863d9f58904e7_icgraph" alt=""/></div>
<map name="aclassgulp_1_1plugin_1_1_plugin_base_a28ec6d78487be57c105863d9f58904e7_icgraph" id="aclassgulp_1_1plugin_1_1_plugin_base_a28ec6d78487be57c105863d9f58904e7_icgraph">
<area shape="rect" title=" " alt="" coords="305,29,418,57"/>
<area shape="rect" href="classgulp_1_1plugins_1_1win__evtx_1_1_plugin.html#ab96082a9ecc6d0db5a48ee6958ac3239" title=" " alt="" coords="5,29,257,57"/>
<area shape="poly" title=" " alt="" coords="289,46,257,46,257,40,289,40"/>
<area shape="poly" title=" " alt="" coords="170,16,157,10,131,8,107,10,94,15,91,20,96,27,92,30,85,20,90,11,106,5,131,3,158,5,173,12"/>
</map>
</div>

</div>
</div>
<a id="ac39f95b7470b242061ba67ee749c4b44" name="ac39f95b7470b242061ba67ee749c4b44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac39f95b7470b242061ba67ee749c4b44">&#9670;&#160;</a></span>_process_plugin_params()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"> tuple[GulpMapping, <a class="el" href="classgulp_1_1plugin__internal_1_1_gulp_plugin_params.html">GulpPluginParams</a>] _process_plugin_params </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GulpMapping</td>          <td class="paramname"><span class="paramname"><em>custom_mapping</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classgulp_1_1plugin__internal_1_1_gulp_plugin_params.html">GulpPluginParams</a> </td>          <td class="paramname"><span class="paramname"><em>plugin_params</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Process the plugin parameters checking parameters as `timestamp_field`, ... and update the custom mapping accordingly.

Args:
    custom_mapping (GulpMapping): The custom mapping provided: if it is not empty, it will be used as is (plugin_params will be ignored)
    plugin_params (GulpPluginParams, optional): The plugin parameters. Defaults to None.

Returns:
    tuple[GulpMapping, GulpPluginParams]: The updated custom mapping and plugin parameters.
</pre> 
<p class="definition">Definition at line <a class="el" href="plugin_8py_source.html#l00166">166</a> of file <a class="el" href="plugin_8py_source.html">plugin.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  168</span>    ) -&gt; tuple[GulpMapping, GulpPluginParams]:</div>
<div class="line"><span class="lineno">  169</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  170</span><span class="stringliteral">        Process the plugin parameters checking parameters as `timestamp_field`, ... and update the custom mapping accordingly.</span></div>
<div class="line"><span class="lineno">  171</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  172</span><span class="stringliteral">        Args:</span></div>
<div class="line"><span class="lineno">  173</span><span class="stringliteral">            custom_mapping (GulpMapping): The custom mapping provided: if it is not empty, it will be used as is (plugin_params will be ignored)</span></div>
<div class="line"><span class="lineno">  174</span><span class="stringliteral">            plugin_params (GulpPluginParams, optional): The plugin parameters. Defaults to None.</span></div>
<div class="line"><span class="lineno">  175</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  176</span><span class="stringliteral">        Returns:</span></div>
<div class="line"><span class="lineno">  177</span><span class="stringliteral">            tuple[GulpMapping, GulpPluginParams]: The updated custom mapping and plugin parameters.</span></div>
<div class="line"><span class="lineno">  178</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  179</span>        <span class="keywordflow">if</span> plugin_params <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  180</span>            plugin_params = GulpPluginParams()</div>
<div class="line"><span class="lineno">  181</span> </div>
<div class="line"><span class="lineno">  182</span>        <span class="keywordflow">if</span> len(custom_mapping.fields) &gt; 0:</div>
<div class="line"><span class="lineno">  183</span>            <span class="comment"># custom_mapping provided</span></div>
<div class="line"><span class="lineno">  184</span>            <span class="keywordflow">return</span> custom_mapping, plugin_params</div>
<div class="line"><span class="lineno">  185</span> </div>
<div class="line"><span class="lineno">  186</span>        self.logger().warning(<span class="stringliteral">&quot;no custom mapping provided&quot;</span>)</div>
<div class="line"><span class="lineno">  187</span> </div>
<div class="line"><span class="lineno">  188</span>        tf = plugin_params.timestamp_field</div>
<div class="line"><span class="lineno">  189</span>        <span class="keywordflow">if</span> tf <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  190</span>            self.logger().debug(<span class="stringliteral">&quot;using timestamp_field=%s&quot;</span> % (tf))</div>
<div class="line"><span class="lineno">  191</span>            <span class="comment"># build a proper custom_mapping with just timestamp</span></div>
<div class="line"><span class="lineno">  192</span>            custom_mapping.fields[tf] = FieldMappingEntry(is_timestamp=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  193</span>        <span class="comment"># self.logger().debug(custom_mapping)</span></div>
<div class="line"><span class="lineno">  194</span>        <span class="keywordflow">return</span> custom_mapping, plugin_params</div>
<div class="line"><span class="lineno">  195</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classgulp_1_1plugin_1_1_plugin_base_ac39f95b7470b242061ba67ee749c4b44_cgraph.png" border="0" usemap="#aclassgulp_1_1plugin_1_1_plugin_base_ac39f95b7470b242061ba67ee749c4b44_cgraph" alt=""/></div>
<map name="aclassgulp_1_1plugin_1_1_plugin_base_ac39f95b7470b242061ba67ee749c4b44_cgraph" id="aclassgulp_1_1plugin_1_1_plugin_base_ac39f95b7470b242061ba67ee749c4b44_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,187,33"/>
<area shape="rect" href="classgulp_1_1plugin_1_1_plugin_base.html#adafcb65c64ccf4cd7aa243765c95cc92" title=" " alt="" coords="235,5,297,33"/>
<area shape="poly" title=" " alt="" coords="187,16,219,16,219,22,187,22"/>
</map>
</div>

</div>
</div>
<a id="abf39f32a2e7e60975eac7054393625da" name="abf39f32a2e7e60975eac7054393625da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf39f32a2e7e60975eac7054393625da">&#9670;&#160;</a></span>_process_record()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"> tuple[TmpIngestStats, bool] _process_record </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str</td>          <td class="paramname"><span class="paramname"><em>index</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">any</td>          <td class="paramname"><span class="paramname"><em>record</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>record_idx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Callable</td>          <td class="paramname"><span class="paramname"><em>my_record_to_gulp_document_fun</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str</td>          <td class="paramname"><span class="paramname"><em>ws_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str</td>          <td class="paramname"><span class="paramname"><em>req_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>operation_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>client_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str</td>          <td class="paramname"><span class="paramname"><em>context</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str</td>          <td class="paramname"><span class="paramname"><em>source</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TmpIngestStats</td>          <td class="paramname"><span class="paramname"><em>fs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GulpMapping </td>          <td class="paramname"><span class="paramname"><em>custom_mapping</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dict </td>          <td class="paramname"><span class="paramname"><em>index_type_mapping</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str </td>          <td class="paramname"><span class="paramname"><em>plugin</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classgulp_1_1plugin__internal_1_1_gulp_plugin_params.html">GulpPluginParams</a> </td>          <td class="paramname"><span class="paramname"><em>plugin_params</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GulpIngestionFilter </td>          <td class="paramname"><span class="paramname"><em>flt</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">**</td>          <td class="paramname"><span class="paramname"><em>kwargs</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Process a record for ingestion, updating ingestion stats.
Args:
    index (str): The index to ingest the record into.
    record (any): The record to process.
    record_idx (int): The index of the record as in the source.
    my_record_to_gulp_document_fun (Callable): The function (for this plugin) to convert the record to one or more GulpDocument/s.
    ws_id (str): The websocket ID
    req_id (str): The request ID.
    operation_id (int): The operation ID.
    client_id (int): The client ID.
    context (str): The context of the record.
    source (str): The source of the record.
    fs (TmpIngestStats): The temporary ingestion statistics.
    custom_mapping (GulpMapping, optional): The custom mapping for the record. Defaults to None.
    index_type_mapping (dict, optional): The elastic index type mapping. Defaults to None.
    plugin (str, optional): The plugin name. Defaults to None.
    plugin_params (GulpPluginParams, optional): The plugin parameters. Defaults to None.
    flt (GulpIngestionFilter, optional): The ingestion filter. Defaults to None.
    **kwargs: Additional keyword arguments.
Returns:
    tuple[TmpIngestStats, bool]: A tuple containing the updated temporary ingestion statistics and a flag indicating whether to break the ingestion process.
</pre> 
<p class="definition">Definition at line <a class="el" href="plugin_8py_source.html#l00240">240</a> of file <a class="el" href="plugin_8py_source.html">plugin.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  259</span>    ) -&gt; tuple[TmpIngestStats, bool]:</div>
<div class="line"><span class="lineno">  260</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  261</span><span class="stringliteral">        Process a record for ingestion, updating ingestion stats.</span></div>
<div class="line"><span class="lineno">  262</span><span class="stringliteral">        Args:</span></div>
<div class="line"><span class="lineno">  263</span><span class="stringliteral">            index (str): The index to ingest the record into.</span></div>
<div class="line"><span class="lineno">  264</span><span class="stringliteral">            record (any): The record to process.</span></div>
<div class="line"><span class="lineno">  265</span><span class="stringliteral">            record_idx (int): The index of the record as in the source.</span></div>
<div class="line"><span class="lineno">  266</span><span class="stringliteral">            my_record_to_gulp_document_fun (Callable): The function (for this plugin) to convert the record to one or more GulpDocument/s.</span></div>
<div class="line"><span class="lineno">  267</span><span class="stringliteral">            ws_id (str): The websocket ID</span></div>
<div class="line"><span class="lineno">  268</span><span class="stringliteral">            req_id (str): The request ID.</span></div>
<div class="line"><span class="lineno">  269</span><span class="stringliteral">            operation_id (int): The operation ID.</span></div>
<div class="line"><span class="lineno">  270</span><span class="stringliteral">            client_id (int): The client ID.</span></div>
<div class="line"><span class="lineno">  271</span><span class="stringliteral">            context (str): The context of the record.</span></div>
<div class="line"><span class="lineno">  272</span><span class="stringliteral">            source (str): The source of the record.</span></div>
<div class="line"><span class="lineno">  273</span><span class="stringliteral">            fs (TmpIngestStats): The temporary ingestion statistics.</span></div>
<div class="line"><span class="lineno">  274</span><span class="stringliteral">            custom_mapping (GulpMapping, optional): The custom mapping for the record. Defaults to None.</span></div>
<div class="line"><span class="lineno">  275</span><span class="stringliteral">            index_type_mapping (dict, optional): The elastic index type mapping. Defaults to None.</span></div>
<div class="line"><span class="lineno">  276</span><span class="stringliteral">            plugin (str, optional): The plugin name. Defaults to None.</span></div>
<div class="line"><span class="lineno">  277</span><span class="stringliteral">            plugin_params (GulpPluginParams, optional): The plugin parameters. Defaults to None.</span></div>
<div class="line"><span class="lineno">  278</span><span class="stringliteral">            flt (GulpIngestionFilter, optional): The ingestion filter. Defaults to None.</span></div>
<div class="line"><span class="lineno">  279</span><span class="stringliteral">            **kwargs: Additional keyword arguments.</span></div>
<div class="line"><span class="lineno">  280</span><span class="stringliteral">        Returns:</span></div>
<div class="line"><span class="lineno">  281</span><span class="stringliteral">            tuple[TmpIngestStats, bool]: A tuple containing the updated temporary ingestion statistics and a flag indicating whether to break the ingestion process.</span></div>
<div class="line"><span class="lineno">  282</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  283</span> </div>
<div class="line"><span class="lineno">  284</span>        <span class="comment"># convert record to one or more GulpDocument objects</span></div>
<div class="line"><span class="lineno">  285</span>        docs = await self._call_record_to_gulp_document_funcs(</div>
<div class="line"><span class="lineno">  286</span>            operation_id=operation_id,</div>
<div class="line"><span class="lineno">  287</span>            client_id=client_id,</div>
<div class="line"><span class="lineno">  288</span>            context=context,</div>
<div class="line"><span class="lineno">  289</span>            source=source,</div>
<div class="line"><span class="lineno">  290</span>            fs=fs,</div>
<div class="line"><span class="lineno">  291</span>            record=record,</div>
<div class="line"><span class="lineno">  292</span>            record_idx=record_idx,</div>
<div class="line"><span class="lineno">  293</span>            custom_mapping=custom_mapping,</div>
<div class="line"><span class="lineno">  294</span>            index_type_mapping=index_type_mapping,</div>
<div class="line"><span class="lineno">  295</span>            plugin=plugin,</div>
<div class="line"><span class="lineno">  296</span>            plugin_params=plugin_params,</div>
<div class="line"><span class="lineno">  297</span>            record_to_gulp_document_fun=my_record_to_gulp_document_fun,</div>
<div class="line"><span class="lineno">  298</span>            **kwargs,</div>
<div class="line"><span class="lineno">  299</span>        )</div>
<div class="line"><span class="lineno">  300</span>        <span class="comment"># ingest record</span></div>
<div class="line"><span class="lineno">  301</span>        <span class="keywordflow">for</span> d <span class="keywordflow">in</span> docs:</div>
<div class="line"><span class="lineno">  302</span>            fs = await self._ingest_record(index, d, fs, ws_id, req_id, flt, **kwargs)</div>
<div class="line"><span class="lineno">  303</span> </div>
<div class="line"><span class="lineno">  304</span>        status, _ = await GulpStats.update(</div>
<div class="line"><span class="lineno">  305</span>            self.collab,</div>
<div class="line"><span class="lineno">  306</span>            req_id,</div>
<div class="line"><span class="lineno">  307</span>            ws_id,</div>
<div class="line"><span class="lineno">  308</span>            fs=fs.update(processed=len(docs)),</div>
<div class="line"><span class="lineno">  309</span>        )</div>
<div class="line"><span class="lineno">  310</span>        must_break = <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  311</span>        <span class="keywordflow">if</span> status <span class="keywordflow">in</span> [GulpRequestStatus.FAILED, GulpRequestStatus.CANCELED]:</div>
<div class="line"><span class="lineno">  312</span>            must_break = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  313</span> </div>
<div class="line"><span class="lineno">  314</span>        <span class="keywordflow">return</span> fs, must_break</div>
<div class="line"><span class="lineno">  315</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classgulp_1_1plugin_1_1_plugin_base_abf39f32a2e7e60975eac7054393625da_cgraph.png" border="0" usemap="#aclassgulp_1_1plugin_1_1_plugin_base_abf39f32a2e7e60975eac7054393625da_cgraph" alt=""/></div>
<map name="aclassgulp_1_1plugin_1_1_plugin_base_abf39f32a2e7e60975eac7054393625da_cgraph" id="aclassgulp_1_1plugin_1_1_plugin_base_abf39f32a2e7e60975eac7054393625da_cgraph">
<area shape="rect" title=" " alt="" coords="5,44,132,72"/>
<area shape="rect" href="classgulp_1_1plugin_1_1_plugin_base.html#a381f36429810987d7e1a4603c3f4dfea" title=" " alt="" coords="180,5,334,50"/>
<area shape="poly" title=" " alt="" coords="132,45,164,40,165,45,133,51"/>
<area shape="rect" href="classgulp_1_1plugin_1_1_plugin_base.html#ad9cf9630b6d3e7ae9eab1b880e786222" title=" " alt="" coords="199,74,315,102"/>
<area shape="poly" title=" " alt="" coords="133,66,183,74,183,79,132,71"/>
<area shape="rect" href="classgulp_1_1plugin_1_1_plugin_base.html#a400aabb1893cbe98511a69414c8e58a2" title=" " alt="" coords="382,74,488,102"/>
<area shape="poly" title=" " alt="" coords="315,85,367,85,367,90,315,90"/>
<area shape="rect" href="classgulp_1_1plugin_1_1_plugin_base.html#a17fb4d6dbb155ae0f0646e3d9814fc01" title=" " alt="" coords="555,5,728,50"/>
<area shape="poly" title=" " alt="" coords="485,71,547,52,549,57,486,76"/>
<area shape="rect" href="classgulp_1_1plugin_1_1_plugin_base.html#a3cc5beb95fb74f4be44c04f84ed66a82" title=" " alt="" coords="612,74,671,102"/>
<area shape="poly" title=" " alt="" coords="489,85,596,85,596,90,489,90"/>
<area shape="rect" href="classgulp_1_1plugins_1_1csv_1_1_plugin.html#a3cc5beb95fb74f4be44c04f84ed66a82" title=" " alt="" coords="536,126,747,154"/>
<area shape="poly" title=" " alt="" coords="490,98,570,119,568,124,488,104"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classgulp_1_1plugin_1_1_plugin_base_abf39f32a2e7e60975eac7054393625da_icgraph.png" border="0" usemap="#aclassgulp_1_1plugin_1_1_plugin_base_abf39f32a2e7e60975eac7054393625da_icgraph" alt=""/></div>
<map name="aclassgulp_1_1plugin_1_1_plugin_base_abf39f32a2e7e60975eac7054393625da_icgraph" id="aclassgulp_1_1plugin_1_1_plugin_base_abf39f32a2e7e60975eac7054393625da_icgraph">
<area shape="rect" title=" " alt="" coords="305,29,431,57"/>
<area shape="rect" href="classgulp_1_1plugins_1_1win__evtx_1_1_plugin.html#ab96082a9ecc6d0db5a48ee6958ac3239" title=" " alt="" coords="5,29,257,57"/>
<area shape="poly" title=" " alt="" coords="289,46,257,46,257,40,289,40"/>
<area shape="poly" title=" " alt="" coords="172,16,157,10,131,8,106,10,93,15,89,20,95,27,91,30,84,20,89,11,105,5,131,3,159,5,174,12"/>
</map>
</div>

</div>
</div>
<a id="a1993e16b2333cb1bb281eaa81828c326" name="a1993e16b2333cb1bb281eaa81828c326"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1993e16b2333cb1bb281eaa81828c326">&#9670;&#160;</a></span>_record_failed()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"> TmpIngestStats _record_failed </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TmpIngestStats</td>          <td class="paramname"><span class="paramname"><em>fs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">any</td>          <td class="paramname"><span class="paramname"><em>entry</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str | dict</td>          <td class="paramname"><span class="paramname"><em>source</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Exception | str
    </td>          <td class="paramname"><span class="paramname"><em>ex</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">record failed ingestion (in the record parser loop), helper to update stats

Args:
    fs (TmpIngestStats): The temporary ingestion statistics.
    entry (any): The entry that failed.
    source (str): The source of the record.
    ex (Exception|str): The exception that caused the failure.
Returns:
    TmpIngestStats: The updated temporary ingestion statistics.
</pre> 
<p class="definition">Definition at line <a class="el" href="plugin_8py_source.html#l00945">945</a> of file <a class="el" href="plugin_8py_source.html">plugin.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  947</span>    ) -&gt; TmpIngestStats:</div>
<div class="line"><span class="lineno">  948</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  949</span><span class="stringliteral">        record failed ingestion (in the record parser loop), helper to update stats</span></div>
<div class="line"><span class="lineno">  950</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  951</span><span class="stringliteral">        Args:</span></div>
<div class="line"><span class="lineno">  952</span><span class="stringliteral">            fs (TmpIngestStats): The temporary ingestion statistics.</span></div>
<div class="line"><span class="lineno">  953</span><span class="stringliteral">            entry (any): The entry that failed.</span></div>
<div class="line"><span class="lineno">  954</span><span class="stringliteral">            source (str): The source of the record.</span></div>
<div class="line"><span class="lineno">  955</span><span class="stringliteral">            ex (Exception|str): The exception that caused the failure.</span></div>
<div class="line"><span class="lineno">  956</span><span class="stringliteral">        Returns:</span></div>
<div class="line"><span class="lineno">  957</span><span class="stringliteral">            TmpIngestStats: The updated temporary ingestion statistics.</span></div>
<div class="line"><span class="lineno">  958</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  959</span>        <span class="comment"># self.logger().exception(&quot;RECORD FAILED: source=%s, record=%s, ex=%s&quot; % (muty.string.make_shorter(str(source),260), muty.string.make_shorter(str(entry),260), ex))</span></div>
<div class="line"><span class="lineno">  960</span>        fs = fs.update(failed=1, ingest_errors=[ex])</div>
<div class="line"><span class="lineno">  961</span>        <span class="keywordflow">return</span> fs</div>
<div class="line"><span class="lineno">  962</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classgulp_1_1plugin_1_1_plugin_base_a1993e16b2333cb1bb281eaa81828c326_icgraph.png" border="0" usemap="#aclassgulp_1_1plugin_1_1_plugin_base_a1993e16b2333cb1bb281eaa81828c326_icgraph" alt=""/></div>
<map name="aclassgulp_1_1plugin_1_1_plugin_base_a1993e16b2333cb1bb281eaa81828c326_icgraph" id="aclassgulp_1_1plugin_1_1_plugin_base_a1993e16b2333cb1bb281eaa81828c326_icgraph">
<area shape="rect" title=" " alt="" coords="305,29,418,57"/>
<area shape="rect" href="classgulp_1_1plugins_1_1win__evtx_1_1_plugin.html#ab96082a9ecc6d0db5a48ee6958ac3239" title=" " alt="" coords="5,29,257,57"/>
<area shape="poly" title=" " alt="" coords="289,46,257,46,257,40,289,40"/>
<area shape="poly" title=" " alt="" coords="170,16,157,10,131,8,107,10,94,15,91,20,96,27,92,30,85,20,90,11,106,5,131,3,158,5,173,12"/>
</map>
</div>

</div>
</div>
<a id="acfc929fce907dcf945a52ffb8dc5b2ed" name="acfc929fce907dcf945a52ffb8dc5b2ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acfc929fce907dcf945a52ffb8dc5b2ed">&#9670;&#160;</a></span>_type_checks()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"> any _type_checks </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">any</td>          <td class="paramname"><span class="paramname"><em>v</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str</td>          <td class="paramname"><span class="paramname"><em>k</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dict</td>          <td class="paramname"><span class="paramname"><em>index_type_mapping</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">check if the value should be fixed based on the index type mapping

Args:
    v (any): The value to check.
    k (str): The mapped field (i.e. "user.id", may also be an unmapped (i.e. "gulp.unmapped") field)
    index_type_mapping (dict): The elasticsearch index key-&gt;type mappings.
</pre> 
<p class="definition">Definition at line <a class="el" href="plugin_8py_source.html#l00638">638</a> of file <a class="el" href="plugin_8py_source.html">plugin.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  638</span>    <span class="keyword">def </span>_type_checks(self, v: any, k: str, index_type_mapping: dict) -&gt; any:</div>
<div class="line"><span class="lineno">  639</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  640</span><span class="stringliteral">        check if the value should be fixed based on the index type mapping</span></div>
<div class="line"><span class="lineno">  641</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  642</span><span class="stringliteral">        Args:</span></div>
<div class="line"><span class="lineno">  643</span><span class="stringliteral">            v (any): The value to check.</span></div>
<div class="line"><span class="lineno">  644</span><span class="stringliteral">            k (str): The mapped field (i.e. &quot;user.id&quot;, may also be an unmapped (i.e. &quot;gulp.unmapped&quot;) field)</span></div>
<div class="line"><span class="lineno">  645</span><span class="stringliteral">            index_type_mapping (dict): The elasticsearch index key-&gt;type mappings.</span></div>
<div class="line"><span class="lineno">  646</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  647</span>        <span class="keywordflow">if</span> k <span class="keywordflow">not</span> <span class="keywordflow">in</span> index_type_mapping:</div>
<div class="line"><span class="lineno">  648</span>            <span class="comment"># _logger.debug(&quot;key %s not found in index_type_mapping&quot; % (k))</span></div>
<div class="line"><span class="lineno">  649</span>            <span class="keywordflow">return</span> str(v)</div>
<div class="line"><span class="lineno">  650</span> </div>
<div class="line"><span class="lineno">  651</span>        index_type = index_type_mapping[k]</div>
<div class="line"><span class="lineno">  652</span>        <span class="keywordflow">if</span> index_type == <span class="stringliteral">&quot;long&quot;</span>:</div>
<div class="line"><span class="lineno">  653</span>            <span class="comment"># self.logger().debug(&quot;converting %s:%s to long&quot; % (k, v))</span></div>
<div class="line"><span class="lineno">  654</span>            <span class="keywordflow">if</span> isinstance(v, str):</div>
<div class="line"><span class="lineno">  655</span>                <span class="keywordflow">if</span> v.isnumeric():</div>
<div class="line"><span class="lineno">  656</span>                    <span class="keywordflow">return</span> int(v)</div>
<div class="line"><span class="lineno">  657</span>                <span class="keywordflow">if</span> v.startswith(<span class="stringliteral">&quot;0x&quot;</span>):</div>
<div class="line"><span class="lineno">  658</span>                    <span class="keywordflow">return</span> int(v, 16)</div>
<div class="line"><span class="lineno">  659</span>            <span class="keywordflow">return</span> v</div>
<div class="line"><span class="lineno">  660</span> </div>
<div class="line"><span class="lineno">  661</span>        <span class="keywordflow">if</span> index_type == <span class="stringliteral">&quot;date&quot;</span> <span class="keywordflow">and</span> isinstance(v, str) <span class="keywordflow">and</span> v.lower().startswith(<span class="stringliteral">&quot;0x&quot;</span>):</div>
<div class="line"><span class="lineno">  662</span>            <span class="comment"># convert hex to int</span></div>
<div class="line"><span class="lineno">  663</span>            <span class="keywordflow">return</span> int(v, 16)</div>
<div class="line"><span class="lineno">  664</span> </div>
<div class="line"><span class="lineno">  665</span>        <span class="keywordflow">if</span> index_type == <span class="stringliteral">&quot;keyword&quot;</span> <span class="keywordflow">or</span> index_type == <span class="stringliteral">&quot;text&quot;</span>:</div>
<div class="line"><span class="lineno">  666</span>            <span class="comment"># self.logger().debug(&quot;converting %s:%s to keyword&quot; % (k, v))</span></div>
<div class="line"><span class="lineno">  667</span>            <span class="keywordflow">return</span> str(v)</div>
<div class="line"><span class="lineno">  668</span> </div>
<div class="line"><span class="lineno">  669</span>        <span class="keywordflow">if</span> index_type == <span class="stringliteral">&quot;ip&quot;</span>:</div>
<div class="line"><span class="lineno">  670</span>            <span class="comment"># self.logger().debug(&quot;converting %s:%s to ip&quot; % (k, v))</span></div>
<div class="line"><span class="lineno">  671</span>            <span class="keywordflow">if</span> <span class="stringliteral">&quot;local&quot;</span> <span class="keywordflow">in</span> v.lower():</div>
<div class="line"><span class="lineno">  672</span>                <span class="keywordflow">return</span> <span class="stringliteral">&quot;127.0.0.1&quot;</span></div>
<div class="line"><span class="lineno">  673</span>            <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  674</span>                ipaddress.ip_address(v)</div>
<div class="line"><span class="lineno">  675</span>            <span class="keywordflow">except</span> ValueError <span class="keyword">as</span> ex:</div>
<div class="line"><span class="lineno">  676</span>                _logger.exception(ex)</div>
<div class="line"><span class="lineno">  677</span>                <span class="keywordflow">return</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  678</span> </div>
<div class="line"><span class="lineno">  679</span>        <span class="comment"># add more types here if needed ...</span></div>
<div class="line"><span class="lineno">  680</span>        <span class="comment"># self.logger().debug(&quot;returning %s:%s&quot; % (k, v))</span></div>
<div class="line"><span class="lineno">  681</span>        <span class="keywordflow">return</span> str(v)</div>
<div class="line"><span class="lineno">  682</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classgulp_1_1plugin_1_1_plugin_base_acfc929fce907dcf945a52ffb8dc5b2ed_icgraph.png" border="0" usemap="#aclassgulp_1_1plugin_1_1_plugin_base_acfc929fce907dcf945a52ffb8dc5b2ed_icgraph" alt=""/></div>
<map name="aclassgulp_1_1plugin_1_1_plugin_base_acfc929fce907dcf945a52ffb8dc5b2ed_icgraph" id="aclassgulp_1_1plugin_1_1_plugin_base_acfc929fce907dcf945a52ffb8dc5b2ed_icgraph">
<area shape="rect" title=" " alt="" coords="790,29,900,57"/>
<area shape="rect" href="classgulp_1_1plugin_1_1_plugin_base.html#a4b661e5352802554dc25028526496f7b" title=" " alt="" coords="605,29,742,57"/>
<area shape="poly" title=" " alt="" coords="775,46,743,46,743,40,775,40"/>
<area shape="rect" href="classgulp_1_1plugins_1_1win__evtx_1_1_plugin.html#a38a3b56e6818d69a12aa847ac980895e" title=" " alt="" coords="305,21,557,66"/>
<area shape="poly" title=" " alt="" coords="590,46,557,46,557,40,590,40"/>
<area shape="rect" href="classgulp_1_1plugins_1_1win__evtx_1_1_plugin.html#ab96082a9ecc6d0db5a48ee6958ac3239" title=" " alt="" coords="5,29,257,57"/>
<area shape="poly" title=" " alt="" coords="289,46,257,46,257,40,289,40"/>
<area shape="poly" title=" " alt="" coords="183,17,166,10,131,8,99,10,82,15,77,20,85,27,81,31,72,20,79,11,99,5,131,3,167,5,185,12"/>
</map>
</div>

</div>
</div>
<a id="a840f5d608e3e60e19ad6aca18e0b5abf" name="a840f5d608e3e60e19ad6aca18e0b5abf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a840f5d608e3e60e19ad6aca18e0b5abf">&#9670;&#160;</a></span>cleanup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> None cleanup </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Optional cleanup routine to call on unload.
</pre> 
<p class="definition">Definition at line <a class="el" href="plugin_8py_source.html#l00549">549</a> of file <a class="el" href="plugin_8py_source.html">plugin.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  549</span>    <span class="keyword">def </span>cleanup(self) -&gt; None:</div>
<div class="line"><span class="lineno">  550</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  551</span><span class="stringliteral">        Optional cleanup routine to call on unload.</span></div>
<div class="line"><span class="lineno">  552</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  553</span>        <span class="keywordflow">return</span></div>
<div class="line"><span class="lineno">  554</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a01add25e2c2397d9ed56eca11d4105c0" name="a01add25e2c2397d9ed56eca11d4105c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01add25e2c2397d9ed56eca11d4105c0">&#9670;&#160;</a></span>depends_on()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> list[str] depends_on </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Returns a list of plugins this plugin depends on.
</pre> 
<p class="definition">Definition at line <a class="el" href="plugin_8py_source.html#l00135">135</a> of file <a class="el" href="plugin_8py_source.html">plugin.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  135</span>    <span class="keyword">def </span>depends_on(self) -&gt; list[str]:</div>
<div class="line"><span class="lineno">  136</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  137</span><span class="stringliteral">        Returns a list of plugins this plugin depends on.</span></div>
<div class="line"><span class="lineno">  138</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  139</span>        <span class="keywordflow">return</span> []</div>
<div class="line"><span class="lineno">  140</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad23a45a663b1933199b70ae3631e451b" name="ad23a45a663b1933199b70ae3631e451b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad23a45a663b1933199b70ae3631e451b">&#9670;&#160;</a></span>desc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> str desc </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Returns a description of the plugin.
</pre> 
<p>Reimplemented in <a class="el" href="classgulp_1_1plugins_1_1csv_1_1_plugin.html#ad23a45a663b1933199b70ae3631e451b">Plugin</a>, <a class="el" href="classgulp_1_1plugins_1_1sigma_1_1windows_1_1_plugin.html#ad23a45a663b1933199b70ae3631e451b">Plugin</a>, and <a class="el" href="classgulp_1_1plugins_1_1win__evtx_1_1_plugin.html#ad23a45a663b1933199b70ae3631e451b">Plugin</a>.</p>

<p class="definition">Definition at line <a class="el" href="plugin_8py_source.html#l00118">118</a> of file <a class="el" href="plugin_8py_source.html">plugin.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  118</span>    <span class="keyword">def </span>desc(self) -&gt; str:</div>
<div class="line"><span class="lineno">  119</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  120</span><span class="stringliteral">        Returns a description of the plugin.</span></div>
<div class="line"><span class="lineno">  121</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  122</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classgulp_1_1plugin_1_1_plugin_base_ad23a45a663b1933199b70ae3631e451b_icgraph.png" border="0" usemap="#aclassgulp_1_1plugin_1_1_plugin_base_ad23a45a663b1933199b70ae3631e451b_icgraph" alt=""/></div>
<map name="aclassgulp_1_1plugin_1_1_plugin_base_ad23a45a663b1933199b70ae3631e451b_icgraph" id="aclassgulp_1_1plugin_1_1_plugin_base_ad23a45a663b1933199b70ae3631e451b_icgraph">
<area shape="rect" title=" " alt="" coords="238,14,289,42"/>
<area shape="rect" href="classgulp_1_1plugin__internal_1_1_gulp_plugin_option.html#a3afb8c54f9c26db579bb05cc3cf72bb3" title=" " alt="" coords="5,5,190,50"/>
<area shape="poly" title=" " alt="" coords="222,30,190,30,190,25,222,25"/>
</map>
</div>

</div>
</div>
<a id="ad79ad6ef42363d02816e4b70b1c56fb5" name="ad79ad6ef42363d02816e4b70b1c56fb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad79ad6ef42363d02816e4b70b1c56fb5">&#9670;&#160;</a></span>event_type_field()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> str event_type_field </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Returns the field name for the event type.
</pre> 
<p class="definition">Definition at line <a class="el" href="plugin_8py_source.html#l00129">129</a> of file <a class="el" href="plugin_8py_source.html">plugin.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  129</span>    <span class="keyword">def </span>event_type_field(self) -&gt; str:</div>
<div class="line"><span class="lineno">  130</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  131</span><span class="stringliteral">        Returns the field name for the event type.</span></div>
<div class="line"><span class="lineno">  132</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  133</span>        <span class="keywordflow">return</span> <span class="stringliteral">&quot;event.code&quot;</span></div>
<div class="line"><span class="lineno">  134</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac5c86b4ede215ac0ba20d028ad717c3e" name="ac5c86b4ede215ac0ba20d028ad717c3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5c86b4ede215ac0ba20d028ad717c3e">&#9670;&#160;</a></span>get_unmapped_field_name()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> str get_unmapped_field_name </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str</td>          <td class="paramname"><span class="paramname"><em>field</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Returns the name of the unmapped field.

Parameters:
- field (str): The name of the field.

Returns:
- str: The name of the unmapped field.
</pre> 
<p class="definition">Definition at line <a class="el" href="plugin_8py_source.html#l00623">623</a> of file <a class="el" href="plugin_8py_source.html">plugin.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  623</span>    <span class="keyword">def </span>get_unmapped_field_name(self, field: str) -&gt; str:</div>
<div class="line"><span class="lineno">  624</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  625</span><span class="stringliteral">        Returns the name of the unmapped field.</span></div>
<div class="line"><span class="lineno">  626</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  627</span><span class="stringliteral">        Parameters:</span></div>
<div class="line"><span class="lineno">  628</span><span class="stringliteral">        - field (str): The name of the field.</span></div>
<div class="line"><span class="lineno">  629</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  630</span><span class="stringliteral">        Returns:</span></div>
<div class="line"><span class="lineno">  631</span><span class="stringliteral">        - str: The name of the unmapped field.</span></div>
<div class="line"><span class="lineno">  632</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  633</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> elastic_api.UNMAPPED_PREFIX:</div>
<div class="line"><span class="lineno">  634</span>            <span class="keywordflow">return</span> field</div>
<div class="line"><span class="lineno">  635</span> </div>
<div class="line"><span class="lineno">  636</span>        <span class="keywordflow">return</span> f<span class="stringliteral">&quot;{elastic_api.UNMAPPED_PREFIX}.{field}&quot;</span></div>
<div class="line"><span class="lineno">  637</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classgulp_1_1plugin_1_1_plugin_base_ac5c86b4ede215ac0ba20d028ad717c3e_icgraph.png" border="0" usemap="#aclassgulp_1_1plugin_1_1_plugin_base_ac5c86b4ede215ac0ba20d028ad717c3e_icgraph" alt=""/></div>
<map name="aclassgulp_1_1plugin_1_1_plugin_base_ac5c86b4ede215ac0ba20d028ad717c3e_icgraph" id="aclassgulp_1_1plugin_1_1_plugin_base_ac5c86b4ede215ac0ba20d028ad717c3e_icgraph">
<area shape="rect" title=" " alt="" coords="790,29,989,57"/>
<area shape="rect" href="classgulp_1_1plugin_1_1_plugin_base.html#a4b661e5352802554dc25028526496f7b" title=" " alt="" coords="605,29,742,57"/>
<area shape="poly" title=" " alt="" coords="774,46,743,46,743,40,774,40"/>
<area shape="rect" href="classgulp_1_1plugins_1_1win__evtx_1_1_plugin.html#a38a3b56e6818d69a12aa847ac980895e" title=" " alt="" coords="305,21,557,66"/>
<area shape="poly" title=" " alt="" coords="590,46,557,46,557,40,590,40"/>
<area shape="rect" href="classgulp_1_1plugins_1_1win__evtx_1_1_plugin.html#ab96082a9ecc6d0db5a48ee6958ac3239" title=" " alt="" coords="5,29,257,57"/>
<area shape="poly" title=" " alt="" coords="289,46,257,46,257,40,289,40"/>
<area shape="poly" title=" " alt="" coords="183,17,166,10,131,8,99,10,82,15,77,20,85,27,81,31,72,20,79,11,99,5,131,3,167,5,185,12"/>
</map>
</div>

</div>
</div>
<a id="ab96082a9ecc6d0db5a48ee6958ac3239" name="ab96082a9ecc6d0db5a48ee6958ac3239"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab96082a9ecc6d0db5a48ee6958ac3239">&#9670;&#160;</a></span>ingest()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> GulpRequestStatus ingest </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str</td>          <td class="paramname"><span class="paramname"><em>index</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str</td>          <td class="paramname"><span class="paramname"><em>req_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>client_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>operation_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str</td>          <td class="paramname"><span class="paramname"><em>context</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str | list[dict]</td>          <td class="paramname"><span class="paramname"><em>source</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str</td>          <td class="paramname"><span class="paramname"><em>ws_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classgulp_1_1plugin__internal_1_1_gulp_plugin_params.html">GulpPluginParams</a> </td>          <td class="paramname"><span class="paramname"><em>plugin_params</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GulpIngestionFilter </td>          <td class="paramname"><span class="paramname"><em>flt</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">**</td>          <td class="paramname"><span class="paramname"><em>kwargs</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Ingests a file using the plugin.

NOTE: implementers should call super().ingest() in their implementation.
NOTE: this function *SHOULD NOT* raise exceptions

Args:
    index (str): name of the elasticsearch index to ingest the document into.
    req_id (str): The request ID related to this ingestion (must exist on the collab db).
    client_id (int): The client ID performing the ingestion.
    operation_id (int): The operation ID related to this ingestion.
    context (str): Context related to this ingestion.
    source (str|list[dict]): The path to the file to ingest, or a list of events dicts.
    ws_id (str): The websocket ID
    plugin_params (GulpPluginParams): additional parameters to pass to the ingestion function. Defaults to None.
    flt (GulpIngestionFilter, optional): filter to apply to this ingestion, if any. Defaults to None.
    kwargs: additional arguments if any
</pre> 
<p>Reimplemented in <a class="el" href="classgulp_1_1plugins_1_1csv_1_1_plugin.html#ab96082a9ecc6d0db5a48ee6958ac3239">Plugin</a>, and <a class="el" href="classgulp_1_1plugins_1_1win__evtx_1_1_plugin.html#ab96082a9ecc6d0db5a48ee6958ac3239">Plugin</a>.</p>

<p class="definition">Definition at line <a class="el" href="plugin_8py_source.html#l00496">496</a> of file <a class="el" href="plugin_8py_source.html">plugin.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  508</span>    ) -&gt; GulpRequestStatus:</div>
<div class="line"><span class="lineno">  509</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  510</span><span class="stringliteral">        Ingests a file using the plugin.</span></div>
<div class="line"><span class="lineno">  511</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  512</span><span class="stringliteral">        NOTE: implementers should call super().ingest() in their implementation.</span></div>
<div class="line"><span class="lineno">  513</span><span class="stringliteral">        NOTE: this function *SHOULD NOT* raise exceptions</span></div>
<div class="line"><span class="lineno">  514</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  515</span><span class="stringliteral">        Args:</span></div>
<div class="line"><span class="lineno">  516</span><span class="stringliteral">            index (str): name of the elasticsearch index to ingest the document into.</span></div>
<div class="line"><span class="lineno">  517</span><span class="stringliteral">            req_id (str): The request ID related to this ingestion (must exist on the collab db).</span></div>
<div class="line"><span class="lineno">  518</span><span class="stringliteral">            client_id (int): The client ID performing the ingestion.</span></div>
<div class="line"><span class="lineno">  519</span><span class="stringliteral">            operation_id (int): The operation ID related to this ingestion.</span></div>
<div class="line"><span class="lineno">  520</span><span class="stringliteral">            context (str): Context related to this ingestion.</span></div>
<div class="line"><span class="lineno">  521</span><span class="stringliteral">            source (str|list[dict]): The path to the file to ingest, or a list of events dicts.</span></div>
<div class="line"><span class="lineno">  522</span><span class="stringliteral">            ws_id (str): The websocket ID</span></div>
<div class="line"><span class="lineno">  523</span><span class="stringliteral">            plugin_params (GulpPluginParams): additional parameters to pass to the ingestion function. Defaults to None.</span></div>
<div class="line"><span class="lineno">  524</span><span class="stringliteral">            flt (GulpIngestionFilter, optional): filter to apply to this ingestion, if any. Defaults to None.</span></div>
<div class="line"><span class="lineno">  525</span><span class="stringliteral">            kwargs: additional arguments if any</span></div>
<div class="line"><span class="lineno">  526</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  527</span>        self.req_id = req_id</div>
<div class="line"><span class="lineno">  528</span>        self.client_id = client_id</div>
<div class="line"><span class="lineno">  529</span>        self.operation_id = operation_id</div>
<div class="line"><span class="lineno">  530</span>        self.context = context</div>
<div class="line"><span class="lineno">  531</span>        self.ws_id = ws_id</div>
<div class="line"><span class="lineno">  532</span>        self.index = index</div>
<div class="line"><span class="lineno">  533</span>        <span class="comment"># raise NotImplementedError(&quot;not implemented!&quot;)</span></div>
<div class="line"><span class="lineno">  534</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a66de2da998fe4b3958a3a6ce1189fbe8" name="a66de2da998fe4b3958a3a6ce1189fbe8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66de2da998fe4b3958a3a6ce1189fbe8">&#9670;&#160;</a></span>ingest_plugin_initialize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> tuple[dict, GulpMapping] ingest_plugin_initialize </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str</td>          <td class="paramname"><span class="paramname"><em>index</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str | dict</td>          <td class="paramname"><span class="paramname"><em>source</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool </td>          <td class="paramname"><span class="paramname"><em>skip_mapping</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ProcessingPipeline </td>          <td class="paramname"><span class="paramname"><em>pipeline</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str </td>          <td class="paramname"><span class="paramname"><em>mapping_file</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str </td>          <td class="paramname"><span class="paramname"><em>mapping_id</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classgulp_1_1plugin__internal_1_1_gulp_plugin_params.html">GulpPluginParams</a> </td>          <td class="paramname"><span class="paramname"><em>plugin_params</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Initializes the ingestion plugin.

Args:
    index (str): The name of the elasticsearch index.
    source (str|dict): The source of the record (source file name or path, usually. may also be a dictionary.).
    skip_mapping (bool, optional): Whether to skip mapping initialization (just prints source and plugin name, and return empty index mapping and custom mapping). Defaults to False.
    pipeline (ProcessingPipeline, optional): The psyigma pipeline to borrow the mapping from, if any. Defaults to None (use mapping file only).
    mapping_file (str, optional): name of the mapping file (i.e. 'windows.json') in the gulp/mapping_files directory. Defaults to None (use pipeline mapping only).
    mapping_id (str, optional): The mapping ID (options.mapping_id) in the mapping file, to get a specific mapping. Defaults to None (use first).
    plugin_params (GulpPluginParams, optional): The plugin parameters (i.e. to override mapping_file, mapping_id, ...). Defaults to None.
Returns:
    tuple[dict, GulpMapping]: A tuple containing the elasticsearch index type mappings and the enriched GulpMapping (or an empty GulpMapping is no valid pipeline and/or mapping_file are provided).</pre> 
<p class="definition">Definition at line <a class="el" href="plugin_8py_source.html#l00316">316</a> of file <a class="el" href="plugin_8py_source.html">plugin.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  325</span>    ) -&gt; tuple[dict, GulpMapping]:</div>
<div class="line"><span class="lineno">  326</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  327</span><span class="stringliteral">        Initializes the ingestion plugin.</span></div>
<div class="line"><span class="lineno">  328</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  329</span><span class="stringliteral">        Args:</span></div>
<div class="line"><span class="lineno">  330</span><span class="stringliteral">            index (str): The name of the elasticsearch index.</span></div>
<div class="line"><span class="lineno">  331</span><span class="stringliteral">            source (str|dict): The source of the record (source file name or path, usually. may also be a dictionary.).</span></div>
<div class="line"><span class="lineno">  332</span><span class="stringliteral">            skip_mapping (bool, optional): Whether to skip mapping initialization (just prints source and plugin name, and return empty index mapping and custom mapping). Defaults to False.</span></div>
<div class="line"><span class="lineno">  333</span><span class="stringliteral">            pipeline (ProcessingPipeline, optional): The psyigma pipeline to borrow the mapping from, if any. Defaults to None (use mapping file only).</span></div>
<div class="line"><span class="lineno">  334</span><span class="stringliteral">            mapping_file (str, optional): name of the mapping file (i.e. &#39;windows.json&#39;) in the gulp/mapping_files directory. Defaults to None (use pipeline mapping only).</span></div>
<div class="line"><span class="lineno">  335</span><span class="stringliteral">            mapping_id (str, optional): The mapping ID (options.mapping_id) in the mapping file, to get a specific mapping. Defaults to None (use first).</span></div>
<div class="line"><span class="lineno">  336</span><span class="stringliteral">            plugin_params (GulpPluginParams, optional): The plugin parameters (i.e. to override mapping_file, mapping_id, ...). Defaults to None.</span></div>
<div class="line"><span class="lineno">  337</span><span class="stringliteral">        Returns:</span></div>
<div class="line"><span class="lineno">  338</span><span class="stringliteral">            tuple[dict, GulpMapping]: A tuple containing the elasticsearch index type mappings and the enriched GulpMapping (or an empty GulpMapping is no valid pipeline and/or mapping_file are provided).</span></div>
<div class="line"><span class="lineno">  339</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  340</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  341</span>        <span class="comment"># self.logger().debug(&quot;ingest_plugin_initialize: index=%s, pipeline=%s, mapping_file=%s, mapping_id=%s, plugin_params=%s&quot; % (index, pipeline, mapping_file, mapping_id, plugin_params))</span></div>
<div class="line"><span class="lineno">  342</span>        self.logger().debug(</div>
<div class="line"><span class="lineno">  343</span>            <span class="stringliteral">&quot;INITIALIZING INGESTION for source=%s, plugin=%s&quot;</span></div>
<div class="line"><span class="lineno">  344</span>            % (muty.string.make_shorter(source, 260), self.name())</div>
<div class="line"><span class="lineno">  345</span>        )</div>
<div class="line"><span class="lineno">  346</span>        <span class="keywordflow">if</span> skip_mapping:</div>
<div class="line"><span class="lineno">  347</span>            <span class="keywordflow">return</span> {}, GulpMapping()</div>
<div class="line"><span class="lineno">  348</span> </div>
<div class="line"><span class="lineno">  349</span>        <span class="comment"># get path of the mapping file in gulp/mapping_files folder</span></div>
<div class="line"><span class="lineno">  350</span>        mapping_file_path = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  351</span>        <span class="keywordflow">if</span> mapping_file <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  352</span>            mapping_file_path = gulp_utils.build_mapping_file_path(mapping_file)</div>
<div class="line"><span class="lineno">  353</span> </div>
<div class="line"><span class="lineno">  354</span>        <span class="keywordflow">if</span> plugin_params <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  355</span>            <span class="comment"># override with plugin_params</span></div>
<div class="line"><span class="lineno">  356</span>            <span class="keywordflow">if</span> plugin_params.mapping_file <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  357</span>                mapping_file_path = gulp_utils.build_mapping_file_path(</div>
<div class="line"><span class="lineno">  358</span>                    plugin_params.mapping_file</div>
<div class="line"><span class="lineno">  359</span>                )</div>
<div class="line"><span class="lineno">  360</span>            <span class="keywordflow">if</span> plugin_params.mapping_id <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  361</span>                mapping_id = plugin_params.mapping_id</div>
<div class="line"><span class="lineno">  362</span>            <span class="keywordflow">if</span> plugin_params.pipeline <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  363</span>                pipeline = plugin_params.pipeline</div>
<div class="line"><span class="lineno">  364</span> </div>
<div class="line"><span class="lineno">  365</span>        index_type_mappings = await elastic_api.index_get_mapping(</div>
<div class="line"><span class="lineno">  366</span>            elastic_api.elastic(), index, <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  367</span>        )</div>
<div class="line"><span class="lineno">  368</span>        <span class="comment"># index_type_mappings = await elastic_api.datastream_get_mapping(self.elastic, index + &#39;-template&#39;)</span></div>
<div class="line"><span class="lineno">  369</span>        m: GulpMapping = await mappings_helper.get_enriched_mapping_for_ingestion(</div>
<div class="line"><span class="lineno">  370</span>            pipeline=pipeline,</div>
<div class="line"><span class="lineno">  371</span>            mapping_file_path=mapping_file_path,</div>
<div class="line"><span class="lineno">  372</span>            mapping_id=mapping_id,</div>
<div class="line"><span class="lineno">  373</span>        )</div>
<div class="line"><span class="lineno">  374</span>        <span class="keywordflow">return</span> index_type_mappings, m</div>
<div class="line"><span class="lineno">  375</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classgulp_1_1plugin_1_1_plugin_base_a66de2da998fe4b3958a3a6ce1189fbe8_cgraph.png" border="0" usemap="#aclassgulp_1_1plugin_1_1_plugin_base_a66de2da998fe4b3958a3a6ce1189fbe8_cgraph" alt=""/></div>
<map name="aclassgulp_1_1plugin_1_1_plugin_base_a66de2da998fe4b3958a3a6ce1189fbe8_cgraph" id="aclassgulp_1_1plugin_1_1_plugin_base_a66de2da998fe4b3958a3a6ce1189fbe8_cgraph">
<area shape="rect" title=" " alt="" coords="5,57,177,85"/>
<area shape="rect" href="classgulp_1_1plugin_1_1_plugin_base.html#adafcb65c64ccf4cd7aa243765c95cc92" title=" " alt="" coords="299,5,361,33"/>
<area shape="poly" title=" " alt="" coords="158,54,283,26,284,32,159,59"/>
<area shape="rect" href="classgulp_1_1plugin_1_1_plugin_base.html#a3cc5beb95fb74f4be44c04f84ed66a82" title=" " alt="" coords="301,57,359,85"/>
<area shape="poly" title=" " alt="" coords="177,68,285,68,285,74,177,74"/>
<area shape="rect" href="classgulp_1_1plugins_1_1csv_1_1_plugin.html#a3cc5beb95fb74f4be44c04f84ed66a82" title=" " alt="" coords="225,109,435,137"/>
<area shape="poly" title=" " alt="" coords="159,83,248,103,247,108,158,88"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classgulp_1_1plugin_1_1_plugin_base_a66de2da998fe4b3958a3a6ce1189fbe8_icgraph.png" border="0" usemap="#aclassgulp_1_1plugin_1_1_plugin_base_a66de2da998fe4b3958a3a6ce1189fbe8_icgraph" alt=""/></div>
<map name="aclassgulp_1_1plugin_1_1_plugin_base_a66de2da998fe4b3958a3a6ce1189fbe8_icgraph" id="aclassgulp_1_1plugin_1_1_plugin_base_a66de2da998fe4b3958a3a6ce1189fbe8_icgraph">
<area shape="rect" title=" " alt="" coords="305,29,476,57"/>
<area shape="rect" href="classgulp_1_1plugins_1_1win__evtx_1_1_plugin.html#ab96082a9ecc6d0db5a48ee6958ac3239" title=" " alt="" coords="5,29,257,57"/>
<area shape="poly" title=" " alt="" coords="289,46,257,46,257,40,289,40"/>
<area shape="poly" title=" " alt="" coords="176,17,160,10,131,8,104,10,89,15,85,20,91,27,87,30,80,20,85,11,103,5,131,3,161,5,178,12"/>
</map>
</div>

</div>
</div>
<a id="ac6a9f9fea14049c9afb7094bb617363f" name="ac6a9f9fea14049c9afb7094bb617363f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6a9f9fea14049c9afb7094bb617363f">&#9670;&#160;</a></span>internal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> bool internal </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Returns whether the plugin is for internal use only
</pre> 
<p class="definition">Definition at line <a class="el" href="plugin_8py_source.html#l00147">147</a> of file <a class="el" href="plugin_8py_source.html">plugin.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  147</span>    <span class="keyword">def </span>internal(self) -&gt; bool:</div>
<div class="line"><span class="lineno">  148</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  149</span><span class="stringliteral">        Returns whether the plugin is for internal use only</span></div>
<div class="line"><span class="lineno">  150</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  151</span>        <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  152</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="adafcb65c64ccf4cd7aa243765c95cc92" name="adafcb65c64ccf4cd7aa243765c95cc92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adafcb65c64ccf4cd7aa243765c95cc92">&#9670;&#160;</a></span>logger()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> logging.Logger logger </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>cls</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="plugin_8py_source.html#l00095">95</a> of file <a class="el" href="plugin_8py_source.html">plugin.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   95</span>    <span class="keyword">def </span>logger(cls) -&gt; logging.Logger:</div>
<div class="line"><span class="lineno">   96</span>        <span class="keyword">global</span> _logger</div>
<div class="line"><span class="lineno">   97</span>        <span class="keywordflow">return</span> _logger</div>
<div class="line"><span class="lineno">   98</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classgulp_1_1plugin_1_1_plugin_base_adafcb65c64ccf4cd7aa243765c95cc92_icgraph.png" border="0" usemap="#aclassgulp_1_1plugin_1_1_plugin_base_adafcb65c64ccf4cd7aa243765c95cc92_icgraph" alt=""/></div>
<map name="aclassgulp_1_1plugin_1_1_plugin_base_adafcb65c64ccf4cd7aa243765c95cc92_icgraph" id="aclassgulp_1_1plugin_1_1_plugin_base_adafcb65c64ccf4cd7aa243765c95cc92_icgraph">
<area shape="rect" title=" " alt="" coords="766,109,829,137"/>
<area shape="rect" href="classgulp_1_1plugin_1_1_plugin_base.html#a0f3983f38b1d29c20df0dd5a496359af" title=" " alt="" coords="562,5,693,33"/>
<area shape="poly" title=" " alt="" coords="774,99,748,72,717,48,691,36,693,31,720,44,752,68,778,95"/>
<area shape="rect" href="classgulp_1_1plugin_1_1_plugin_base.html#a28ec6d78487be57c105863d9f58904e7" title=" " alt="" coords="571,57,684,85"/>
<area shape="poly" title=" " alt="" coords="751,111,718,100,677,88,679,83,719,95,752,106"/>
<area shape="rect" href="classgulp_1_1plugin_1_1_plugin_base.html#ac39f95b7470b242061ba67ee749c4b44" title=" " alt="" coords="537,109,718,137"/>
<area shape="poly" title=" " alt="" coords="751,126,719,126,719,120,751,120"/>
<area shape="rect" href="classgulp_1_1plugin_1_1_plugin_base.html#a66de2da998fe4b3958a3a6ce1189fbe8" title=" " alt="" coords="542,161,713,189"/>
<area shape="poly" title=" " alt="" coords="752,140,719,151,679,163,677,158,718,146,751,135"/>
<area shape="rect" href="classgulp_1_1plugin_1_1_plugin_base.html#a0e422abddcbb67f93856a6f754cbfef7" title=" " alt="" coords="542,213,713,241"/>
<area shape="poly" title=" " alt="" coords="778,151,752,178,720,203,693,215,691,210,717,198,748,174,774,147"/>
<area shape="rect" href="classgulp_1_1plugins_1_1win__evtx_1_1_plugin.html#ab96082a9ecc6d0db5a48ee6958ac3239" title=" " alt="" coords="238,57,489,85"/>
<area shape="poly" title=" " alt="" coords="547,38,438,59,437,54,546,32"/>
<area shape="poly" title=" " alt="" coords="409,45,393,38,363,36,336,38,320,43,316,48,323,55,319,58,311,48,317,39,335,33,363,31,394,33,411,40"/>
<area shape="poly" title=" " alt="" coords="556,74,490,74,490,68,556,68"/>
<area shape="poly" title=" " alt="" coords="559,159,536,151,457,118,392,88,395,83,460,114,538,146,560,154"/>
<area shape="rect" href="classgulp_1_1plugins_1_1sigma_1_1windows_1_1_plugin.html#acc159cfa2b2d043ffa24a5f62e5c80a3" title=" " alt="" coords="259,205,468,250"/>
<area shape="poly" title=" " alt="" coords="526,230,468,230,468,224,526,224"/>
<area shape="rect" href="classgulp_1_1plugin__internal_1_1_gulp_plugin_params.html#a3afb8c54f9c26db579bb05cc3cf72bb3" title=" " alt="" coords="5,205,190,250"/>
<area shape="poly" title=" " alt="" coords="243,230,190,230,190,224,243,224"/>
</map>
</div>

</div>
</div>
<a id="a3cc5beb95fb74f4be44c04f84ed66a82" name="a3cc5beb95fb74f4be44c04f84ed66a82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3cc5beb95fb74f4be44c04f84ed66a82">&#9670;&#160;</a></span>name()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> str name </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Returns the name of the plugin.
</pre> 
<p>Reimplemented in <a class="el" href="classgulp_1_1plugins_1_1csv_1_1_plugin.html#a3cc5beb95fb74f4be44c04f84ed66a82">Plugin</a>, <a class="el" href="classgulp_1_1plugins_1_1sigma_1_1windows_1_1_plugin.html#a3cc5beb95fb74f4be44c04f84ed66a82">Plugin</a>, and <a class="el" href="classgulp_1_1plugins_1_1win__evtx_1_1_plugin.html#a3cc5beb95fb74f4be44c04f84ed66a82">Plugin</a>.</p>

<p class="definition">Definition at line <a class="el" href="plugin_8py_source.html#l00124">124</a> of file <a class="el" href="plugin_8py_source.html">plugin.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  124</span>    <span class="keyword">def </span>name(self) -&gt; str:</div>
<div class="line"><span class="lineno">  125</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  126</span><span class="stringliteral">        Returns the name of the plugin.</span></div>
<div class="line"><span class="lineno">  127</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  128</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classgulp_1_1plugin_1_1_plugin_base_a3cc5beb95fb74f4be44c04f84ed66a82_icgraph.png" border="0" usemap="#aclassgulp_1_1plugin_1_1_plugin_base_a3cc5beb95fb74f4be44c04f84ed66a82_icgraph" alt=""/></div>
<map name="aclassgulp_1_1plugin_1_1_plugin_base_a3cc5beb95fb74f4be44c04f84ed66a82_icgraph" id="aclassgulp_1_1plugin_1_1_plugin_base_a3cc5beb95fb74f4be44c04f84ed66a82_icgraph">
<area shape="rect" title=" " alt="" coords="1070,161,1128,189"/>
<area shape="rect" href="classgulp_1_1plugin_1_1_plugin_base.html#a400aabb1893cbe98511a69414c8e58a2" title=" " alt="" coords="876,56,983,84"/>
<area shape="poly" title=" " alt="" coords="1074,151,1050,127,1020,104,982,86,984,82,1023,100,1053,123,1078,147"/>
<area shape="rect" href="classgulp_1_1plugin_1_1_plugin_base.html#a66de2da998fe4b3958a3a6ce1189fbe8" title=" " alt="" coords="311,109,482,137"/>
<area shape="poly" title=" " alt="" coords="1054,168,1021,162,873,146,725,135,483,127,483,121,726,130,874,141,1022,157,1055,162"/>
<area shape="rect" href="classgulp_1_1plugins_1_1win__evtx_1_1_plugin.html#a38a3b56e6818d69a12aa847ac980895e" title=" " alt="" coords="537,158,789,203"/>
<area shape="poly" title=" " alt="" coords="1054,178,790,182,790,176,1054,173"/>
<area shape="rect" href="classgulp_1_1plugin_1_1_plugin_base.html#a0e422abddcbb67f93856a6f754cbfef7" title=" " alt="" coords="844,212,1015,240"/>
<area shape="poly" title=" " alt="" coords="1056,191,979,214,977,209,1054,186"/>
<area shape="rect" href="classgulp_1_1plugin__internal_1_1_gulp_plugin_option.html#a3afb8c54f9c26db579bb05cc3cf72bb3" title=" " alt="" coords="837,264,1022,308"/>
<area shape="poly" title=" " alt="" coords="1079,203,1054,229,1023,253,1002,265,999,261,1020,249,1050,225,1075,199"/>
<area shape="rect" href="classgulp_1_1plugin_1_1_plugin_base.html#a0f3983f38b1d29c20df0dd5a496359af" title=" " alt="" coords="331,5,462,33"/>
<area shape="poly" title=" " alt="" coords="861,59,789,47,612,31,463,24,463,18,613,26,790,42,862,53"/>
<area shape="rect" href="classgulp_1_1plugin_1_1_plugin_base.html#ad9cf9630b6d3e7ae9eab1b880e786222" title=" " alt="" coords="605,56,721,84"/>
<area shape="poly" title=" " alt="" coords="861,72,722,72,722,67,861,67"/>
<area shape="rect" href="classgulp_1_1plugins_1_1win__evtx_1_1_plugin.html#ab96082a9ecc6d0db5a48ee6958ac3239" title=" " alt="" coords="5,84,257,112"/>
<area shape="poly" title=" " alt="" coords="333,40,305,48,181,86,179,81,304,43,331,35"/>
<area shape="poly" title=" " alt="" coords="177,71,161,65,131,63,103,65,88,70,84,75,90,82,86,85,79,75,84,65,102,59,131,57,162,60,179,66"/>
<area shape="rect" href="classgulp_1_1plugin_1_1_plugin_base.html#abf39f32a2e7e60975eac7054393625da" title=" " alt="" coords="334,57,460,85"/>
<area shape="poly" title=" " alt="" coords="590,73,460,74,460,68,590,68"/>
<area shape="poly" title=" " alt="" coords="318,82,257,88,257,83,318,76"/>
<area shape="poly" title=" " alt="" coords="295,116,257,113,257,107,296,111"/>
<area shape="poly" title=" " alt="" coords="521,177,414,167,304,151,234,134,172,115,174,110,235,129,305,146,415,162,522,172"/>
<area shape="rect" href="classgulp_1_1plugins_1_1sigma_1_1windows_1_1_plugin.html#acc159cfa2b2d043ffa24a5f62e5c80a3" title=" " alt="" coords="558,228,768,272"/>
<area shape="poly" title=" " alt="" coords="829,238,768,243,768,238,828,232"/>
<area shape="rect" href="classgulp_1_1plugin__internal_1_1_gulp_plugin_params.html#a3afb8c54f9c26db579bb05cc3cf72bb3" title=" " alt="" coords="305,228,489,272"/>
<area shape="poly" title=" " alt="" coords="543,252,490,252,490,247,543,247"/>
</map>
</div>

</div>
</div>
<a id="ae7a969999e7d7be46f79b575de5f2224" name="ae7a969999e7d7be46f79b575de5f2224"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7a969999e7d7be46f79b575de5f2224">&#9670;&#160;</a></span>options()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> list[<a class="el" href="classgulp_1_1plugin__internal_1_1_gulp_plugin_option.html">GulpPluginOption</a>] options </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">return available GulpPluginOption list (plugin specific parameters)
</pre> 
<p>Reimplemented in <a class="el" href="classgulp_1_1plugins_1_1csv_1_1_plugin.html#ae7a969999e7d7be46f79b575de5f2224">Plugin</a>.</p>

<p class="definition">Definition at line <a class="el" href="plugin_8py_source.html#l00099">99</a> of file <a class="el" href="plugin_8py_source.html">plugin.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   99</span>    <span class="keyword">def </span>options(self) -&gt; list[GulpPluginOption]:</div>
<div class="line"><span class="lineno">  100</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  101</span><span class="stringliteral">        return available GulpPluginOption list (plugin specific parameters)</span></div>
<div class="line"><span class="lineno">  102</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  103</span>        <span class="keywordflow">return</span> []</div>
<div class="line"><span class="lineno">  104</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classgulp_1_1plugin_1_1_plugin_base_ae7a969999e7d7be46f79b575de5f2224_icgraph.png" border="0" usemap="#aclassgulp_1_1plugin_1_1_plugin_base_ae7a969999e7d7be46f79b575de5f2224_icgraph" alt=""/></div>
<map name="aclassgulp_1_1plugin_1_1_plugin_base_ae7a969999e7d7be46f79b575de5f2224_icgraph" id="aclassgulp_1_1plugin_1_1_plugin_base_ae7a969999e7d7be46f79b575de5f2224_icgraph">
<area shape="rect" title=" " alt="" coords="322,29,391,57"/>
<area shape="rect" href="classmapping_1_1models_1_1_gulp_mapping.html#a3afb8c54f9c26db579bb05cc3cf72bb3" title=" " alt="" coords="5,29,274,57"/>
<area shape="poly" title=" " alt="" coords="306,46,274,46,274,40,306,40"/>
<area shape="poly" title=" " alt="" coords="177,16,164,10,139,8,117,10,105,15,102,20,107,27,102,30,96,20,101,11,116,5,140,3,165,5,179,12"/>
</map>
</div>

</div>
</div>
<a id="acc159cfa2b2d043ffa24a5f62e5c80a3" name="acc159cfa2b2d043ffa24a5f62e5c80a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc159cfa2b2d043ffa24a5f62e5c80a3">&#9670;&#160;</a></span>pipeline()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> ProcessingPipeline pipeline </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classgulp_1_1plugin__internal_1_1_gulp_plugin_params.html">GulpPluginParams</a> </td>          <td class="paramname"><span class="paramname"><em>plugin_params</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">**</td>          <td class="paramname"><span class="paramname"><em>kwargs</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Returns the pysigma processing pipeline for the plugin, if any.

Args:
    plugin_params (GulpPluginParams, optional): additional parameters to pass to the pipeline. Defaults to None.
    kwargs: additional arguments if any.
Returns:
    ProcessingPipeline: The processing pipeline.
</pre> 
<p>Reimplemented in <a class="el" href="classgulp_1_1plugins_1_1sigma_1_1windows_1_1_plugin.html#acc159cfa2b2d043ffa24a5f62e5c80a3">Plugin</a>.</p>

<p class="definition">Definition at line <a class="el" href="plugin_8py_source.html#l00535">535</a> of file <a class="el" href="plugin_8py_source.html">plugin.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  537</span>    ) -&gt; ProcessingPipeline:</div>
<div class="line"><span class="lineno">  538</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  539</span><span class="stringliteral">        Returns the pysigma processing pipeline for the plugin, if any.</span></div>
<div class="line"><span class="lineno">  540</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  541</span><span class="stringliteral">        Args:</span></div>
<div class="line"><span class="lineno">  542</span><span class="stringliteral">            plugin_params (GulpPluginParams, optional): additional parameters to pass to the pipeline. Defaults to None.</span></div>
<div class="line"><span class="lineno">  543</span><span class="stringliteral">            kwargs: additional arguments if any.</span></div>
<div class="line"><span class="lineno">  544</span><span class="stringliteral">        Returns:</span></div>
<div class="line"><span class="lineno">  545</span><span class="stringliteral">            ProcessingPipeline: The processing pipeline.</span></div>
<div class="line"><span class="lineno">  546</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  547</span>        <span class="keywordflow">raise</span> NotImplementedError(<span class="stringliteral">&quot;not implemented!&quot;</span>)</div>
<div class="line"><span class="lineno">  548</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classgulp_1_1plugin_1_1_plugin_base_acc159cfa2b2d043ffa24a5f62e5c80a3_icgraph.png" border="0" usemap="#aclassgulp_1_1plugin_1_1_plugin_base_acc159cfa2b2d043ffa24a5f62e5c80a3_icgraph" alt=""/></div>
<map name="aclassgulp_1_1plugin_1_1_plugin_base_acc159cfa2b2d043ffa24a5f62e5c80a3_icgraph" id="aclassgulp_1_1plugin_1_1_plugin_base_acc159cfa2b2d043ffa24a5f62e5c80a3_icgraph">
<area shape="rect" title=" " alt="" coords="238,14,311,42"/>
<area shape="rect" href="classgulp_1_1plugin__internal_1_1_gulp_plugin_params.html#a3afb8c54f9c26db579bb05cc3cf72bb3" title=" " alt="" coords="5,5,190,50"/>
<area shape="poly" title=" " alt="" coords="222,30,190,30,190,25,222,25"/>
</map>
</div>

</div>
</div>
<a id="a38a3b56e6818d69a12aa847ac980895e" name="a38a3b56e6818d69a12aa847ac980895e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38a3b56e6818d69a12aa847ac980895e">&#9670;&#160;</a></span>record_to_gulp_document()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> list[GulpDocument] record_to_gulp_document </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>operation_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>client_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str</td>          <td class="paramname"><span class="paramname"><em>context</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str</td>          <td class="paramname"><span class="paramname"><em>source</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TmpIngestStats</td>          <td class="paramname"><span class="paramname"><em>fs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">any</td>          <td class="paramname"><span class="paramname"><em>record</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>record_idx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GulpMapping </td>          <td class="paramname"><span class="paramname"><em>custom_mapping</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dict </td>          <td class="paramname"><span class="paramname"><em>index_type_mapping</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str </td>          <td class="paramname"><span class="paramname"><em>plugin</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classgulp_1_1plugin__internal_1_1_gulp_plugin_params.html">GulpPluginParams</a> </td>          <td class="paramname"><span class="paramname"><em>plugin_params</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">**</td>          <td class="paramname"><span class="paramname"><em>kwargs</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Converts a record to one or more GulpDocument objects based on the provided index mappings.

Args:
    operation_id (int): The operation ID associated with the record.
    client_id (int): The client ID associated with the record.
    context (str): The context associated with the record.
    source (str): The source of the record (source file name or path, usually).
    fs (TmpIngestStats): The temporary ingestion statistics (may be updated on return).
    record (any): record to convert, plugin dependent format: note that here stacked plugins receives a list of GulpDocument objects instead (since the original record may generate one or more documents).
    record_idx (int): The index of the record in source.
    custom_mapping (GulpMapping, optional): The custom mapping to use for the conversion. Defaults to None.
    index_type_mapping (dict, optional): elastic search index type mappings { "ecs_field": "type", ... }. Defaults to None.
    plugin (str, optional): "agent.type" to be set in the GulpDocument. Defaults to None.
    plugin_params (GulpPluginParams, optional): The plugin parameters to use, if any. Defaults to None.
    extra (dict, optional): Additional fields to add to the GulpDocument (after applying mapping). Defaults to None.
    **kwargs: Additional keyword arguments:

Returns:
    list[GulDocument]: The converted GulpDocument objects or None if an exception occurred (fs is updated then).

Raises:
    NotImplementedError: This method is not implemented yet.
</pre> 
<p>Reimplemented in <a class="el" href="classgulp_1_1plugins_1_1csv_1_1_plugin.html#a38a3b56e6818d69a12aa847ac980895e">Plugin</a>, and <a class="el" href="classgulp_1_1plugins_1_1win__evtx_1_1_plugin.html#a38a3b56e6818d69a12aa847ac980895e">Plugin</a>.</p>

<p class="definition">Definition at line <a class="el" href="plugin_8py_source.html#l00455">455</a> of file <a class="el" href="plugin_8py_source.html">plugin.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  469</span>    ) -&gt; list[GulpDocument]:</div>
<div class="line"><span class="lineno">  470</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  471</span><span class="stringliteral">        Converts a record to one or more GulpDocument objects based on the provided index mappings.</span></div>
<div class="line"><span class="lineno">  472</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  473</span><span class="stringliteral">        Args:</span></div>
<div class="line"><span class="lineno">  474</span><span class="stringliteral">            operation_id (int): The operation ID associated with the record.</span></div>
<div class="line"><span class="lineno">  475</span><span class="stringliteral">            client_id (int): The client ID associated with the record.</span></div>
<div class="line"><span class="lineno">  476</span><span class="stringliteral">            context (str): The context associated with the record.</span></div>
<div class="line"><span class="lineno">  477</span><span class="stringliteral">            source (str): The source of the record (source file name or path, usually).</span></div>
<div class="line"><span class="lineno">  478</span><span class="stringliteral">            fs (TmpIngestStats): The temporary ingestion statistics (may be updated on return).</span></div>
<div class="line"><span class="lineno">  479</span><span class="stringliteral">            record (any): record to convert, plugin dependent format: note that here stacked plugins receives a list of GulpDocument objects instead (since the original record may generate one or more documents).</span></div>
<div class="line"><span class="lineno">  480</span><span class="stringliteral">            record_idx (int): The index of the record in source.</span></div>
<div class="line"><span class="lineno">  481</span><span class="stringliteral">            custom_mapping (GulpMapping, optional): The custom mapping to use for the conversion. Defaults to None.</span></div>
<div class="line"><span class="lineno">  482</span><span class="stringliteral">            index_type_mapping (dict, optional): elastic search index type mappings { &quot;ecs_field&quot;: &quot;type&quot;, ... }. Defaults to None.</span></div>
<div class="line"><span class="lineno">  483</span><span class="stringliteral">            plugin (str, optional): &quot;agent.type&quot; to be set in the GulpDocument. Defaults to None.</span></div>
<div class="line"><span class="lineno">  484</span><span class="stringliteral">            plugin_params (GulpPluginParams, optional): The plugin parameters to use, if any. Defaults to None.</span></div>
<div class="line"><span class="lineno">  485</span><span class="stringliteral">            extra (dict, optional): Additional fields to add to the GulpDocument (after applying mapping). Defaults to None.</span></div>
<div class="line"><span class="lineno">  486</span><span class="stringliteral">            **kwargs: Additional keyword arguments:</span></div>
<div class="line"><span class="lineno">  487</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  488</span><span class="stringliteral">        Returns:</span></div>
<div class="line"><span class="lineno">  489</span><span class="stringliteral">            list[GulDocument]: The converted GulpDocument objects or None if an exception occurred (fs is updated then).</span></div>
<div class="line"><span class="lineno">  490</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  491</span><span class="stringliteral">        Raises:</span></div>
<div class="line"><span class="lineno">  492</span><span class="stringliteral">            NotImplementedError: This method is not implemented yet.</span></div>
<div class="line"><span class="lineno">  493</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  494</span>        <span class="keywordflow">raise</span> NotImplementedError(<span class="stringliteral">&quot;not implemented!&quot;</span>)</div>
<div class="line"><span class="lineno">  495</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classgulp_1_1plugin_1_1_plugin_base_a38a3b56e6818d69a12aa847ac980895e_icgraph.png" border="0" usemap="#aclassgulp_1_1plugin_1_1_plugin_base_a38a3b56e6818d69a12aa847ac980895e_icgraph" alt=""/></div>
<map name="aclassgulp_1_1plugin_1_1_plugin_base_a38a3b56e6818d69a12aa847ac980895e_icgraph" id="aclassgulp_1_1plugin_1_1_plugin_base_a38a3b56e6818d69a12aa847ac980895e_icgraph">
<area shape="rect" title=" " alt="" coords="305,29,494,57"/>
<area shape="rect" href="classgulp_1_1plugins_1_1win__evtx_1_1_plugin.html#ab96082a9ecc6d0db5a48ee6958ac3239" title=" " alt="" coords="5,29,257,57"/>
<area shape="poly" title=" " alt="" coords="289,46,257,46,257,40,289,40"/>
<area shape="poly" title=" " alt="" coords="177,17,161,10,131,8,103,10,87,15,83,20,90,27,86,30,78,20,84,11,102,5,131,3,162,5,179,12"/>
</map>
</div>

</div>
</div>
<a id="a0373c98260b243f699a1e65849b1fcad" name="a0373c98260b243f699a1e65849b1fcad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0373c98260b243f699a1e65849b1fcad">&#9670;&#160;</a></span>run_command()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> dict run_command </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classgulp_1_1plugin__internal_1_1_gulp_plugin_params.html">GulpPluginParams</a></td>          <td class="paramname"><span class="paramname"><em>p</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Runs a custom command
</pre> 
<p class="definition">Definition at line <a class="el" href="plugin_8py_source.html#l00141">141</a> of file <a class="el" href="plugin_8py_source.html">plugin.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  141</span>    <span class="keyword">def </span>run_command(self, p: GulpPluginParams) -&gt; dict:</div>
<div class="line"><span class="lineno">  142</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  143</span><span class="stringliteral">        Runs a custom command</span></div>
<div class="line"><span class="lineno">  144</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  145</span>        <span class="keywordflow">return</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  146</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a0e422abddcbb67f93856a6f754cbfef7" name="a0e422abddcbb67f93856a6f754cbfef7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e422abddcbb67f93856a6f754cbfef7">&#9670;&#160;</a></span>sigma_plugin_initialize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> ProcessingPipeline sigma_plugin_initialize </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ProcessingPipeline </td>          <td class="paramname"><span class="paramname"><em>pipeline</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str </td>          <td class="paramname"><span class="paramname"><em>mapping_file</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str </td>          <td class="paramname"><span class="paramname"><em>mapping_id</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str </td>          <td class="paramname"><span class="paramname"><em>product</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classgulp_1_1plugin__internal_1_1_gulp_plugin_params.html">GulpPluginParams</a> </td>          <td class="paramname"><span class="paramname"><em>plugin_params</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Initializes the Sigma plugin to convert sigma rules YAML to elasticsearch DSL query.

Args:
    pipeline (ProcessingPipeline, optional): The processing pipeline. Defaults to None (empty pipeline, plugin must fill it).
    mapping_file (str, optional): The name of the mapping file (i.e. 'windows.json') in the gulp/mapping_files directory. Defaults to None (use pipeline mapping only).
    mapping_id (str, optional): The mapping ID (["options"]["mapping_id"] in the mapping file, to get a specific mapping). Defaults to None (use first).
    product (str, optional): The product. Defaults to None.
    plugin_params (GulpPluginParams, optional): The plugin parameters, to override i.e. mapping_file_path, mapping_id, ... Defaults to None.
Returns:
    ProcessingPipeline: The initialized processing pipeline.
</pre> 
<p class="definition">Definition at line <a class="el" href="plugin_8py_source.html#l00196">196</a> of file <a class="el" href="plugin_8py_source.html">plugin.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  203</span>    ) -&gt; ProcessingPipeline:</div>
<div class="line"><span class="lineno">  204</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  205</span><span class="stringliteral">        Initializes the Sigma plugin to convert sigma rules YAML to elasticsearch DSL query.</span></div>
<div class="line"><span class="lineno">  206</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  207</span><span class="stringliteral">        Args:</span></div>
<div class="line"><span class="lineno">  208</span><span class="stringliteral">            pipeline (ProcessingPipeline, optional): The processing pipeline. Defaults to None (empty pipeline, plugin must fill it).</span></div>
<div class="line"><span class="lineno">  209</span><span class="stringliteral">            mapping_file (str, optional): The name of the mapping file (i.e. &#39;windows.json&#39;) in the gulp/mapping_files directory. Defaults to None (use pipeline mapping only).</span></div>
<div class="line"><span class="lineno">  210</span><span class="stringliteral">            mapping_id (str, optional): The mapping ID ([&quot;options&quot;][&quot;mapping_id&quot;] in the mapping file, to get a specific mapping). Defaults to None (use first).</span></div>
<div class="line"><span class="lineno">  211</span><span class="stringliteral">            product (str, optional): The product. Defaults to None.</span></div>
<div class="line"><span class="lineno">  212</span><span class="stringliteral">            plugin_params (GulpPluginParams, optional): The plugin parameters, to override i.e. mapping_file_path, mapping_id, ... Defaults to None.</span></div>
<div class="line"><span class="lineno">  213</span><span class="stringliteral">        Returns:</span></div>
<div class="line"><span class="lineno">  214</span><span class="stringliteral">            ProcessingPipeline: The initialized processing pipeline.</span></div>
<div class="line"><span class="lineno">  215</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  216</span>        self.logger().debug(<span class="stringliteral">&quot;INITIALIZING SIGMA plugin=%s&quot;</span> % (self.name()))</div>
<div class="line"><span class="lineno">  217</span> </div>
<div class="line"><span class="lineno">  218</span>        mapping_file_path = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  219</span>        <span class="keywordflow">if</span> mapping_file <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  220</span>            <span class="comment"># get path in mapping directory</span></div>
<div class="line"><span class="lineno">  221</span>            mapping_file_path = gulp_utils.build_mapping_file_path(mapping_file)</div>
<div class="line"><span class="lineno">  222</span> </div>
<div class="line"><span class="lineno">  223</span>        <span class="keywordflow">if</span> plugin_params <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  224</span>            <span class="comment"># override with plugin_params</span></div>
<div class="line"><span class="lineno">  225</span>            <span class="keywordflow">if</span> plugin_params.mapping_file <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  226</span>                mapping_file_path = gulp_utils.build_mapping_file_path(</div>
<div class="line"><span class="lineno">  227</span>                    plugin_params.mapping_file</div>
<div class="line"><span class="lineno">  228</span>                )</div>
<div class="line"><span class="lineno">  229</span>            <span class="keywordflow">if</span> plugin_params.mapping_id <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  230</span>                mapping_id = plugin_params.mapping_id</div>
<div class="line"><span class="lineno">  231</span> </div>
<div class="line"><span class="lineno">  232</span>        p = await mappings_helper.get_enriched_pipeline(</div>
<div class="line"><span class="lineno">  233</span>            pipeline=pipeline,</div>
<div class="line"><span class="lineno">  234</span>            mapping_file_path=mapping_file_path,</div>
<div class="line"><span class="lineno">  235</span>            mapping_id=mapping_id,</div>
<div class="line"><span class="lineno">  236</span>            product=product,</div>
<div class="line"><span class="lineno">  237</span>        )</div>
<div class="line"><span class="lineno">  238</span>        <span class="keywordflow">return</span> p</div>
<div class="line"><span class="lineno">  239</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classgulp_1_1plugin_1_1_plugin_base_a0e422abddcbb67f93856a6f754cbfef7_cgraph.png" border="0" usemap="#aclassgulp_1_1plugin_1_1_plugin_base_a0e422abddcbb67f93856a6f754cbfef7_cgraph" alt=""/></div>
<map name="aclassgulp_1_1plugin_1_1_plugin_base_a0e422abddcbb67f93856a6f754cbfef7_cgraph" id="aclassgulp_1_1plugin_1_1_plugin_base_a0e422abddcbb67f93856a6f754cbfef7_cgraph">
<area shape="rect" title=" " alt="" coords="5,57,177,85"/>
<area shape="rect" href="classgulp_1_1plugin_1_1_plugin_base.html#adafcb65c64ccf4cd7aa243765c95cc92" title=" " alt="" coords="299,5,361,33"/>
<area shape="poly" title=" " alt="" coords="158,54,283,26,284,32,159,59"/>
<area shape="rect" href="classgulp_1_1plugin_1_1_plugin_base.html#a3cc5beb95fb74f4be44c04f84ed66a82" title=" " alt="" coords="301,57,359,85"/>
<area shape="poly" title=" " alt="" coords="177,68,285,68,285,74,177,74"/>
<area shape="rect" href="classgulp_1_1plugins_1_1csv_1_1_plugin.html#a3cc5beb95fb74f4be44c04f84ed66a82" title=" " alt="" coords="225,109,435,137"/>
<area shape="poly" title=" " alt="" coords="159,83,248,103,247,108,158,88"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classgulp_1_1plugin_1_1_plugin_base_a0e422abddcbb67f93856a6f754cbfef7_icgraph.png" border="0" usemap="#aclassgulp_1_1plugin_1_1_plugin_base_a0e422abddcbb67f93856a6f754cbfef7_icgraph" alt=""/></div>
<map name="aclassgulp_1_1plugin_1_1_plugin_base_a0e422abddcbb67f93856a6f754cbfef7_icgraph" id="aclassgulp_1_1plugin_1_1_plugin_base_a0e422abddcbb67f93856a6f754cbfef7_icgraph">
<area shape="rect" title=" " alt="" coords="495,14,666,42"/>
<area shape="rect" href="classgulp_1_1plugins_1_1sigma_1_1windows_1_1_plugin.html#acc159cfa2b2d043ffa24a5f62e5c80a3" title=" " alt="" coords="238,5,447,50"/>
<area shape="poly" title=" " alt="" coords="480,30,448,30,448,25,480,25"/>
<area shape="rect" href="classgulp_1_1plugin__internal_1_1_gulp_plugin_params.html#a3afb8c54f9c26db579bb05cc3cf72bb3" title=" " alt="" coords="5,5,190,50"/>
<area shape="poly" title=" " alt="" coords="222,30,190,30,190,25,222,25"/>
</map>
</div>

</div>
</div>
<a id="acc17a69ceae0067ad2cc9bba5fe59fe9" name="acc17a69ceae0067ad2cc9bba5fe59fe9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc17a69ceae0067ad2cc9bba5fe59fe9">&#9670;&#160;</a></span>tags()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> list[str] tags </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">returns a list of tags for the plugin. Tags are used to aid filtering of plugins/query filters in the UI.
- "event"
- "network"
- "file"
- "process"
- "threat"
- "threat.enrichments"
- ...
</pre> 
<p class="definition">Definition at line <a class="el" href="plugin_8py_source.html#l00153">153</a> of file <a class="el" href="plugin_8py_source.html">plugin.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  153</span>    <span class="keyword">def </span>tags(self) -&gt; list[str]:</div>
<div class="line"><span class="lineno">  154</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  155</span><span class="stringliteral">        returns a list of tags for the plugin. Tags are used to aid filtering of plugins/query filters in the UI.</span></div>
<div class="line"><span class="lineno">  156</span><span class="stringliteral">        - &quot;event&quot;</span></div>
<div class="line"><span class="lineno">  157</span><span class="stringliteral">        - &quot;network&quot;</span></div>
<div class="line"><span class="lineno">  158</span><span class="stringliteral">        - &quot;file&quot;</span></div>
<div class="line"><span class="lineno">  159</span><span class="stringliteral">        - &quot;process&quot;</span></div>
<div class="line"><span class="lineno">  160</span><span class="stringliteral">        - &quot;threat&quot;</span></div>
<div class="line"><span class="lineno">  161</span><span class="stringliteral">        - &quot;threat.enrichments&quot;</span></div>
<div class="line"><span class="lineno">  162</span><span class="stringliteral">        - ...</span></div>
<div class="line"><span class="lineno">  163</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  164</span>        <span class="keywordflow">return</span> []</div>
<div class="line"><span class="lineno">  165</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a48d7d6a080b67ba8c58522a1e05ce930" name="a48d7d6a080b67ba8c58522a1e05ce930"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48d7d6a080b67ba8c58522a1e05ce930">&#9670;&#160;</a></span>type()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> GulpPluginType type </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Returns the plugin type.
</pre> 
<p>Reimplemented in <a class="el" href="classgulp_1_1plugins_1_1csv_1_1_plugin.html#a48d7d6a080b67ba8c58522a1e05ce930">Plugin</a>, <a class="el" href="classgulp_1_1plugins_1_1sigma_1_1windows_1_1_plugin.html#a48d7d6a080b67ba8c58522a1e05ce930">Plugin</a>, and <a class="el" href="classgulp_1_1plugins_1_1win__evtx_1_1_plugin.html#a48d7d6a080b67ba8c58522a1e05ce930">Plugin</a>.</p>

<p class="definition">Definition at line <a class="el" href="plugin_8py_source.html#l00106">106</a> of file <a class="el" href="plugin_8py_source.html">plugin.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  106</span>    <span class="keyword">def </span>type(self) -&gt; GulpPluginType:</div>
<div class="line"><span class="lineno">  107</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  108</span><span class="stringliteral">        Returns the plugin type.</span></div>
<div class="line"><span class="lineno">  109</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  110</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classgulp_1_1plugin_1_1_plugin_base_a48d7d6a080b67ba8c58522a1e05ce930_icgraph.png" border="0" usemap="#aclassgulp_1_1plugin_1_1_plugin_base_a48d7d6a080b67ba8c58522a1e05ce930_icgraph" alt=""/></div>
<map name="aclassgulp_1_1plugin_1_1_plugin_base_a48d7d6a080b67ba8c58522a1e05ce930_icgraph" id="aclassgulp_1_1plugin_1_1_plugin_base_a48d7d6a080b67ba8c58522a1e05ce930_icgraph">
<area shape="rect" title=" " alt="" coords="790,29,841,57"/>
<area shape="rect" href="classgulp_1_1plugin_1_1_plugin_base.html#a4b661e5352802554dc25028526496f7b" title=" " alt="" coords="605,29,742,57"/>
<area shape="poly" title=" " alt="" coords="775,46,743,46,743,40,775,40"/>
<area shape="rect" href="classgulp_1_1plugins_1_1win__evtx_1_1_plugin.html#a38a3b56e6818d69a12aa847ac980895e" title=" " alt="" coords="305,21,557,66"/>
<area shape="poly" title=" " alt="" coords="590,46,557,46,557,40,590,40"/>
<area shape="rect" href="classgulp_1_1plugins_1_1win__evtx_1_1_plugin.html#ab96082a9ecc6d0db5a48ee6958ac3239" title=" " alt="" coords="5,29,257,57"/>
<area shape="poly" title=" " alt="" coords="289,46,257,46,257,40,289,40"/>
<area shape="poly" title=" " alt="" coords="183,17,166,10,131,8,99,10,82,15,77,20,85,27,81,31,72,20,79,11,99,5,131,3,167,5,185,12"/>
</map>
</div>

</div>
</div>
<a id="a1e436b61f937ea687fa3897d286899cf" name="a1e436b61f937ea687fa3897d286899cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e436b61f937ea687fa3897d286899cf">&#9670;&#160;</a></span>version()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> str version </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Returns plugin version.
</pre> 
<p>Reimplemented in <a class="el" href="classgulp_1_1plugins_1_1csv_1_1_plugin.html#a1e436b61f937ea687fa3897d286899cf">Plugin</a>, <a class="el" href="classgulp_1_1plugins_1_1sigma_1_1windows_1_1_plugin.html#a1e436b61f937ea687fa3897d286899cf">Plugin</a>, and <a class="el" href="classgulp_1_1plugins_1_1win__evtx_1_1_plugin.html#a1e436b61f937ea687fa3897d286899cf">Plugin</a>.</p>

<p class="definition">Definition at line <a class="el" href="plugin_8py_source.html#l00112">112</a> of file <a class="el" href="plugin_8py_source.html">plugin.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  112</span>    <span class="keyword">def </span>version(self) -&gt; str:</div>
<div class="line"><span class="lineno">  113</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  114</span><span class="stringliteral">        Returns plugin version.</span></div>
<div class="line"><span class="lineno">  115</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  116</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a159bff19598c519586a6301ea31a3dde" name="a159bff19598c519586a6301ea31a3dde"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a159bff19598c519586a6301ea31a3dde">&#9670;&#160;</a></span>buffer</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">list buffer = []</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="plugin_8py_source.html#l00086">86</a> of file <a class="el" href="plugin_8py_source.html">plugin.py</a>.</p>

</div>
</div>
<a id="a12087c1690a56089011c8e1a9f4e319e" name="a12087c1690a56089011c8e1a9f4e319e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12087c1690a56089011c8e1a9f4e319e">&#9670;&#160;</a></span>client_id</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">str client_id = None</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="plugin_8py_source.html#l00078">78</a> of file <a class="el" href="plugin_8py_source.html">plugin.py</a>.</p>

</div>
</div>
<a id="af2760b1eea7c1b7f2459abf2872cbac6" name="af2760b1eea7c1b7f2459abf2872cbac6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2760b1eea7c1b7f2459abf2872cbac6">&#9670;&#160;</a></span>collab</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">collab = collab</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="plugin_8py_source.html#l00083">83</a> of file <a class="el" href="plugin_8py_source.html">plugin.py</a>.</p>

</div>
</div>
<a id="aed88676be607a3199e7b417512f3d8f1" name="aed88676be607a3199e7b417512f3d8f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed88676be607a3199e7b417512f3d8f1">&#9670;&#160;</a></span>context</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">tuple context = (None,)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="plugin_8py_source.html#l00080">80</a> of file <a class="el" href="plugin_8py_source.html">plugin.py</a>.</p>

</div>
</div>
<a id="a85ca465c1498add707b193266a2dc717" name="a85ca465c1498add707b193266a2dc717"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85ca465c1498add707b193266a2dc717">&#9670;&#160;</a></span>elastic</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">elastic = elastic</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="plugin_8py_source.html#l00084">84</a> of file <a class="el" href="plugin_8py_source.html">plugin.py</a>.</p>

</div>
</div>
<a id="a0d326931fdde686f05f73ed00cad6f36" name="a0d326931fdde686f05f73ed00cad6f36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d326931fdde686f05f73ed00cad6f36">&#9670;&#160;</a></span>index</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">str index = None</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="plugin_8py_source.html#l00077">77</a> of file <a class="el" href="plugin_8py_source.html">plugin.py</a>.</p>

</div>
</div>
<a id="ad1f1eb15a79c7b61e759632d9333976b" name="ad1f1eb15a79c7b61e759632d9333976b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1f1eb15a79c7b61e759632d9333976b">&#9670;&#160;</a></span>operation_id</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">str operation_id = None</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="plugin_8py_source.html#l00079">79</a> of file <a class="el" href="plugin_8py_source.html">plugin.py</a>.</p>

</div>
</div>
<a id="aa28dc103258589d9cb421197fe2de90b" name="aa28dc103258589d9cb421197fe2de90b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa28dc103258589d9cb421197fe2de90b">&#9670;&#160;</a></span>path</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">path = path</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="plugin_8py_source.html#l00082">82</a> of file <a class="el" href="plugin_8py_source.html">plugin.py</a>.</p>

</div>
</div>
<a id="a1370c514cd93cb996ddf27f0400840bc" name="a1370c514cd93cb996ddf27f0400840bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1370c514cd93cb996ddf27f0400840bc">&#9670;&#160;</a></span>req_id</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">str req_id = None</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="plugin_8py_source.html#l00076">76</a> of file <a class="el" href="plugin_8py_source.html">plugin.py</a>.</p>

</div>
</div>
<a id="a333f06e1a7df05effecbc6a8fa238cca" name="a333f06e1a7df05effecbc6a8fa238cca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a333f06e1a7df05effecbc6a8fa238cca">&#9670;&#160;</a></span>ws_id</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">str ws_id = None</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="plugin_8py_source.html#l00081">81</a> of file <a class="el" href="plugin_8py_source.html">plugin.py</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>src/gulp/<a class="el" href="plugin_8py_source.html">plugin.py</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<script>
    mermaid.initialize({
        startOnLoad: true,
        theme: "dark",
    });
</script>
