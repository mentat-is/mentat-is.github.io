<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=9" />
        <meta name="generator" content="Doxygen 1.12.0" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <!-- BEGIN opengraph metadata -->
        <meta property="og:title" content="gULP! Documentation" />
        <meta
            property="og:image"
            content="https://repository-images.githubusercontent.com/348492097/4f16df80-88fb-11eb-9d31-4015ff22c452"
        />
        <meta
            property="og:description"
            content="Custom CSS theme for doxygen html-documentation with lots of customization parameters."
        />
        <meta
            property="og:url"
            content="https://github.com/mentat-is/gulp"
        />
        <!-- END opengraph metadata -->
        <!-- BEGIN twitter metadata -->
        <meta
            name="twitter:image:src"
            content="https://repository-images.githubusercontent.com/348492097/4f16df80-88fb-11eb-9d31-4015ff22c452"
        />
        <meta name="twitter:title" content="Mentat" />
        <meta name="twitter:description" content="mentat.is" />
        <!-- END twitter metadata -->
        <title>(g)ULP!: (g)ULP!</title>
        <link href="tabs.css" rel="stylesheet" type="text/css" />
        <link rel="icon" type="image/svg+xml" href="logo.drawio.svg" />
        <script type="text/javascript" src="jquery.js"></script>
        <script type="text/javascript" src="dynsections.js"></script>
        <script
            type="text/javascript"
            src="doxygen-awesome-darkmode-toggle.js"
        ></script>
        <script
            type="text/javascript"
            src="doxygen-awesome-fragment-copy-button.js"
        ></script>
        <script
            type="text/javascript"
            src="doxygen-awesome-paragraph-link.js"
        ></script>
        <script
            type="text/javascript"
            src="doxygen-awesome-interactive-toc.js"
        ></script>
        <script
            type="text/javascript"
            src="doxygen-awesome-tabs.js"
        ></script>
        <script type="text/javascript">
            DoxygenAwesomeFragmentCopyButton.init();
            DoxygenAwesomeDarkModeToggle.init();
            DoxygenAwesomeParagraphLink.init();
            DoxygenAwesomeInteractiveToc.init();
            DoxygenAwesomeTabs.init();
        </script>
        </script>
        <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
 <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
        <link href="doxygen.css" rel="stylesheet" type="text/css" />
        <link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
    </head>
    <body>
        <script src="https://cdn.jsdelivr.net/npm/mermaid@latest/dist/mermaid.min.js"></script>
        <a
            href="https://github.com/mentat-is/gulp"
            class="github-corner"
            title="View source on GitHub"
            target="_blank"
            rel="noopener noreferrer"
        >
            <svg
                viewBox="0 0 250 250"
                width="40"
                height="40"
                style="
                    position: absolute;
                    top: 0;
                    border: 0;
                    right: 0;
                    z-index: 99;
                "
                aria-hidden="true"
            >
                <path
                    d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"
                ></path>
                <path
                    d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
                    fill="currentColor"
                    style="transform-origin: 130px 106px"
                    class="octo-arm"
                ></path>
                <path
                    d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
                    fill="currentColor"
                    class="octo-body"
                ></path></svg
        ></a>
        <style>
            .github-corner:hover .octo-arm {
                animation: octocat-wave 560ms ease-in-out;
            }
            @keyframes octocat-wave {
                0%,
                100% {
                    transform: rotate(0);
                }
                20%,
                60% {
                    transform: rotate(-25deg);
                }
                40%,
                80% {
                    transform: rotate(10deg);
                }
            }
            @media (max-width: 500px) {
                .github-corner:hover .octo-arm {
                    animation: none;
                }
                .github-corner .octo-arm {
                    animation: octocat-wave 560ms ease-in-out;
                }
            }
        </style>
        <div id="top">
            <!-- do not remove this div, it is closed by doxygen! -->
            <div id="titlearea">
                <table cellspacing="0" cellpadding="0">
                    <tbody>
                        <tr style="height: 56px">
                            <td id="projectalign" style="padding-left: 0.5em">
                                <div id="projectname">
                                    (g)ULP!
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <!-- end header part -->
        </div>
    </body>
</html>
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('index.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">(g)ULP! </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md__r_e_a_d_m_e"></a> </p><div align="center"></div><div align="center">&lt;picture&gt; &lt;source media="(prefers-color-scheme: dark)" srcset="./image.png"&gt; &lt;source media="(prefers-color-scheme: light)" srcset="./image.png"&gt; <img src="./image.png" alt="gULP" width="30%" height="30%" class="inline"/> &lt;/picture&gt;</div><div align="center">the generic, universal Log processor for incident response!</div><div align="center"><em>made with :heart: by Mentat.</em></div><div align="center"></div><p><a href="https://github.com/mentat-is?tab=followers"><img src="https://img.shields.io/github/followers/mentat-is.svg?style=social&amp;label=Follow&amp;maxAge=2592000" alt="GitHub followers" style="pointer-events: none;" class="inline"/></a></p>
<div align="center"></div><div align="center">Description - Architecture - API - Installation - Run &amp; examples - GUI - <a class="el" href="md_docs_2_troubleshooting.html">Troubleshooting</a></div><div align="center"></div><h2><a class="anchor" id="autotoc_md50"></a>
Description</h2>
<p>Gulp is a powerful software tool designed to streamline incident response and analysis. Its core features include:</p>
<h3><a class="anchor" id="autotoc_md51"></a>
Current features</h3>
<ul>
<li><b>Data Ingestion Plugins</b>: Gulp can ingest data from a variety of sources, thanks to its versatile plugin system.</li>
<li><b>OpenSearch and ECS</b>: Gulp is built on OpenSearch and uses the <em>Elasticsearch Common Scheme (ECS)</em> as its ingestion format, ensuring compatibility and ease of use.</li>
<li><b>High-Speed Multiprocessing Engine</b>: Gulp's engine is designed for speed, offering fast ingestion and querying capabilities through multiprocessing.</li>
<li><b>Query using SIGMA rules</b>: Gulp supports querying using Sigma Rules, allowing for easy, one-click queries with thousands of rules in parallel.</li>
<li><b>Collaboration Platform</b>: Gulp includes a collaboration platform, enabling teams to work together on the same incident. Features include note-taking, highlighting, and link adding.</li>
<li><b>Innovative UI</b>: Gulp's user interface includes multiple on-screen per-context(i.e. a log source) zoomable timelines for visualizing events, making it easier to understand and analyze incidents.</li>
<li><b>Scalable</b>: Gulp is designed with scalability in mind. As your data and team grow, you can simply add more cores to increase parallel ingestion and query capabilities, and more OpenSearch and PostgreSQL hosts. This makes Gulp a flexible solution that can adapt to your evolving needs!</li>
<li><b>Python based</b>: Gulp is written in Python, leveraging open-source libraries whenever possible. This maximizes ease of adoption from the community, as Python is widely used and understood.</li>
<li><b>UI clients</b>: While <a href="https://github.com/mentat-is/gulpui-web">a full fledged web-ui</a> is in the works, in the meantime you can use most of the features using the .NET client we use ourself to testdrive during development.</li>
</ul>
<h2><a class="anchor" id="autotoc_md52"></a>
Timeline</h2>
<p>Here's the rough timeline we put together, it is subject to change:</p>
<p><img src=".images/timeline.png" alt="timeline" class="inline"/></p>
<p>soon we will release the slides we did at <a href="https://moca.camp">MOCA2024</a>, stay tuned!</p>
<h2><a class="anchor" id="autotoc_md53"></a>
Installation</h2>
<h3><a class="anchor" id="autotoc_md54"></a>
Quick Install</h3>
<div class="fragment"><div class="line">curl https://raw.githubusercontent.com/mentat-is/gulp/refs/heads/develop/setup.sh | sudo bash</div>
</div><!-- fragment --><p> This will create a <code>gulp</code> folder, inside the current directory.</p>
<h3><a class="anchor" id="autotoc_md55"></a>
Other installation methods</h3>
<ul>
<li><a class="el" href="md_docs_2_install_01_docker.html">docker</a></li>
<li><a class="el" href="md_docs_2_install_01_dev.html">install from sources</a></li>
</ul>
<h3><a class="anchor" id="autotoc_md56"></a>
Environment variables</h3>
<p>the following environment variables may be set to override configuration options.</p>
<ul>
<li><code>PATH_CONFIG</code>: if set, will be used as path for the configuration file (either, <code>~/.config/gulp/gulp_cfg.json</code> will be used)</li>
<li><code>PATH_PLUGINS</code>: if set, will be used as path for <code>plugins</code> directory (either, the default <code>$INSTALLDIR/plugins</code> will be used)</li>
<li><code>PATH_MAPPING_FILES</code>: if set, will be used as path for the mapping files to be used by plugins (either, the default is <code>$INSTALLDIR/mapping_files</code>)</li>
<li><code>PATH_CERTS</code>: if set, overrides <code>path_certs</code> in the configuration (for HTTPS).</li>
<li><code>ELASTIC_URL</code>: if set, overrides <code>elastic_url</code> in the configuration.</li>
<li><code>POSTGRES_URL</code>: if set, overrides <code>postgres_url</code> in the configuration.</li>
<li><code>SMTP_SERVER</code>: if set, overrides <code>smtp_server</code> in the configuration.</li>
<li><code>SMTP_USERNAME</code>: if set, overrides <code>stmp_username</code> in the configuration.</li>
<li><code>SMTP_PASSWORD</code>: if set, overrides <code>stmp_password</code> in the configuration.</li>
<li><code>SMTP_FROM</code>: if set, overrides <code>smtp_from</code> in the configuration.</li>
<li><code>GULP_INTEGRATION_TEST</code>: <b>TEST ONLY</b>, this must be set to 1 during integration testing (i.e. client api) to disable debug features which may interfere.</li>
</ul>
<h3><a class="anchor" id="autotoc_md57"></a>
SSL</h3>
<p>to use HTTPS, the following certificates must be available:</p>
<blockquote class="doxtable">
<p>&zwj;client certificates for <code>opensearch</code> and <code>postgresql</code> are used if found, <code>opensearch</code> key password is not supported. </p>
</blockquote>
<ul>
<li>opensearch<ul>
<li><code>elastic_verify_certs: false</code> may be used to skip server verification</li>
<li><code>$PATH_CERTS/opensearch-ca.pem</code>: path to the CA certificate for the Opensearch server</li>
<li><code>$PATH_CERTS/opensearch.pem</code>: client certificate to connect to Opensearch server</li>
<li><code>$PATH_CERTS/opensearch.key</code>: certificate key</li>
</ul>
</li>
<li>postgresql<ul>
<li><code>postgres_ssl: true</code> mut be set in the configuration</li>
<li><code>postgres_verify_certs: false</code> may be used to skip server verification</li>
<li><code>$PATH_CERTS/postgres-ca.pem</code>: path to the CA certificate for the PostgreSQL server</li>
<li><code>$PATH_CERTS/postgres.pem</code> client certificate to connect to PostgreSQL server</li>
<li><code>$PATH_CERTS/postgres.key</code>: certificate key</li>
</ul>
</li>
<li>gulp server<ul>
<li>to connect gulp clients, use <code>https_enforce</code> to prevent HTTP connections, <code>https_enforce_client_certs</code> to enforce client certificates signed by <code>gulp-ca.pem</code>CA</li>
<li><code>$PATH_CERTS/gulp-ca.pem</code></li>
<li><code>$PATH_CERTS/gulp.pem</code></li>
<li><code>$PATH_CERTS/gulp.key</code></li>
</ul>
</li>
</ul>
<h3><a class="anchor" id="autotoc_md58"></a>
Exposed services</h3>
<ul>
<li><em><a href="http://localhost:8080">http://localhost:8080</a></em>: gulp, swagger page <a href="http://localhost:8080/docs">here</a></li>
<li><em>localhost:5432</em>: postgres (<b>user/pwd: <code>postgres/Gulp1234!</code></b>)<ul>
<li><em><a href="http://localhost:8001">http://localhost:8001</a></em>: adminer (<b>server/user/pwd: <code>postgres/postgres/Gulp1234!</code></b>)</li>
</ul>
</li>
<li><em><a href="http://localhost:9200">http://localhost:9200</a></em>: opensearch (<b>user/pwd: <code>admin/Gulp1234!</code></b>)<ul>
<li><em><a href="http://localhost:8082">http://localhost:8082</a></em>: elasticvue</li>
<li><em><a href="http://localhost:5601">http://localhost:5601</a></em>: opensearch dashboards (<b>user/pwd: <code>admin/Gulp1234!</code></b>)</li>
</ul>
</li>
</ul>
<h3><a class="anchor" id="autotoc_md59"></a>
Run</h3>
<p><a href="./docs/Install Docker.md#run">with docker</a> or <a href="./docs/Install Dev.md#3-run">with install from sources</a></p>
<h4><a class="anchor" id="autotoc_md60"></a>
Test ingestion</h4>
<div class="fragment"><div class="line"># ingest single file</div>
<div class="line">TEST_WS_ID=&quot;websocket_id&quot; ./test_scripts/test_ingest.sh -p ./samples/win_evtx/Application_no_crc32.evtx</div>
<div class="line"> </div>
<div class="line"># ingest zip</div>
<div class="line">TEST_WS_ID=&quot;websocket_id&quot; ./test_scripts/test_ingest.sh -p ./test_scripts/test_upload_with_metadata_json.zip</div>
<div class="line"> </div>
<div class="line"># ingest with filter (GulpIngestFilter)</div>
<div class="line">TEST_WS_ID=&quot;websocket_id&quot; TEST_INGESTION_FILTER=&#39;{&quot;level&quot;:[2]}&#39; ./test_scripts/test_ingest.sh -p ./test_scripts/test_upload_with_metadata_json.zip -f</div>
<div class="line"> </div>
<div class="line">## multiple concurrent ingestion (using 2 target websockets)</div>
<div class="line">TEST_WS_ID=&quot;websocket_id1&quot; TEST_TOKEN=80d5ed1e-c30f-4926-872d-92bcc5a2235d ./test_scripts/test_ingest.sh -p ./samples/win_evtx &amp;&amp; TEST_WS_ID=&quot;websocket_id2&quot; TEST_TOKEN=80d5ed1e-c30f-4926-872d-92bcc5a2235d TEST_CONTEXT=context2 TEST_OPERATION=testop2 ./test_scripts/test_ingest.sh -p ./samples/win_evtx</div>
<div class="line"> </div>
<div class="line"># ingest with csv plugin without mapping file (&quot;@timestamp&quot; in the document is mandatory, so in one way or another we must know at least how to obtain a timestamp for ingested event)</div>
<div class="line">TEST_WS_ID=&quot;websocket_id&quot; TEST_PLUGIN_PARAMS=&#39;{&quot;timestamp_field&quot;: &quot;UpdateTimestamp&quot;}&#39; TEST_PLUGIN=gi_csv ./test_scripts/test_ingest.sh -p ./samples/mftecmd/sample_j.csv</div>
<div class="line"> </div>
<div class="line"># ingest with csv plugin with mapping file</div>
<div class="line">TEST_WS_ID=&quot;websocket_id&quot; TEST_PLUGIN_PARAMS=&#39;{&quot;mapping_file&quot;: &quot;mftecmd_csv.json&quot;, &quot;mapping_id&quot;: &quot;j&quot;}&#39; TEST_PLUGIN=gi_csv ./test_scripts/test_ingest.sh -p ./samples/mftecmd/sample_j.csv</div>
<div class="line"> </div>
<div class="line"># example overriding a configuration parameter (will stay overridden until gulp restarts)</div>
<div class="line">TEST_WS_ID=&quot;websocket_id&quot; TEST_PLUGIN_PARAMS=&#39;{&quot;mapping_file&quot;: &quot;mftecmd_csv.json&quot;, &quot;mapping_id&quot;: &quot;j&quot;, &quot;config_override&quot;: { &quot;debug_allow_any_token_as_admin&quot;: true }&#39; TEST_PLUGIN=gi_csv ./test_scripts/test_ingest.sh -p ./samples/mftecmd/sample_j.csv</div>
<div class="line"> </div>
<div class="line"># ingest local directory (just for testing, not available in production code and not available when gulp runs in docker)</div>
<div class="line">TEST_WS_ID=&quot;websocket_id&quot; ./test_scripts/test_ingest.sh -x -p ./samples/win_evtx</div>
<div class="line"> </div>
<div class="line"># sample ingestion with filter</div>
<div class="line">TEST_INGESTION_FILTER=&#39;{&quot;start_msec&quot;:1475719436055, &quot;end_msec&quot;: 1475719436211}&#39; TEST_WS_ID=abc ./test_scripts/test_ingest.sh -p ./samples/win_evtx -f</div>
<div class="line"> </div>
<div class="line"># same as above, send filtered chunks on websocket but store data anyway on database (do not apply filter on-store)</div>
<div class="line">TEST_INGESTION_FILTER=&#39;{&quot;start_msec&quot;:1475719436055, &quot;end_msec&quot;: 1475719436211, &quot;store_all_documents&quot;: true}&#39; TEST_WS_ID=abc ./test_scripts/test_ingest.sh -p ./samples/win_evtx -f</div>
</div><!-- fragment --><blockquote class="doxtable">
<p>&zwj;- for testing websocket, a browser extension i.e. <a href="https://chromewebstore.google.com/detail/browser-websocket-client/mdmlhchldhfnfnkfmljgeinlffmdgkjo">chrome websockets browser extension</a> may be used.</p>
<ul>
<li>if TEST_WS_ID is not specified, ingestion happens anyway, but results are not broadcasted.</li>
</ul>
</blockquote>
<p>resuming ingestion is supported <b>if the <code>req_id</code> parameter is the same across requests</b>.  </p>
<h2><a class="anchor" id="autotoc_md61"></a>
Architecture</h2>
<p><a class="el" href="md_docs_2_architecture.html">GULP architecture</a></p>
<h2><a class="anchor" id="autotoc_md62"></a>
Clients</h2>
<h3><a class="anchor" id="autotoc_md63"></a>
Web Client</h3>
<p>If you want to use the web GUI visit it's repository <a href="https://github.com/mentat-is/gulpui-web">here</a>. It's still heavily under construction, so any contribution is highly appreciated!</p>
<p>This is the intended official wanna-be client for gulp.</p>
<h3><a class="anchor" id="autotoc_md64"></a>
.NET Client</h3>
<blockquote class="doxtable">
<p>&zwj;[!IMPORTANT] âš  the .NET client is to be considered an internal-test version, this is the tool we use internally to testdrive the backend development. It is not feature complete and far from being production ready :). Feel free to open issues, but any contribution should go towards the new WIP <a href="https://github.com/mentat-is/gulpui-web">web client</a> </p>
</blockquote>
<p>If you want to use the .NET client "as-is", you can use the Windows binary from <a href="https://github.com/mentat-is/gulp/bins/gulp-dotnet.zip">here</a>. To run the executable on Linux, install .NET 6.0 using <code>wine</code> and run <code>GUiLP.exe</code>. </p>
</div></div><!-- PageDoc -->
<a href="doxygen_crawl.html"></a>
</div><!-- contents -->
</div><!-- doc-content -->
<script>
    mermaid.initialize({
        startOnLoad: true,
        theme: "dark",
    });
</script>
